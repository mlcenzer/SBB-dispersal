rm(list=ls())
setwd("~/Documents/Florida soapberry project/2019 Dispersal/SBB-dispersal git/avbernat_working_on/stats")
library(lme4)
library(dplyr)
library(ggplotify)
library(gridExtra)
library(ggformula)
library(tidyselect)
library(zoo)
library(nnet) # multinom package
library(rethinking)
rm(list=ls())
output_col = FALSE # Recommend changing this to TRUE if working in Base R or RStudio, and FALSE if generating an html
source("src/clean_flight_data.R") # Script that loads and cleans up the data
source("src/regression_output.R") # A script that cleans up regression outputs and prints in color or black and white
source("src/center_flight_data.R")
source("get_warnings.R")
source("src/get_warnings.R")
data <- read_flight_data("data/all_flight_data-Winter2020.csv")
data_all <- data[[1]]
data_tested <- data[[2]]
d <- data_tested %>%
group_by(ID, sex,population, site, host_plant, latitude, longitude, total_eggs,
beak, thorax, wing, body, w_morph, morph_notes, tested,
host_c, sex_c, w_morph_c, lat_c, sym_dist, sym_dist_s, total_eggs_c,
beak_c, thorax_c, thorax_s, body_c, wing_c, wing2body, wing2body_c, wing2body_s) %>%
summarise_all(funs(list(na.omit(.))))
d$num_flew <- 0
d$num_notflew <- 0
d$average_mass <- 0
for(row in 1:length(d$flew_b)){
n_flew <- sum(d$flew_b[[row]] == 1) # total number of times did fly among trails
d$num_flew[[row]] <- n_flew
n_notflew <- sum(d$flew_b[[row]] == 0) # total number of times did not fly among trails
d$num_notflew[[row]] <- n_notflew
avg_mass <- mean(d$mass[[row]])
d$average_mass[[row]] <- avg_mass
}
d <- select(d, -filename, -channel_letter, -set_number)
d <- center_data(d, is_not_binded = FALSE)
d
R1 = d$num_flew
R2 = d$num_notflew
A = d$thorax_s
B = d$wing2body_s
C = d$sex_c
D = d$average_mass_s
X = d$population
data<-data.frame(R1, R2, A, B, C, D, X)
source("src/compare_models.R")
errors <- withWarnings(model_comparisonsAIC("src/generic models-binomial glmer 2R ~ 1-RF + 4-FF.R"))
multi_model <- glmer(cbind(num_flew, num_notflew) ~ thorax_s * wing2body_s + wing2body_s * average_mass_s + sex_c + (1|population), data=d, family=binomial)
tidy_regression(multi_model, is_color=output_col)
tidy_regression(multi_model_all, is_color=output_col)
multi_model_all <- glmer(cbind(num_flew, num_notflew) ~ thorax_c * wing2body_c + wing2body_c * average_mass + (1|population), data=d, family=binomial)
tidy_regression(multi_model_all, is_color=output_col)
summary(multi_model_all)
plot(d$wing2body_c~d$average_mass_c)
plot(d$wing2body_c~d$thorax_c)
plot(d$average_mass_c~d$thorax_c)
multi_model_test <- glm(cbind(num_flew, num_notflew) ~ thorax_c * wing2body_c + wing2body_c * average_mass, data=d, family=binomial)
tidy_regression(multi_model_test)
tidy_regression(multi_model_testm is_color=output_col)
tidy_regression(multi_model_test, is_color=output_col)
summary(multi_model_test)
tidy_regression(multi_model_all, is_color=output_col)
summary(multi_model_all)
aggregate(cbind(num_flew,num_notflew)~wing2body*average_mass, data=d, FUN=mean)
aggregate((num_flew/(num_flew+num_notflew))~wing2body*average_mass, data=d, FUN=mean)
temp_data<-aggregate((num_flew/(num_flew+num_notflew))~wing2body*average_mass, data=d, FUN=mean)
d$mass_block<-round(d$average_mass, digits=1)
d$mass_block
d$mass_block<-round(d$average_mass, digits=2)
d$mass_block
d$wing2body
d$wing2body_block<-round(d$wing2body, digits=2)
temp_data<-aggregate((num_flew/(num_flew+num_notflew))~wing2body_block*average_mass_block, data=d, FUN=mean)
temp_data<-aggregate((num_flew/(num_flew+num_notflew))~wing2body_block*mass_block, data=d, FUN=mean)
temp_data
levels(temp_data$mass_block)
unique(temp_data$mass_block)
plot(temp_data$`(num_flew/(num_flew + num_notflew))`~temp_data$wing2body_block)
plot(temp_data$`(num_flew/(num_flew + num_notflew))`~temp_data$wing2body_block, pch=2)
plot(temp_data$`(num_flew/(num_flew + num_notflew))`~temp_data$wing2body_block, pch=21)
plot(temp_data$`(num_flew/(num_flew + num_notflew))`~temp_data$wing2body_block, pch=22)
plot(temp_data$`(num_flew/(num_flew + num_notflew))`~temp_data$wing2body_block, pch=22, col=1)
plot(temp_data$`(num_flew/(num_flew + num_notflew))`~temp_data$wing2body_block, pch=19, col=1)
plot(temp_data$`(num_flew/(num_flew + num_notflew))`~temp_data$wing2body_block, pch=19, col=rgb(1,1,0,0.1))
plot(temp_data$`(num_flew/(num_flew + num_notflew))`~temp_data$wing2body_block, pch=19, col=rgb(1,1,0,0.5))
boxplot(temp_data$`(num_flew/(num_flew + num_notflew))`~temp_data$wing2body_block, pch=19, col=rgb(1,1,0,0.5))
boxplot(temp_data$`(num_flew/(num_flew + num_notflew))`~temp_data$wing2body_block*temp_data$mass_block, pch=19, col=rgb(1,1,0,0.5))
plot(temp_data$`(num_flew/(num_flew + num_notflew))`~temp_data$wing2body_block, pch=seq(1:10)[as.factor(temp_data$mass_block)], col=rgb(1,1,0,0.5))
boxplot(temp_data$`(num_flew/(num_flew + num_notflew))`~temp_data$wing2mass_block, pch=19, col=rgb(1,1,0,0.5))
boxplot(temp_data$`(num_flew/(num_flew + num_notflew))`~temp_data$mass_block, pch=19, col=rgb(1,1,0,0.5))
temp_data
multi_model_all
multi_model_test
