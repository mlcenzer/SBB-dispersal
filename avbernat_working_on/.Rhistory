anova(m51, m63, test="Chisq") # Adding B improves fit
SE = function(x){sd(x)/sqrt(length(x))}
w2b_summary<-aggregate(wing2body~sex*pophost*dates, data=data_long, FUN=mean)
w2b_summary$se<-aggregate(wing2body~sex*pophost*dates, data=data_long,
FUN=SE)$wing2body
jitter = runif(n=nrow(w2b_summary), min=-0.5, max=0.5) # jitter slightly
w2b_summary$dates <- w2b_summary$dates + jitter
d = w2b_summary
# repeating plotting features
customPlot = list( theme_classic(),
theme(axis.text=element_text(size=13),
axis.title=element_text(size=16),
plot.title=element_text(size=20),),
theme(legend.position = c(0.2, 0.9)),
theme(legend.title = element_text(size=14, face="italic"),
legend.text = element_text(size = 13, face="italic"))
)
xlab_years = na.omit(sort(unique(data_long$dates))[-2])
xlab_allmonths = na.omit(sort(unique(data_long$month_of_year)))
xlab_months = xlab_allmonths[c(-2,-5)]
month_labs <- c("Feb", "May", "Aug", "Oct", "Dec")
# hp_col_shade = c("turquoise3", "green")
# hp_col_pts = c("turquoise3", "springgreen4")
# sex_col_shade = c("brown1", "sienna4")
# sex_col_pts = c("brown1", "grey27")
par(mfrow=c(1,2))
l1 = lowess(d$dates, d$wing2body, f=0.4)
plot(d$dates, d$wing2body)
lines(l1, type = "l")
plot_lowess_residuals = function(lfit, x, y) {
lfun <- approxfun(lfit)
fitted <- lfun(x)
resid <- y-fitted
plot(fitted,resid)
abline(h=0,col=8)
}
plot_lowess_residuals(l1, d$dates, d$wing2body)
w2b_summary<-aggregate(wing2body~sex*pophost*month_of_year, data=data_long, FUN=mean)
df = w2b_summary
df$pophost = factor(df$pophost, levels = c("K. elegans", "C. corindum") )
df$`Host Plant` = df$pophost
df$sex[df$sex=="F"]<-"Females"
df$sex[df$sex=="M"]<-"Males"
df$sex = factor(df$sex, levels = c("Males", "Females") )
df$`Sex` = df$sex
p1 = ggplot() +
ggtitle("A") + xlab("Month") + ylab("Wing-to-Body Ratio") +
geom_vline(xintercept = xlab_dates, color="gainsboro") +
geom_smooth(data=data_long, method="glm", se=FALSE, linetype = "dashed",
mapping = aes(x = month_of_year, y = wing2body), colour="black", lwd=0.5) +
geom_smooth(data=df, method="loess",
mapping = aes(x = month_of_year, y = wing2body, colour=`Host Plant`, fill=`Host Plant`)) +
geom_point(data=df, mapping = aes(x = month_of_year, y = wing2body, colour=`Host Plant`)) +
ylim(0.71, 0.75) +
customPlot +
scale_color_manual(values=c("C. corindum" = "turquoise3", "K. elegans" = "springgreen4")) +
scale_fill_manual(values = c("C. corindum" = "turquoise3", "K. elegans" = "green")) +
scale_x_continuous(breaks=xlab_months, labels=month_labs)
p1 = ggplot() +
ggtitle("A") + xlab("Month") + ylab("Wing-to-Body Ratio") +
geom_vline(xintercept = xlab_allmonths, color="gainsboro") +
geom_smooth(data=data_long, method="glm", se=FALSE, linetype = "dashed",
mapping = aes(x = month_of_year, y = wing2body), colour="black", lwd=0.5) +
geom_smooth(data=df, method="loess",
mapping = aes(x = month_of_year, y = wing2body, colour=`Host Plant`, fill=`Host Plant`)) +
geom_point(data=df, mapping = aes(x = month_of_year, y = wing2body, colour=`Host Plant`)) +
ylim(0.71, 0.75) +
customPlot +
scale_color_manual(values=c("C. corindum" = "turquoise3", "K. elegans" = "springgreen4")) +
scale_fill_manual(values = c("C. corindum" = "turquoise3", "K. elegans" = "green")) +
scale_x_continuous(breaks=xlab_months, labels=month_labs)
p2 = ggplot() +
ggtitle("B") + xlab("Month") + ylab("Wing-to-Body Ratio") +
geom_vline(xintercept = xlab_allmonths, color="gainsboro") +
geom_smooth(data=data_long, method="glm", se=FALSE, linetype = "dashed",
mapping = aes(x = month_of_year, y = wing2body), colour="black", lwd=0.5) +
geom_smooth(data=df, method="loess",
mapping = aes(x = month_of_year, y = wing2body, colour=Sex, fill=Sex)) +
geom_point(data=df, mapping = aes(x = month_of_year, y = wing2body, colour=Sex)) +
ylim(0.71, 0.75) +
customPlot +
scale_color_manual(values=c("Females" = "brown3", "Males" = "black")) +
scale_fill_manual(values = c("Females" = "brown1", "Males" = "sienna4")) +
scale_x_continuous(breaks=xlab_months, labels= month_labs) + theme(axis.title.y = element_blank())
rm(list=ls())
# Set Working Directory
dir = "~/Desktop/git_repositories/SBB-dispersal/avbernat_working_on/All_Morphology/stats/"
setwd(dir)
knitr::opts_chunk$set(echo = TRUE)
library(lme4) # fit regressions
library(dplyr) # data manipulation
library(ggformula) # ggplot plotting
library(cowplot) # ggplot helper functions to arrange multi-panel figures
source_path = "~/Desktop/git_repositories/SBB-dispersal/avbernat_working_on/Rsrc/"
script_names = c("compare_models.R", # 1 function: model_comparisonsAIC()
"regression_output.R", # 1 function: tidy_regression()
"clean_morph_data3.R", # 2 functions: read_morph_data(), remove_torn_wings()
"AICprobabilities.R") # 1 function: AICprobs()
for (script in script_names) {
path = paste0(source_path, script)
source(path)
}
source("~/Desktop/git_repositories/SBB-dispersal/avbernat_working_on/RTsrc/vartests.R")
data_list <- read_morph_data("data/allmorphology05.18.21.csv")
raw_data = data_list[[1]]
data_long = data_list[[2]] # long-wing bugs only
data_long = remove_torn_wings(data_long)
raw_data_missing = raw_data %>%
filter(w_morph=="" | is.na(w_morph))
par(mfrow=c(3,1))
hist(raw_data$wing[raw_data$w_morph=="L"]/raw_data$thorax[raw_data$w_morph=="L"],
main="Histogram of wing length/thorax length for long winged SBB",
xlab="wing length/thorax length",
breaks=seq(0.5, 3.8, by=0.05))
hist(raw_data_missing$wing/raw_data_missing$thorax,
main="Histogram of wing length/thorax length for SBB w/o recorded wing morph",
xlab="wing length/thorax length",
breaks=seq(0.5, 3.8, by=0.05))
hist(raw_data$wing[raw_data$w_morph=="S"]/raw_data$thorax[raw_data$w_morph=="S"],
main="Histogram of wing length/thorax length for short winged SBB",
xlab="wing length/thorax length",
breaks=seq(0.5,3.8,by=0.05))
# repeating plot features
customPlot = list(geom_bar(position='stack', color="black", width=0.7),
theme_bw(),
theme_classic(),
theme(axis.text.y = element_text(size=11),
axis.text.x=element_text(size=11, angle = 45, hjust = 1.1),
axis.title=element_text(size=17,face="bold")),
theme(axis.title.x = element_text(vjust = -3)),
theme(axis.title.y = element_text(vjust = 4)),
theme(plot.margin=unit(c(1,1,1.1,1.2),"cm"))
)
pop_colors = c("#787a87", "#E69F00", "#56B4E9", "royalblue",
"grey", "gold", "#409973", "#9bc969", "ivory2")
p1 = ggplot(data=subset(raw_data, !is.na(datetime)), aes(x=datetime, fill=population)) +
labs(title=" ", fill="Population",
x="Field Collection Month", y = "Number of Bugs Collected") +
scale_fill_manual(values=pop_colors) + customPlot
groups = raw_data %>%
group_by(sex, datetime) %>%
summarize(count = n())
numF = paste0("F(", as.character(unlist(groups[1:10,3])), ")")
numM = paste0("M(", as.character(unlist(groups[11:20,3])), ")")
text = paste0(numF, "\n", numM)
p1 = p1 + annotate(geom="text", x=1, y=400, label=text[1],
color="black", size=3) +
annotate(geom="text", x=2, y=470, label=text[2],
color="black", size=3) +
annotate(geom="text", x=3, y=270, label=text[3],
color="black", size=3) +
annotate(geom="text", x=4, y=220, label=text[4],
color="black", size=3) +
annotate(geom="text", x=5, y=320, label=text[5],
color="black", size=3) +
annotate(geom="text", x=6, y=500, label=text[6],
color="black", size=3) +
annotate(geom="text", x=7, y=240, label=text[7],
color="black", size=3) +
annotate(geom="text", x=8, y=730, label=paste0("\n", text[8]),
color="black", size=3) +
annotate(geom="text", x=9, y=440, label=text[9],
color="black", size=3) +
annotate(geom="text", x=10, y=650, label=text[10],
color="black", size=3)
p1
p2 = ggplot(data=subset(raw_data, !is.na(datetime)), aes(x=datetime, fill=pophost)) +
labs(title=" ", fill="Host Plant",
x="Field Collection Month", y = "Number of Bugs Collected") +
scale_fill_manual(values=c("#56B4E9", "chartreuse4")) + customPlot
p2
p3 = ggplot(data=subset(raw_data, !is.na(datetime)), aes(x=datetime, fill=sex)) +
labs(title=" ", fill="Sex",
x="Field Collection Month", y = "Number of Bugs Collected") +
scale_fill_manual(values=c("salmon1", "darkslategray3")) + customPlot
p3
data<-data.frame(R=raw_data$wing_morph_binom,
A=raw_data$sex_binom,
B=raw_data$pophost_binom,
C=(raw_data$month_of_year),
D=raw_data$months_since_start)
model_script = paste0(source_path,"generic models-binomial glm 4-FF.R")
model_comparisonsAIC(model_script)
anova(m98, m110, test="Chisq") # adding B*D does not improve fit
anova(m84, m98, test="Chisq") # adding A*B improves fit
anova(m63, m84, test="Chisq") # Adding C*D improves fit
anova(m51, m63, test="Chisq") # Adding B improves fit
M2 = glm(wing_morph_binom ~ sex_binom * pophost_binom + sex_binom * months_since_start +
pophost_binom * month_of_year + month_of_year * months_since_start,
data=raw_data, family="binomial")
summary(M2)
SE = function(x){sd(x)/sqrt(length(x))}
wmorph_table<-aggregate(wing_morph_binom~sex_binom*pophost_binom*month_of_year*months_since_start,
data=raw_data, FUN=mean)
wmorph_table$sd<-aggregate(wing_morph_binom~sex_binom*pophost_binom*month_of_year*months_since_start,
data=raw_data,FUN=sd)$wing_morph_binom
wmorph_table$se<-aggregate(wing_morph_binom~sex_binom*pophost_binom*month_of_year*months_since_start,
data=raw_data,FUN=SE)$wing_morph_binom
data = wmorph_table
data<-data.frame(R=data$sd,
A=data$sex_binom,
B=data$pophost_binom,
C=(data$month_of_year),
D=data$months_since_start)
model_script = paste0(source_path,"generic models-gaussian glm 4-FF.R")
model_comparisonsAIC(model_script)
anova(m2, m5, test="Chisq") # Adding A does not improve fit
anova(m2, m8, test="Chisq") # Adding C does not improve fit
anova(m2, m9, test="Chisq") # Adding D does not improve fit
anova(m0, m2, test="Chisq") # Adding B improves fit
M3 = glm(sd ~ pophost_binom, data=wmorph_table, family="gaussian")
summary(M3)
data<-data.frame(R=data_long$wing2body_c, # centered
A=data_long$sex_binom,
B=data_long$pophost_binom,
C=data_long$month_of_year_c, # centered
D=data_long$months_since_start_c) # centered
model_script = paste0(source_path,"generic models-gaussian glm 4-FF.R")
model_comparisonsAIC(model_script)
anova(m22, m42, test="Chisq") # adding B*C does not improve fit
anova(m16, m22, test="Chisq") # adding C does improve fit
anova(m22, m34, test="Chisq") # adding D does not improve fit
anova(m34, m58, test="Chisq") # Adding B*D marginally improves fit
M4 = glm(wing2body_c ~ sex_binom*pophost_binom + month_of_year_c, data=data_long, family=gaussian)
summary(M4)
SE = function(x){sd(x)/sqrt(length(x))}
w2b_table<-aggregate(wing2body~sex_binom*pophost_binom*month_of_year*months_since_start,
data=data_long, FUN=mean)
w2b_table$sd<-aggregate(wing2body~sex_binom*pophost_binom*month_of_year*months_since_start,
data=data_long, FUN=sd)$wing2body
w2b_table$se<-aggregate(wing2body~sex_binom*pophost_binom*month_of_year*months_since_start,
data=data_long, FUN=SE)$wing2body
data = w2b_table
data<-data.frame(R=data$sd,
A=data$sex_binom,
B=data$pophost_binom,
C=(data$month_of_year),
D=data$months_since_start)
model_script = paste0(source_path,"generic models-gaussian glm 4-FF.R")
model_comparisonsAIC(model_script)
anova(m8, m19, test="Chisq") # Adding B*C does not improve fit
anova(m2, m8, test="Chisq") # Adding C does not improve fit
anova(m0, m2, test="Chisq") # Adding B improves fit
M6 = glm(sd ~ pophost_binom, data=w2b_table, family=gaussian)
summary(M6)
# repeating plotting features
customPlot = list( theme_classic(),
theme(axis.text=element_text(size=13),
axis.title=element_text(size=16),
plot.title=element_text(size=20),),
theme(legend.position = c(0.2, 0.9)),
theme(legend.title = element_text(size=14, face="italic"),
legend.text = element_text(size = 13, face="italic"))
)
xlab_years = na.omit(sort(unique(data_long$dates))[-2])
xlab_allmonths = na.omit(sort(unique(data_long$month_of_year)))
xlab_months = xlab_allmonths[c(-2,-5)]
month_labs <- c("Feb", "May", "Aug", "Oct", "Dec")
# hp_col_shade = c("turquoise3", "green")
# hp_col_pts = c("turquoise3", "springgreen4")
# sex_col_shade = c("brown1", "sienna4")
# sex_col_pts = c("brown1", "grey27")
w_morph_summary<-aggregate(wing_morph_binom~sex*pophost*month_of_year*months_since_start
, data=raw_data, FUN=mean)
w_morph_summary$se<-aggregate(wing_morph_binom~sex*pophost*month_of_year*months_since_start
, data=raw_data, FUN=SE)$wing_morph_binom
jitter = runif(n=nrow(w_morph_summary), min=-0.5, max=0.5) #jitter slightly
w_morph_summary$dates <- w_morph_summary$month_of_year + jitter
dd = w_morph_summary
l1 = lowess(dd$dates, dd$wing_morph_binom, f=0.4) # f = alpha, the smoother span
plot(dd$dates, dd$wing_morph_binom)
lines(l1, type = "l")
l1 = lowess(dd$dates, dd$wing_morph_binom, f=0.4) # f = alpha, the smoother span
par(mfrow=c(1,2))
plot(dd$dates, dd$wing_morph_binom)
lines(l1, type = "l")
plot_lowess_residuals = function(lfit, x, y) {
lfun <- approxfun(lfit)
fitted <- lfun(x)
resid <- y-fitted
plot(fitted,resid)
abline(h=0,col=8)
}
plot_lowess_residuals(l1, dd$dates, dd$wing_morph_binom)
customPlot = list( theme_classic(),
theme(axis.text=element_text(size=13),
axis.title=element_text(size=16),
plot.title=element_text(size=20),),
theme(legend.position = c(0.23, 0.95)), # AB: only line that's different
theme(legend.title = element_text(size=14, face="italic"),
legend.text = element_text(size = 13, face="italic"))
)
# repeating plotting features
customPlot = list( theme_classic(),
theme(axis.text=element_text(size=13),
axis.title=element_text(size=16),
plot.title=element_text(size=20),),
theme(legend.position = c(0.2, 0.9)),
theme(legend.title = element_text(size=14, face="italic"),
legend.text = element_text(size = 13, face="italic"))
)
xlab_years = na.omit(sort(unique(data_long$dates))[-2])
xlab_allmonths = na.omit(sort(unique(data_long$month_of_year)))
xlab_months = xlab_allmonths[c(-2,-5)]
month_labs <- c("Feb", "May", "Aug", "Oct", "Dec")
# hp_col_shade = c("turquoise3", "green")
# hp_col_pts = c("turquoise3", "springgreen4")
# sex_col_shade = c("brown1", "sienna4")
# sex_col_pts = c("brown1", "grey27")
dd$pophost = factor(dd$pophost, levels = c("K. elegans", "C. corindum") )
dd$`Host Plant` = dd$pophost
dd$sex[dd$sex=="F"]<-"Females"
dd$sex[dd$sex=="M"]<-"Males"
dd$sex = factor(dd$sex, levels = c("Males", "Females") )
dd$`Sex` = dd$sex
dd$sex
p5 = ggplot() +
ggtitle("A") + xlab("Month") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_dates, color="gainsboro") +
geom_line(aes(x=xmonth, y=wing_probs), linetype = "dashed") +
geom_smooth(data=dd, method="loess",
mapping = aes(x = month_of_year, y = wing_morph_binom, colour=`Host Plant`, fill=`Host Plant`)) +
geom_point(data=dd, mapping = aes(x = month_of_year, y = wing_morph_binom, colour=`Host Plant`)) +
customPlot +
scale_color_manual(values=c("C. corindum" = "turquoise3", "K. elegans" = "springgreen4")) +
scale_fill_manual(values = c("C. corindum" = "turquoise3", "K. elegans" = "green")) +
scale_x_continuous(breaks=xlab_months, labels= month_labs) + ylim(0.3,1.2)
p5 = ggplot() +
ggtitle("A") + xlab("Month") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_allmonths, color="gainsboro") +
geom_line(aes(x=xmonth, y=wing_probs), linetype = "dashed") +
geom_smooth(data=dd, method="loess",
mapping = aes(x = month_of_year, y = wing_morph_binom, colour=`Host Plant`, fill=`Host Plant`)) +
geom_point(data=dd, mapping = aes(x = month_of_year, y = wing_morph_binom, colour=`Host Plant`)) +
customPlot +
scale_color_manual(values=c("C. corindum" = "turquoise3", "K. elegans" = "springgreen4")) +
scale_fill_manual(values = c("C. corindum" = "turquoise3", "K. elegans" = "green")) +
scale_x_continuous(breaks=xlab_months, labels= month_labs) + ylim(0.3,1.2)
p6 = ggplot() +
ggtitle("B") + xlab("Month") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_allmonths, color="gainsboro") +
geom_line(aes(x=xmonth, y=wing_probs), linetype = "dashed") +
geom_smooth(data=dd, method="loess",
mapping = aes(x = month_of_year, y = wing_morph_binom, colour=Sex, fill=Sex)) +
geom_point(data=dd, mapping = aes(x = month_of_year, y = wing_morph_binom, colour=Sex)) +
customPlot +
scale_color_manual(values=c("Females" = "brown3", "Males" = "black")) +
scale_fill_manual(values = c("Females" = "brown1", "Males" = "sienna4")) +
scale_x_continuous(breaks=xlab_months, labels= month_labs) + theme(axis.title.y = element_blank()) + ylim(0.3,1.2)
p5
xmonth <- seq(2,12, 0.01)
fit = glm(wing_morph_binom ~ month_of_year, family = "binomial", data = raw_data)
xmonth <- seq(2,12, 0.01)
wing_probs <- predict(fit, list(month_of_year = xmonth),type="response")
fit_pvalue = round(summary(fit)$coeff[,"Pr(>|z|)"][2],10)
pvalue = paste0("italic(p)[glm]==", fit_pvalue)
p5 = ggplot() +
ggtitle("A") + xlab("Month") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_allmonths, color="gainsboro") +
geom_line(aes(x=xmonth, y=wing_probs), linetype = "dashed") +
geom_smooth(data=dd, method="loess",
mapping = aes(x = month_of_year, y = wing_morph_binom, colour=`Host Plant`, fill=`Host Plant`)) +
geom_point(data=dd, mapping = aes(x = month_of_year, y = wing_morph_binom, colour=`Host Plant`)) +
customPlot +
scale_color_manual(values=c("C. corindum" = "turquoise3", "K. elegans" = "springgreen4")) +
scale_fill_manual(values = c("C. corindum" = "turquoise3", "K. elegans" = "green")) +
scale_x_continuous(breaks=xlab_months, labels= month_labs) + ylim(0.3,1.2)
p6 = ggplot() +
ggtitle("B") + xlab("Month") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_allmonths, color="gainsboro") +
geom_line(aes(x=xmonth, y=wing_probs), linetype = "dashed") +
geom_smooth(data=dd, method="loess",
mapping = aes(x = month_of_year, y = wing_morph_binom, colour=Sex, fill=Sex)) +
geom_point(data=dd, mapping = aes(x = month_of_year, y = wing_morph_binom, colour=Sex)) +
customPlot +
scale_color_manual(values=c("Females" = "brown3", "Males" = "black")) +
scale_fill_manual(values = c("Females" = "brown1", "Males" = "sienna4")) +
scale_x_continuous(breaks=xlab_months, labels= month_labs) + theme(axis.title.y = element_blank()) + ylim(0.3,1.2)
p5
p6
# extract from LOESS and/or linear regressions
alpha = paste("alpha[loess]==", ggplot_build(p6)$data[[3]]$alpha[1])
degree="lambda[loess]==0"
# extract from LOESS and/or linear regressions
alpha = paste("alpha[loess]==", ggplot_build(p6)$data[[3]]$alpha[1])
degree="lambda[loess]==0"
# extract from LOESS and/or linear regressions
alpha = paste("alpha[loess]==", ggplot_build(p6)$data[[3]]$alpha[1])
degree="lambda[loess]==0"
p5 = p5 + annotate(geom="text", x=7.4, y=1.0, label=alpha, color="black", parse=TRUE) +
annotate(geom="text", x=7.4, y=1.04, label=degree, color="black", parse=TRUE) +
annotate(geom="text", x=5, y=0.718, label=pvalue, color="black", parse=TRUE)
p6 = p6 + annotate(geom="text", x=7.4, y=1.1, label=alpha, color="black", parse=TRUE) +
annotate(geom="text", x=7.4, y=1.15, label=degree, color="black",parse=TRUE) +
annotate(geom="text", x=5.5, y=1, label=pvalue, color="black", parse=TRUE)
p5
p6
p5 = ggplot() +
ggtitle("A") + xlab("Month") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_allmonths, color="gainsboro") +
geom_line(aes(x=xmonth, y=wing_probs), linetype = "dashed") +
geom_smooth(data=dd, method="loess",
mapping = aes(x = month_of_year, y = wing_morph_binom,
colour=`Host Plant`, fill=`Host Plant`)) +
geom_point(data=dd, mapping = aes(x = month_of_year, y = wing_morph_binom, colour=`Host Plant`)) +
customPlot +
scale_color_manual(values=c("C. corindum" = "turquoise3", "K. elegans" = "springgreen4")) +
scale_fill_manual(values = c("C. corindum" = "turquoise3", "K. elegans" = "green")) +
scale_x_continuous(breaks=xlab_months, labels= month_labs) + ylim(0.3,1.2)
p6 = ggplot() +
ggtitle("B") + xlab("Month") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_allmonths, color="gainsboro") +
geom_line(aes(x=xmonth, y=wing_probs), linetype = "dashed") +
geom_smooth(data=dd, method="loess",
mapping = aes(x = month_of_year, y = wing_morph_binom, colour=Sex, fill=Sex)) +
geom_point(data=dd, mapping = aes(x = month_of_year, y = wing_morph_binom, colour=Sex)) +
customPlot +
scale_color_manual(values=c("Females" = "brown3", "Males" = "black")) +
scale_fill_manual(values = c("Females" = "brown1", "Males" = "sienna4")) +
scale_x_continuous(breaks=xlab_months, labels= month_labs) + ylim(0.3,1.2) +
theme(axis.title.y = element_blank())
# theme(legend.position = c(0.23, 0.95))
---
title: "Modeling Wing Morphology Summary File"
output:
pdf_document: default
html_document: default
---
```{r setup, include=FALSE}
rm(list=ls())
# Set Working Directory
#dir = "~/Desktop/git_repositories/SBB-dispersal/avbernat_working_on/All_Morphology/stats/"
###MLC: Added alternate dir for my machine and propagated
dir = "~/Documents/Github/SBB-dispersal/avbernat_working_on/All_Morphology/"
setwd(dir)
knitr::opts_chunk$set(echo = TRUE)
```
# Data Cleaning And Exploration
## Read Libraries
```{r message=FALSE}
library(lme4) # fit regressions
library(dplyr) # data manipulation
library(ggformula) # ggplot plotting
library(cowplot) # ggplot helper functions to arrange multi-panel figures
```
# Data Cleaning And Exploration
## Read Libraries
```{r message=FALSE}
library(lme4) # fit regressions
library(dplyr) # data manipulation
library(ggformula) # ggplot plotting
library(cowplot) # ggplot helper functions to arrange multi-panel figures
```
## Read Source Files
```{r message=FALSE}
source_path = "./stats/Rsrc/"
script_names = c("compare_models.R", # 1 function: model_comparisonsAIC()
"regression_output.R", # 1 function: tidy_regression()
"clean_morph_data3.R", # 2 functions: read_morph_data(), remove_torn_wings()
"AICprobabilities.R") # 1 function: AICprobs()
for (script in script_names) {
path = paste0(source_path, script)
source(path)
}
source("~/Desktop/git_repositories/SBB-dispersal/avbernat_working_on/RTsrc/vartests.R")
getwd()
rm(list=ls())
# Set Working Directory
#dir = "~/Desktop/git_repositories/SBB-dispersal/avbernat_working_on/All_Morphology/stats/"
###MLC: Added alternate dir for my machine and propagated
dir = "~/Documents/Github/SBB-dispersal/avbernat_working_on/All_Morphology/"
setwd(dir)
knitr::opts_chunk$set(echo = TRUE)
source_path = "./Rsrc/"
script_names = c("compare_models.R", # 1 function: model_comparisonsAIC()
"regression_output.R", # 1 function: tidy_regression()
"clean_morph_data3.R", # 2 functions: read_morph_data(), remove_torn_wings()
"AICprobabilities.R") # 1 function: AICprobs()
for (script in script_names) {
path = paste0(source_path, script)
source(path)
}
---
title: "Modeling Wing Morphology Summary File"
output:
pdf_document: default
html_document: default
---
```{r setup, include=FALSE}
rm(list=ls())
# Set Working Directory
#dir = "~/Desktop/git_repositories/SBB-dispersal/avbernat_working_on/All_Morphology/stats/"
###MLC: Added alternate dir for my machine and propagated so it can be changed only here and not at various points in the script
dir = "~/Documents/Github/SBB-dispersal/avbernat_working_on/"
setwd(dir)
knitr::opts_chunk$set(echo = TRUE)
```
## Read Libraries
```{r message=FALSE}
library(lme4) # fit regressions
library(dplyr) # data manipulation
library(ggformula) # ggplot plotting
library(cowplot) # ggplot helper functions to arrange multi-panel figures
```
rm(list=ls())
# Set Working Directory
#dir = "~/Desktop/git_repositories/SBB-dispersal/avbernat_working_on/All_Morphology/stats/"
###MLC: Added alternate dir for my machine and propagated so it can be changed only here and not at various points in the script
dir = "~/Documents/Github/SBB-dispersal/avbernat_working_on/"
setwd(dir)
knitr::opts_chunk$set(echo = TRUE)
```{r message=FALSE}
