mapping = aes(x = month_of_year, y = wing2body, colour=Sex, fill=Sex)) +
geom_point(data=d, mapping = aes(x = month_of_year, y = wing2body, colour=Sex, size=n)) +
ylim(0.65, 0.85) +
coord_cartesian(ylim=c(0.7,0.75)) +
customPlot +
scale_color_manual(values=c("Females" = sex_col_pts[1], "Males" = sex_col_pts[2])) +
scale_fill_manual(values = c("Females" = sex_col_shade[1], "Males" = sex_col_shade[2])) +
scale_x_continuous(breaks=xlab_months, labels= month_labs) +
theme(axis.title.x = element_blank())
# extract alpha, smoothing parameter from LOESS regression(s) and pvalue from linear model
alpha = paste("alpha[loess]==", ggplot_build(p10)$data[[3]]$alpha[1])
degree="lambda[loess]==0"
fit_pvalue = round(summary(M3)$coeff[,"Pr(>|t|)"][5],7)
pvalue = paste0("italic(p)[glm]==", fit_pvalue)
p10 = p10 +
annotate(geom="text", x=10, y=0.745, label=alpha, parse=TRUE, size=font_size) +
annotate(geom="text", x=10, y=0.75, label=degree, parse=TRUE, size=font_size) +
annotate(geom="text", x=5, y=0.718, label=pvalue, parse=TRUE, size=font_size)
p11 = p11 +
annotate(geom="text", x=10, y=0.745, label=alpha, parse=TRUE, size=font_size) +
annotate(geom="text", x=10, y=0.75, label=degree, parse=TRUE, size=font_size) +
annotate(geom="text", x=5, y=0.718, label=pvalue, parse=TRUE, size=font_size)
# multi-variate model with year, sex, and host plant predicting wing morph
fit4 = glm(wing2body ~ pophost_binom * dates, data = data_long)
xyr <- seq(sort(unique(dd$dates))[1],sort(unique(dd$dates))[10], 1)
set.seed(194842)
bhost = sample(c(-1,1), replace=TRUE, size=length(xyr))
wprobs <- predict(fit4, list(pophost_binom = bhost,
dates = xyr), type="response")
pred = cbind(xyr, bhost, wprobs)
pred = as.data.frame(pred)
pred$xyr = as.Date.numeric(pred$xyr)
predK = pred[pred$bhost==1,]
predC = pred[pred$bhost==-1,]
# extract pvalue from best fit regression model
fit_pvalue = round(summary(M3)$coeff[,"Pr(>|t|)"][7],3)
pvalue = paste0("italic(p)[glm]==", fit_pvalue)
### Panel C
p12 = ggplot() +
ggtitle("C") + xlab("Year") + ylab(" ") +
geom_vline(xintercept = xlab_years, color="gainsboro") +
geom_line(aes(x=predK$xyr, y=predK$wprobs), linetype = "dashed", color=hp_col_lines[2], lwd=0.5) +
geom_line(aes(x=predC$xyr, y=predC$wprobs), linetype = "dashed", color=hp_col_lines[1], lwd=0.5) +
geom_smooth(data=data_long, method="loess", span=0.8,
mapping = aes(x = dates, y = wing2body, colour=`Host Plant`, fill=`Host Plant`)) +
geom_point(data=d, mapping = aes(x = dates, y = wing2body, colour=`Host Plant`, size=n)) +
customPlot +
scale_color_manual(values=c("C. corindum" = hp_col_pts[1], "K. elegans" = hp_col_pts[2])) +
scale_fill_manual(values = c("C. corindum" = hp_col_shade[1], "K. elegans" = hp_col_shade[2])) +
ylim(0.65, 0.85) +
coord_cartesian(ylim=c(0.705,0.75)) + # AB: edit, not the same
theme(legend.position = "none")
#### loess and linear regressions
alpha = paste("alpha[loess]==", ggplot_build(p12)$data[[4]]$alpha[1])
degree="lambda[loess]==0"
p12 = p12 +
annotate(geom="text", x=unique(d$dates)[17]-330, y=0.743, label=alpha, parse=TRUE, size=font_size) +
annotate(geom="text", x=unique(d$dates)[17]-330, y=0.748, label=degree, parse=TRUE, size=font_size) +
annotate(geom="text", x=unique(d$dates)[15], y=0.716, label=pvalue, parse=TRUE, size=font_size)
paper_figure2 = ggdraw() +
draw_plot(p10, 0, .5, .5, .5) +
draw_plot(p11, .5, .5, .5, .5) +
draw_plot(p12, 0, 0, 1, .5) +
draw_plot_label("Month", 0.47, 0.51, fontface="plain") +
draw_plot_label("Wing-to-Body Ratio", 0, 0.35, fontface="plain", angle=90)
paper_figure2
### Panels A and B
### host plant
p10 = ggplot() +
ggtitle("A") + xlab("Month") + ylab(" ") +
geom_vline(xintercept = xlab_allmonths, color="gainsboro") +
geom_smooth(data=data_long, method="glm", se=FALSE, linetype = "dashed",
mapping = aes(x = month_of_year, y = wing2body), colour="black", lwd=0.5) +
geom_smooth(data=data_long, method="loess",
mapping = aes(x = month_of_year, y = wing2body, colour=`Host Plant`, fill=`Host Plant`)) +
geom_point(data=d, mapping = aes(x = month_of_year, y = wing2body, colour=`Host Plant`, size=n), legend.show=F) +
ylim(0.65, 0.85) + # data outside this range will be dropped
coord_cartesian(ylim=c(0.7,0.75)) +
customPlot +
scale_color_manual(values=c("C. corindum" = hp_col_pts[1], "K. elegans" = hp_col_pts[2])) +
scale_fill_manual(values = c("C. corindum" = hp_col_shade[1], "K. elegans" = hp_col_shade[2])) +
scale_x_continuous(breaks=xlab_months, labels=month_labs) +
theme(axis.title.x = element_blank())
### sex
p11 = ggplot() +
ggtitle("B") + xlab("Month") + ylab(" ") +
geom_vline(xintercept = xlab_allmonths, color="gainsboro") +
geom_smooth(data=data_long, method="glm", se=FALSE, linetype = "dashed",
mapping = aes(x = month_of_year, y = wing2body), colour="black", lwd=0.5) +
geom_smooth(data=data_long, method="loess",
mapping = aes(x = month_of_year, y = wing2body, colour=Sex, fill=Sex)) +
geom_point(data=d, mapping = aes(x = month_of_year, y = wing2body, colour=Sex, size=n), legend.show=F) +
ylim(0.65, 0.85) +
coord_cartesian(ylim=c(0.7,0.75)) +
customPlot +
scale_color_manual(values=c("Females" = sex_col_pts[1], "Males" = sex_col_pts[2])) +
scale_fill_manual(values = c("Females" = sex_col_shade[1], "Males" = sex_col_shade[2])) +
scale_x_continuous(breaks=xlab_months, labels= month_labs) +
theme(axis.title.x = element_blank())
# extract alpha, smoothing parameter from LOESS regression(s) and pvalue from linear model
alpha = paste("alpha[loess]==", ggplot_build(p10)$data[[3]]$alpha[1])
degree="lambda[loess]==0"
fit_pvalue = round(summary(M3)$coeff[,"Pr(>|t|)"][5],7)
pvalue = paste0("italic(p)[glm]==", fit_pvalue)
p10 = p10 +
annotate(geom="text", x=10, y=0.745, label=alpha, parse=TRUE, size=font_size) +
annotate(geom="text", x=10, y=0.75, label=degree, parse=TRUE, size=font_size) +
annotate(geom="text", x=5, y=0.718, label=pvalue, parse=TRUE, size=font_size)
p11 = p11 +
annotate(geom="text", x=10, y=0.745, label=alpha, parse=TRUE, size=font_size) +
annotate(geom="text", x=10, y=0.75, label=degree, parse=TRUE, size=font_size) +
annotate(geom="text", x=5, y=0.718, label=pvalue, parse=TRUE, size=font_size)
### Panel C
p12 = ggplot() +
ggtitle("C") + xlab("Year") + ylab(" ") +
geom_vline(xintercept = xlab_years, color="gainsboro") +
geom_line(aes(x=predK$xyr, y=predK$wprobs), linetype = "dashed", color=hp_col_lines[2], lwd=0.5) +
geom_line(aes(x=predC$xyr, y=predC$wprobs), linetype = "dashed", color=hp_col_lines[1], lwd=0.5) +
geom_smooth(data=data_long, method="loess", span=0.8,
mapping = aes(x = dates, y = wing2body, colour=`Host Plant`, fill=`Host Plant`)) +
geom_point(data=d, mapping = aes(x = dates, y = wing2body, colour=`Host Plant`, size=n)) +
customPlot +
scale_color_manual(values=c("C. corindum" = hp_col_pts[1], "K. elegans" = hp_col_pts[2])) +
scale_fill_manual(values = c("C. corindum" = hp_col_shade[1], "K. elegans" = hp_col_shade[2])) +
ylim(0.65, 0.85) +
coord_cartesian(ylim=c(0.705,0.75)) + # AB: edit, not the same
theme(legend.position = "none")
#### loess and linear regressions
alpha = paste("alpha[loess]==", ggplot_build(p12)$data[[4]]$alpha[1])
degree="lambda[loess]==0"
p12 = p12 +
annotate(geom="text", x=unique(d$dates)[17]-330, y=0.743, label=alpha, parse=TRUE, size=font_size) +
annotate(geom="text", x=unique(d$dates)[17]-330, y=0.748, label=degree, parse=TRUE, size=font_size) +
annotate(geom="text", x=unique(d$dates)[15], y=0.716, label=pvalue, parse=TRUE, size=font_size)
paper_figure2 = ggdraw() +
draw_plot(p10, 0, .5, .5, .5) +
draw_plot(p11, .5, .5, .5, .5) +
draw_plot(p12, 0, 0, 1, .5) +
draw_plot_label("Month", 0.47, 0.51, fontface="plain") +
draw_plot_label("Wing-to-Body Ratio", 0, 0.35, fontface="plain", angle=90)
paper_figure2
### Panels A and B
### host plant
p10 = ggplot() +
ggtitle("A") + xlab("Month") + ylab(" ") +
geom_vline(xintercept = xlab_allmonths, color="gainsboro") +
geom_smooth(data=data_long, method="glm", se=FALSE, linetype = "dashed",
mapping = aes(x = month_of_year, y = wing2body), colour="black", lwd=0.5) +
geom_smooth(data=data_long, method="loess",
mapping = aes(x = month_of_year, y = wing2body, colour=`Host Plant`, fill=`Host Plant`)) +
geom_point(data=d, mapping = aes(x = month_of_year, y = wing2body, colour=`Host Plant`, size=n), show.legend=F) +
ylim(0.65, 0.85) + # data outside this range will be dropped
coord_cartesian(ylim=c(0.7,0.75)) +
customPlot +
scale_color_manual(values=c("C. corindum" = hp_col_pts[1], "K. elegans" = hp_col_pts[2])) +
scale_fill_manual(values = c("C. corindum" = hp_col_shade[1], "K. elegans" = hp_col_shade[2])) +
scale_x_continuous(breaks=xlab_months, labels=month_labs) +
theme(axis.title.x = element_blank())
### sex
p11 = ggplot() +
ggtitle("B") + xlab("Month") + ylab(" ") +
geom_vline(xintercept = xlab_allmonths, color="gainsboro") +
geom_smooth(data=data_long, method="glm", se=FALSE, linetype = "dashed",
mapping = aes(x = month_of_year, y = wing2body), colour="black", lwd=0.5) +
geom_smooth(data=data_long, method="loess",
mapping = aes(x = month_of_year, y = wing2body, colour=Sex, fill=Sex)) +
geom_point(data=d, mapping = aes(x = month_of_year, y = wing2body, colour=Sex, size=n), show.legend=F) +
ylim(0.65, 0.85) +
coord_cartesian(ylim=c(0.7,0.75)) +
customPlot +
scale_color_manual(values=c("Females" = sex_col_pts[1], "Males" = sex_col_pts[2])) +
scale_fill_manual(values = c("Females" = sex_col_shade[1], "Males" = sex_col_shade[2])) +
scale_x_continuous(breaks=xlab_months, labels= month_labs) +
theme(axis.title.x = element_blank())
# extract alpha, smoothing parameter from LOESS regression(s) and pvalue from linear model
alpha = paste("alpha[loess]==", ggplot_build(p10)$data[[3]]$alpha[1])
degree="lambda[loess]==0"
fit_pvalue = round(summary(M3)$coeff[,"Pr(>|t|)"][5],7)
pvalue = paste0("italic(p)[glm]==", fit_pvalue)
p10 = p10 +
annotate(geom="text", x=10, y=0.745, label=alpha, parse=TRUE, size=font_size) +
annotate(geom="text", x=10, y=0.75, label=degree, parse=TRUE, size=font_size) +
annotate(geom="text", x=5, y=0.718, label=pvalue, parse=TRUE, size=font_size)
p11 = p11 +
annotate(geom="text", x=10, y=0.745, label=alpha, parse=TRUE, size=font_size) +
annotate(geom="text", x=10, y=0.75, label=degree, parse=TRUE, size=font_size) +
annotate(geom="text", x=5, y=0.718, label=pvalue, parse=TRUE, size=font_size)
paper_figure2 = ggdraw() +
draw_plot(p10, 0, .5, .5, .5) +
draw_plot(p11, .5, .5, .5, .5) +
draw_plot(p12, 0, 0, 1, .5) +
draw_plot_label("Month", 0.47, 0.51, fontface="plain") +
draw_plot_label("Wing-to-Body Ratio", 0, 0.35, fontface="plain", angle=90)
paper_figure2
### Panels A and B
### host plant
p10 = ggplot() +
ggtitle("A") + xlab("Month") + ylab(" ") +
geom_vline(xintercept = xlab_allmonths, color="gainsboro") +
geom_smooth(data=data_long, method="glm", se=FALSE, linetype = "dashed",
mapping = aes(x = month_of_year, y = wing2body), colour="black", lwd=0.5) +
geom_smooth(data=data_long, method="loess",
mapping = aes(x = month_of_year, y = wing2body, colour=`Host Plant`, fill=`Host Plant`)) +
geom_point(data=d, mapping = aes(x = month_of_year, y = wing2body, colour=`Host Plant`, size=n), show.legend=F) +
ylim(0.65, 0.85) + # data outside this range will be dropped
coord_cartesian(ylim=c(0.7,0.75)) +
customPlot +
scale_color_manual(values=c("C. corindum" = hp_col_pts[1], "K. elegans" = hp_col_pts[2])) +
scale_fill_manual(values = c("C. corindum" = hp_col_shade[1], "K. elegans" = hp_col_shade[2])) +
scale_x_continuous(breaks=xlab_months, labels=month_labs) +
theme(axis.title.x = element_blank())
### sex
p11 = ggplot() +
ggtitle("B") + xlab("Month") + ylab(" ") +
geom_vline(xintercept = xlab_allmonths, color="gainsboro") +
geom_smooth(data=data_long, method="glm", se=FALSE, linetype = "dashed",
mapping = aes(x = month_of_year, y = wing2body), colour="black", lwd=0.5) +
geom_smooth(data=data_long, method="loess",
mapping = aes(x = month_of_year, y = wing2body, colour=Sex, fill=Sex)) +
geom_point(data=d, mapping = aes(x = month_of_year, y = wing2body, colour=Sex, size=n), show.legend=F) +
ylim(0.65, 0.85) +
coord_cartesian(ylim=c(0.7,0.75)) +
customPlot +
scale_color_manual(values=c("Females" = sex_col_pts[1], "Males" = sex_col_pts[2])) +
scale_fill_manual(values = c("Females" = sex_col_shade[1], "Males" = sex_col_shade[2])) +
scale_x_continuous(breaks=xlab_months, labels= month_labs) +
theme(axis.title.x = element_blank())
# extract alpha, smoothing parameter from LOESS regression(s) and pvalue from linear model
alpha = paste("alpha[loess]==", ggplot_build(p10)$data[[3]]$alpha[1])
degree="lambda[loess]==0"
fit_pvalue = round(summary(M3)$coeff[,"Pr(>|t|)"][5],7)
pvalue = paste0("italic(p)[glm]==", fit_pvalue)
p10 = p10 +
annotate(geom="text", x=10, y=0.745, label=alpha, parse=TRUE, size=font_size) +
annotate(geom="text", x=10, y=0.749, label=degree, parse=TRUE, size=font_size) +
annotate(geom="text", x=5, y=0.718, label=pvalue, parse=TRUE, size=font_size)
p11 = p11 +
annotate(geom="text", x=10, y=0.745, label=alpha, parse=TRUE, size=font_size) +
annotate(geom="text", x=10, y=0.749, label=degree, parse=TRUE, size=font_size) +
annotate(geom="text", x=5, y=0.718, label=pvalue, parse=TRUE, size=font_size)
# multi-variate model with year, sex, and host plant predicting wing morph
fit4 = glm(wing2body ~ pophost_binom * dates, data = data_long)
xyr <- seq(sort(unique(dd$dates))[1],sort(unique(dd$dates))[10], 1)
set.seed(194842)
bhost = sample(c(-1,1), replace=TRUE, size=length(xyr))
wprobs <- predict(fit4, list(pophost_binom = bhost,
dates = xyr), type="response")
pred = cbind(xyr, bhost, wprobs)
pred = as.data.frame(pred)
pred$xyr = as.Date.numeric(pred$xyr)
predK = pred[pred$bhost==1,]
predC = pred[pred$bhost==-1,]
# extract pvalue from best fit regression model
fit_pvalue = round(summary(M3)$coeff[,"Pr(>|t|)"][7],3)
pvalue = paste0("italic(p)[glm]==", fit_pvalue)
### Panel C
p12 = ggplot() +
ggtitle("C") + xlab("Year") + ylab(" ") +
geom_vline(xintercept = xlab_years, color="gainsboro") +
geom_line(aes(x=predK$xyr, y=predK$wprobs), linetype = "dashed", color=hp_col_lines[2], lwd=0.5) +
geom_line(aes(x=predC$xyr, y=predC$wprobs), linetype = "dashed", color=hp_col_lines[1], lwd=0.5) +
geom_smooth(data=data_long, method="loess", span=0.8,
mapping = aes(x = dates, y = wing2body, colour=`Host Plant`, fill=`Host Plant`)) +
geom_point(data=d, mapping = aes(x = dates, y = wing2body, colour=`Host Plant`, size=n)) +
customPlot +
scale_color_manual(values=c("C. corindum" = hp_col_pts[1], "K. elegans" = hp_col_pts[2])) +
scale_fill_manual(values = c("C. corindum" = hp_col_shade[1], "K. elegans" = hp_col_shade[2])) +
ylim(0.65, 0.85) +
coord_cartesian(ylim=c(0.705,0.75)) + # AB: edit, not the same
theme(legend.position = "none")
#### loess and linear regressions
alpha = paste("alpha[loess]==", ggplot_build(p12)$data[[4]]$alpha[1])
degree="lambda[loess]==0"
p12 = p12 +
annotate(geom="text", x=unique(d$dates)[17]-330, y=0.743, label=alpha, parse=TRUE, size=font_size) +
annotate(geom="text", x=unique(d$dates)[17]-330, y=0.747, label=degree, parse=TRUE, size=font_size) +
annotate(geom="text", x=unique(d$dates)[15], y=0.716, label=pvalue, parse=TRUE, size=font_size)
paper_figure2 = ggdraw() +
draw_plot(p10, 0, .5, .5, .5) +
draw_plot(p11, .5, .5, .5, .5) +
draw_plot(p12, 0, 0, 1, .5) +
draw_plot_label("Month", 0.47, 0.51, fontface="plain") +
draw_plot_label("Wing-to-Body Ratio", 0, 0.35, fontface="plain", angle=90)
paper_figure2
### Panels A and B
### host plant
p10 = ggplot() +
ggtitle("A") + xlab("Month") + ylab(" ") +
geom_vline(xintercept = xlab_allmonths, color="gainsboro") +
geom_smooth(data=data_long, method="glm", se=FALSE, linetype = "dashed",
mapping = aes(x = month_of_year, y = wing2body), colour="black", lwd=0.5) +
geom_smooth(data=data_long, method="loess",
mapping = aes(x = month_of_year, y = wing2body, colour=`Host Plant`, fill=`Host Plant`)) +
geom_point(data=d, mapping = aes(x = month_of_year, y = wing2body, colour=`Host Plant`, size=n), show.legend=F) +
ylim(0.65, 0.85) + # data outside this range will be dropped
coord_cartesian(ylim=c(0.705,0.75)) +
customPlot +
scale_color_manual(values=c("C. corindum" = hp_col_pts[1], "K. elegans" = hp_col_pts[2])) +
scale_fill_manual(values = c("C. corindum" = hp_col_shade[1], "K. elegans" = hp_col_shade[2])) +
scale_x_continuous(breaks=xlab_months, labels=month_labs) +
theme(axis.title.x = element_blank())
### sex
p11 = ggplot() +
ggtitle("B") + xlab("Month") + ylab(" ") +
geom_vline(xintercept = xlab_allmonths, color="gainsboro") +
geom_smooth(data=data_long, method="glm", se=FALSE, linetype = "dashed",
mapping = aes(x = month_of_year, y = wing2body), colour="black", lwd=0.5) +
geom_smooth(data=data_long, method="loess",
mapping = aes(x = month_of_year, y = wing2body, colour=Sex, fill=Sex)) +
geom_point(data=d, mapping = aes(x = month_of_year, y = wing2body, colour=Sex, size=n), show.legend=F) +
ylim(0.65, 0.85) +
coord_cartesian(ylim=c(0.705,0.75)) +
customPlot +
scale_color_manual(values=c("Females" = sex_col_pts[1], "Males" = sex_col_pts[2])) +
scale_fill_manual(values = c("Females" = sex_col_shade[1], "Males" = sex_col_shade[2])) +
scale_x_continuous(breaks=xlab_months, labels= month_labs) +
theme(axis.title.x = element_blank())
# extract alpha, smoothing parameter from LOESS regression(s) and pvalue from linear model
alpha = paste("alpha[loess]==", ggplot_build(p10)$data[[3]]$alpha[1])
degree="lambda[loess]==0"
fit_pvalue = round(summary(M3)$coeff[,"Pr(>|t|)"][5],7)
pvalue = paste0("italic(p)[glm]==", fit_pvalue)
p10 = p10 +
annotate(geom="text", x=10, y=0.745, label=alpha, parse=TRUE, size=font_size) +
annotate(geom="text", x=10, y=0.749, label=degree, parse=TRUE, size=font_size) +
annotate(geom="text", x=5, y=0.715, label=pvalue, parse=TRUE, size=font_size)
p11 = p11 +
annotate(geom="text", x=10, y=0.745, label=alpha, parse=TRUE, size=font_size) +
annotate(geom="text", x=10, y=0.749, label=degree, parse=TRUE, size=font_size) +
annotate(geom="text", x=5, y=0.715, label=pvalue, parse=TRUE, size=font_size)
# multi-variate model with year, sex, and host plant predicting wing morph
fit4 = glm(wing2body ~ pophost_binom * dates, data = data_long)
xyr <- seq(sort(unique(dd$dates))[1],sort(unique(dd$dates))[10], 1)
set.seed(194842)
bhost = sample(c(-1,1), replace=TRUE, size=length(xyr))
wprobs <- predict(fit4, list(pophost_binom = bhost,
dates = xyr), type="response")
pred = cbind(xyr, bhost, wprobs)
pred = as.data.frame(pred)
pred$xyr = as.Date.numeric(pred$xyr)
predK = pred[pred$bhost==1,]
predC = pred[pred$bhost==-1,]
# extract pvalue from best fit regression model
fit_pvalue = round(summary(M3)$coeff[,"Pr(>|t|)"][7],3)
pvalue = paste0("italic(p)[glm]==", fit_pvalue)
### Panel C
p12 = ggplot() +
ggtitle("C") + xlab("Year") + ylab(" ") +
geom_vline(xintercept = xlab_years, color="gainsboro") +
geom_line(aes(x=predK$xyr, y=predK$wprobs), linetype = "dashed", color=hp_col_lines[2], lwd=0.5) +
geom_line(aes(x=predC$xyr, y=predC$wprobs), linetype = "dashed", color=hp_col_lines[1], lwd=0.5) +
geom_smooth(data=data_long, method="loess", span=0.8,
mapping = aes(x = dates, y = wing2body, colour=`Host Plant`, fill=`Host Plant`)) +
geom_point(data=d, mapping = aes(x = dates, y = wing2body, colour=`Host Plant`, size=n)) +
customPlot +
scale_color_manual(values=c("C. corindum" = hp_col_pts[1], "K. elegans" = hp_col_pts[2])) +
scale_fill_manual(values = c("C. corindum" = hp_col_shade[1], "K. elegans" = hp_col_shade[2])) +
ylim(0.65, 0.85) +
#theme(legend.position = "none") +
coord_cartesian(ylim=c(0.705,0.75))
#### loess and linear regressions
alpha = paste("alpha[loess]==", ggplot_build(p12)$data[[4]]$alpha[1])
degree="lambda[loess]==0"
p12 = p12 +
annotate(geom="text", x=unique(d$dates)[17]-330, y=0.743, label=alpha, parse=TRUE, size=font_size) +
annotate(geom="text", x=unique(d$dates)[17]-330, y=0.747, label=degree, parse=TRUE, size=font_size) +
annotate(geom="text", x=unique(d$dates)[15], y=0.716, label=pvalue, parse=TRUE, size=font_size)
paper_figure2 = ggdraw() +
draw_plot(p10, 0, .5, .5, .5) +
draw_plot(p11, .5, .5, .5, .5) +
draw_plot(p12, 0, 0, 1, .5) +
draw_plot_label("Month", 0.47, 0.51, fontface="plain") +
draw_plot_label("Wing-to-Body Ratio", 0, 0.35, fontface="plain", angle=90)
paper_figure2
paper_figure2 = ggdraw() +
draw_plot(p10, 0, .5, .5, .5) +
draw_plot(p11, .5, .5, .5, .5) +
draw_plot(p12, 0, 0, 1, .5) +
draw_plot_label("Month", 0.47, 0.51, fontface="plain") +
draw_plot_label("Wing-to-Body Ratio", 0, 0.35, fontface="plain", angle=90)
paper_figure2
### Panel C
p12 = ggplot() +
ggtitle("C") + xlab("Year") + ylab(" ") +
geom_vline(xintercept = xlab_years, color="gainsboro") +
geom_line(aes(x=predK$xyr, y=predK$wprobs), linetype = "dashed", color=hp_col_lines[2], lwd=0.5) +
geom_line(aes(x=predC$xyr, y=predC$wprobs), linetype = "dashed", color=hp_col_lines[1], lwd=0.5) +
geom_smooth(data=data_long, method="loess", span=0.8,
mapping = aes(x = dates, y = wing2body, colour=`Host Plant`, fill=`Host Plant`),
show.legend=F) +
geom_point(data=d, mapping = aes(x = dates, y = wing2body, colour=`Host Plant`, size=n)) +
guides(color=F) +
customPlot +
scale_color_manual(values=c("C. corindum" = hp_col_pts[1], "K. elegans" = hp_col_pts[2])) +
scale_fill_manual(values = c("C. corindum" = hp_col_shade[1], "K. elegans" = hp_col_shade[2])) +
ylim(0.65, 0.85) +
#theme(legend.position = "none") +
coord_cartesian(ylim=c(0.705,0.75))
#### loess and linear regressions
alpha = paste("alpha[loess]==", ggplot_build(p12)$data[[4]]$alpha[1])
degree="lambda[loess]==0"
p12 = p12 +
annotate(geom="text", x=unique(d$dates)[17]-330, y=0.743, label=alpha, parse=TRUE, size=font_size) +
annotate(geom="text", x=unique(d$dates)[17]-330, y=0.747, label=degree, parse=TRUE, size=font_size) +
annotate(geom="text", x=unique(d$dates)[15], y=0.716, label=pvalue, parse=TRUE, size=font_size)
### Panel C
p12 = ggplot() +
ggtitle("C") + xlab("Year") + ylab(" ") +
geom_vline(xintercept = xlab_years, color="gainsboro") +
geom_line(aes(x=predK$xyr, y=predK$wprobs), linetype = "dashed", color=hp_col_lines[2], lwd=0.5) +
geom_line(aes(x=predC$xyr, y=predC$wprobs), linetype = "dashed", color=hp_col_lines[1], lwd=0.5) +
geom_smooth(data=data_long, method="loess", span=0.8,
mapping = aes(x = dates, y = wing2body, colour=`Host Plant`, fill=`Host Plant`),
show.legend=F) +
geom_point(data=d, mapping = aes(x = dates, y = wing2body, colour=`Host Plant`, size=n)) +
guides(color=F) +
customPlot +
scale_color_manual(values=c("C. corindum" = hp_col_pts[1], "K. elegans" = hp_col_pts[2])) +
scale_fill_manual(values = c("C. corindum" = hp_col_shade[1], "K. elegans" = hp_col_shade[2])) +
ylim(0.65, 0.85) +
theme(legend.position = c(0.1, 0.9)) +
#theme(legend.position = "none") +
coord_cartesian(ylim=c(0.705,0.75))
#### loess and linear regressions
alpha = paste("alpha[loess]==", ggplot_build(p12)$data[[4]]$alpha[1])
degree="lambda[loess]==0"
p12 = p12 +
annotate(geom="text", x=unique(d$dates)[17]-330, y=0.743, label=alpha, parse=TRUE, size=font_size) +
annotate(geom="text", x=unique(d$dates)[17]-330, y=0.747, label=degree, parse=TRUE, size=font_size) +
annotate(geom="text", x=unique(d$dates)[15], y=0.716, label=pvalue, parse=TRUE, size=font_size)
### Panel C
p12 = ggplot() +
ggtitle("C") + xlab("Year") + ylab(" ") +
geom_vline(xintercept = xlab_years, color="gainsboro") +
geom_line(aes(x=predK$xyr, y=predK$wprobs), linetype = "dashed", color=hp_col_lines[2], lwd=0.5) +
geom_line(aes(x=predC$xyr, y=predC$wprobs), linetype = "dashed", color=hp_col_lines[1], lwd=0.5) +
geom_smooth(data=data_long, method="loess", span=0.8,
mapping = aes(x = dates, y = wing2body, colour=`Host Plant`, fill=`Host Plant`),
show.legend=F) +
geom_point(data=d, mapping = aes(x = dates, y = wing2body, colour=`Host Plant`, size=n)) +
guides(color=F) +
customPlot +
scale_color_manual(values=c("C. corindum" = hp_col_pts[1], "K. elegans" = hp_col_pts[2])) +
scale_fill_manual(values = c("C. corindum" = hp_col_shade[1], "K. elegans" = hp_col_shade[2])) +
ylim(0.65, 0.85) +
theme(legend.position = c(0.1, 0.70)) +
#theme(legend.position = "none") +
coord_cartesian(ylim=c(0.705,0.75))
#### loess and linear regressions
alpha = paste("alpha[loess]==", ggplot_build(p12)$data[[4]]$alpha[1])
degree="lambda[loess]==0"
p12 = p12 +
annotate(geom="text", x=unique(d$dates)[17]-330, y=0.743, label=alpha, parse=TRUE, size=font_size) +
annotate(geom="text", x=unique(d$dates)[17]-330, y=0.747, label=degree, parse=TRUE, size=font_size) +
annotate(geom="text", x=unique(d$dates)[15], y=0.716, label=pvalue, parse=TRUE, size=font_size)
### Panel C
p12 = ggplot() +
ggtitle("C") + xlab("Year") + ylab(" ") +
geom_vline(xintercept = xlab_years, color="gainsboro") +
geom_line(aes(x=predK$xyr, y=predK$wprobs), linetype = "dashed", color=hp_col_lines[2], lwd=0.5) +
geom_line(aes(x=predC$xyr, y=predC$wprobs), linetype = "dashed", color=hp_col_lines[1], lwd=0.5) +
geom_smooth(data=data_long, method="loess", span=0.8,
mapping = aes(x = dates, y = wing2body, colour=`Host Plant`, fill=`Host Plant`),
show.legend=F) +
geom_point(data=d, mapping = aes(x = dates, y = wing2body, colour=`Host Plant`, size=n)) +
guides(color=F) +
customPlot +
scale_color_manual(values=c("C. corindum" = hp_col_pts[1], "K. elegans" = hp_col_pts[2])) +
scale_fill_manual(values = c("C. corindum" = hp_col_shade[1], "K. elegans" = hp_col_shade[2])) +
ylim(0.65, 0.85) +
theme(legend.position = c(0.1, 0.77)) +
#theme(legend.position = "none") +
coord_cartesian(ylim=c(0.705,0.75))
#### loess and linear regressions
alpha = paste("alpha[loess]==", ggplot_build(p12)$data[[4]]$alpha[1])
degree="lambda[loess]==0"
p12 = p12 +
annotate(geom="text", x=unique(d$dates)[17]-330, y=0.743, label=alpha, parse=TRUE, size=font_size) +
annotate(geom="text", x=unique(d$dates)[17]-330, y=0.747, label=degree, parse=TRUE, size=font_size) +
annotate(geom="text", x=unique(d$dates)[15], y=0.716, label=pvalue, parse=TRUE, size=font_size)
### Panel C
p12 = ggplot() +
ggtitle("C") + xlab("Year") + ylab(" ") +
geom_vline(xintercept = xlab_years, color="gainsboro") +
geom_line(aes(x=predK$xyr, y=predK$wprobs), linetype = "dashed", color=hp_col_lines[2], lwd=0.5) +
geom_line(aes(x=predC$xyr, y=predC$wprobs), linetype = "dashed", color=hp_col_lines[1], lwd=0.5) +
geom_smooth(data=data_long, method="loess", span=0.8,
mapping = aes(x = dates, y = wing2body, colour=`Host Plant`, fill=`Host Plant`),
show.legend=F) +
geom_point(data=d, mapping = aes(x = dates, y = wing2body, colour=`Host Plant`, size=n)) +
guides(color=F) +
customPlot +
scale_color_manual(values=c("C. corindum" = hp_col_pts[1], "K. elegans" = hp_col_pts[2])) +
scale_fill_manual(values = c("C. corindum" = hp_col_shade[1], "K. elegans" = hp_col_shade[2])) +
ylim(0.65, 0.85) +
theme(legend.position = c(0.1, 0.75)) +
#theme(legend.position = "none") +
coord_cartesian(ylim=c(0.705,0.75))
#### loess and linear regressions
alpha = paste("alpha[loess]==", ggplot_build(p12)$data[[4]]$alpha[1])
degree="lambda[loess]==0"
p12 = p12 +
annotate(geom="text", x=unique(d$dates)[17]-330, y=0.743, label=alpha, parse=TRUE, size=font_size) +
annotate(geom="text", x=unique(d$dates)[17]-330, y=0.747, label=degree, parse=TRUE, size=font_size) +
annotate(geom="text", x=unique(d$dates)[15], y=0.716, label=pvalue, parse=TRUE, size=font_size)
paper_figure2 = ggdraw() +
draw_plot(p10, 0, .5, .5, .5) +
draw_plot(p11, .5, .5, .5, .5) +
draw_plot(p12, 0, 0, 1, .5) +
draw_plot_label("Month", 0.47, 0.51, fontface="plain") +
draw_plot_label("Wing-to-Body Ratio", 0, 0.35, fontface="plain", angle=90)
paper_figure2
