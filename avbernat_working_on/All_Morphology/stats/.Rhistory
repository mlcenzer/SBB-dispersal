# group data by sex
dfF = dd[dd$sex=="Females",]
dfM = dd[dd$sex=="Males",]
# multi-variate model with month, sex, and host plant predicting wing morph
fit2 = glm(wing_morph_binom ~ sex_binom * pophost_binom +
pophost_binom * month_of_year, family = "binomial", data = raw_data)
xmon <- seq(2,12, 0.01)
set.seed(194842)
bsex = sample(c(-1,1), replace=TRUE, size=length(xmon))
bhost = sample(c(-1,1), replace=TRUE, size=length(xmon))
wprobs <- predict(fit2, list(sex_binom = bsex,
pophost_binom = bhost,
month_of_year = xmon), type="response")
pred = cbind(xmon, bsex, bhost, wprobs)
pred = as.data.frame(pred)
predFK = pred[pred$bhost==1 & pred$bsex==1,]
predFC = pred[pred$bhost==-1 & pred$bsex==1,]
predMK = pred[pred$bhost==1 & pred$bsex==-1,]
predMC = pred[pred$bhost==-1 & pred$bsex==-1,]
# extract pvalue from best fit regression model
fit_pvalue = round(summary(M1)$coeff[,"Pr(>|z|)"][6],4)
pvalue = paste0("italic(p)[glm]==", fit_pvalue)
### Panels C and D
### females & host plant
p6 = ggplot() +
ggtitle("C") + xlab("Month") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_allmonths, color="gainsboro") +
geom_line(aes(x=predFK$xmon, y=predFK$wprobs), linetype = "dashed", color="darkgreen") +
geom_line(aes(x=predFC$xmon, y=predFC$wprobs), linetype = "dashed", color="skyblue2") +
geom_smooth(data=dfF, method="loess", span=0.8,
mapping = aes(x = month_of_year, y = wing_morph_binom, colour=`Host Plant`, fill=`Host Plant`)) +
geom_point(data=dfF, mapping = aes(x = month_of_year, y = wing_morph_binom, colour=`Host Plant`)) +
customPlot +
scale_color_manual(values=c("C. corindum" = hp_col_pts[1], "K. elegans" = hp_col_pts[2])) +
scale_fill_manual(values = c("C. corindum" = hp_col_shade[1], "K. elegans" = hp_col_shade[2])) +
scale_x_continuous(breaks=xlab_months, labels= month_labs) +
ylim(0,1.3)
### males & host plant
p7 = ggplot() +
ggtitle("D") + xlab("Month") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_allmonths, color="gainsboro") +
geom_line(aes(x=predMK$xmon, y=predMK$wprobs), linetype = "dashed", color="darkgreen") +
geom_line(aes(x=predMC$xmon, y=predMC$wprobs), linetype = "dashed", color="skyblue2") +
geom_smooth(data=dfM, method="loess", span=0.8,
mapping = aes(x = month_of_year, y = wing_morph_binom, colour=`Host Plant`, fill=`Host Plant`)) +
geom_point(data=dfM, mapping = aes(x = month_of_year, y = wing_morph_binom, colour=`Host Plant`)) +
customPlot +
scale_color_manual(values=c("C. corindum" = hp_col_pts[1], "K. elegans" = hp_col_pts[2])) +
scale_fill_manual(values = c("C. corindum" = hp_col_shade[1], "K. elegans" = hp_col_shade[2])) +
scale_x_continuous(breaks=xlab_months, labels= month_labs) +
ylim(0,1.3)
# extract alpha, smoothing parameter, from LOESS regression(s))
alpha = paste("alpha[loess]==", ggplot_build(p7)$data[[4]]$alpha[1])
degree="lambda[loess]==0"
p6 = p6 +
#annotate(geom="text", x=10.7, y=1.3, label="Females", size=6, fontface = 'italic') +
annotate(geom="text", x=3.5, y=1.3, label="Females", size=6, fontface = 'italic') +
annotate(geom="text", x=10, y=1.1, label=alpha, parse=TRUE) +
annotate(geom="text", x=10, y=1.17, label=degree, parse=TRUE) +
annotate(geom="text", x=10, y=0.25, label=pvalue, parse=TRUE) +
theme(legend.position = "none") +
labs(x = " ", y = " ")
p7 = p7 +
#annotate(geom="text", x=11, y=1.3, label="Males", size=6, fontface = 'italic') +
annotate(geom="text", x=3, y=1.3, label="Males", size=6, fontface = 'italic') +
annotate(geom="text", x=10, y=1.1, label=alpha, parse=TRUE) +
annotate(geom="text", x=10, y=1.17, label=degree,parse=TRUE) +
annotate(geom="text", x=10, y=0.25, label=pvalue, parse=TRUE) +
theme(legend.position = "none") +
theme(axis.title.y = element_blank()) +
labs(x = " ", y = " ")
wm_table<-aggregate(wing_morph_binom~dates, data=raw_data, FUN=mean) # AB: wrong
### Panel E
p8 = ggplot() +
ggtitle("E") + xlab("Year") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_yrs, color="gainsboro") +
geom_smooth(data=wm_table, mapping = aes(x = dates, y = wing_morph_binom),
method="lm", se=FALSE, linetype = "dashed", color="black", lwd=0.5) +
geom_smooth(data=wm_table, mapping = aes(x = dates, y = wing_morph_binom),
method="loess", color="black") +
geom_point(data=wm_table, mapping = aes(x = dates, y = wing_morph_binom)) +
ylim(0.3,1.2) +
customPlot
# extract alpha, smoothing parameter, from LOESS regression(s)) and pvalue from linear model
alpha = paste("alpha[loess]==", ggplot_build(p8)$data[[3]]$alpha[1])
degree="lambda[loess]==0"
mlinear = glm(wing_morph_binom ~ dates, data=wm_table, family=gaussian) # AB: wrong
pvalue = paste0("italic(p)[glm]==",round(summary(mlinear)$coeff[[8]],2)) # AB: wrong
p8 = p8 +
annotate(geom="text", x=unique(raw_data$dates)[6], y=1.05, label=alpha, parse=TRUE, size=6) +
annotate(geom="text", x=unique(raw_data$dates)[6], y=1.12, label=degree, parse=TRUE, size=6) +
annotate(geom="text", x=unique(raw_data$dates)[5], y=0.50, label=pvalue, parse=TRUE, size=6)
# group data by sex
wm_table<-aggregate(wing_morph_binom~dates*sex, data=raw_data, FUN=mean)
dd = wm_table
dd$sex[dd$sex=="F"]<-"Females"
dd$sex[dd$sex=="M"]<-"Males"
dd$sex = factor(dd$sex, levels = c("Males", "Females") )
dd$`Sex` = dd$sex
dF = dd[dd$sex=="Females",]
dM = dd[dd$sex=="Males",]
# multi-variate model with year, sex, and host plant predicting wing morph
fit3 = glm(wing_morph_binom ~ sex_binom * pophost_binom +
sex_binom * months_since_start, family = "binomial", data = raw_data)
xyr <- seq(0,81, 0.01)
set.seed(194842)
bsex = sample(c(-1,1), replace=TRUE, size=length(xyr))
bhost = sample(c(-1,1), replace=TRUE, size=length(xyr))
wprobs <- predict(fit3, list(sex_binom = bsex,
pophost_binom = bhost,
months_since_start = xyr), type="response")
pred = cbind(xyr, bsex, bhost, wprobs)
pred = as.data.frame(pred)
predFK = pred[pred$bhost==1 & pred$bsex==1,]
predFC = pred[pred$bhost==-1 & pred$bsex==1,]
predMK = pred[pred$bhost==1 & pred$bsex==-1,]
predMC = pred[pred$bhost==-1 & pred$bsex==-1,]
# extract pvalue from best fit regression model
fit_pvalue = round(summary(M1)$coeff[,"Pr(>|z|)"][7],3)
pvalue = paste0("italic(p)[glm]==", fit_pvalue)
predFK$xyr
ggtitle("F") + xlab("Year") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_yrs, color="gainsboro")
ggplot() +
ggtitle("F") + xlab("Year") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_yrs, color="gainsboro")
# extract pvalue from best fit regression model
fit_pvalue = round(summary(M1)$coeff[,"Pr(>|z|)"][7],3)
pvalue = paste0("italic(p)[glm]==", fit_pvalue)
dd$dates
type(dd$dates)
class(dd$dates)
0,81
xyr <- seq(0,81, 0.01)
xyr
unique(dd$dates)
unique(raw_data$dates)
unique(dd$dates)
sort(unique(dd$dates))
sort(unique(dd$dates))[1]
sort(unique(dd$dates))[-1]
sort(unique(dd$dates))[9]
sort(unique(dd$dates))[10]
sort(unique(dd$dates))
xyr <- seq(sort(unique(dd$dates))[1],sort(unique(dd$dates))[10], 0.01)
xyr
# multi-variate model with year, sex, and host plant predicting wing morph
fit3 = glm(wing_morph_binom ~ sex_binom * pophost_binom +
sex_binom * months_since_start, family = "binomial", data = raw_data)
xyr <- seq(sort(unique(dd$dates))[1],sort(unique(dd$dates))[10], 0.01)
set.seed(194842)
bsex = sample(c(-1,1), replace=TRUE, size=length(xyr))
bhost = sample(c(-1,1), replace=TRUE, size=length(xyr))
wprobs <- predict(fit3, list(sex_binom = bsex,
pophost_binom = bhost,
months_since_start = xyr), type="response")
# multi-variate model with year, sex, and host plant predicting wing morph
fit3 = glm(wing_morph_binom ~ sex_binom * pophost_binom +
sex_binom * dates, family = "binomial", data = raw_data)
xyr <- seq(sort(unique(dd$dates))[1],sort(unique(dd$dates))[10], 0.01)
set.seed(194842)
bsex = sample(c(-1,1), replace=TRUE, size=length(xyr))
bhost = sample(c(-1,1), replace=TRUE, size=length(xyr))
wprobs <- predict(fit3, list(sex_binom = bsex,
pophost_binom = bhost,
months_since_start = xyr), type="response")
# multi-variate model with year, sex, and host plant predicting wing morph
fit3 = glm(wing_morph_binom ~ sex_binom * pophost_binom +
sex_binom * dates, family = "binomial", data = raw_data)
xyr <- seq(sort(unique(dd$dates))[1],sort(unique(dd$dates))[10], 0.01)
set.seed(194842)
bsex = sample(c(-1,1), replace=TRUE, size=length(xyr))
bhost = sample(c(-1,1), replace=TRUE, size=length(xyr))
wprobs <- predict(fit3, list(sex_binom = bsex,
pophost_binom = bhost,
dates = xyr), type="response")
pred = cbind(xyr, bsex, bhost, wprobs)
pred = as.data.frame(pred)
predFK = pred[pred$bhost==1 & pred$bsex==1,]
predFC = pred[pred$bhost==-1 & pred$bsex==1,]
predMK = pred[pred$bhost==1 & pred$bsex==-1,]
predMC = pred[pred$bhost==-1 & pred$bsex==-1,]
# extract pvalue from best fit regression model
fit_pvalue = round(summary(M1)$coeff[,"Pr(>|z|)"][7],3)
pvalue = paste0("italic(p)[glm]==", fit_pvalue)
### Panel F
p9 = ggplot() +
ggtitle("F") + xlab("Year") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_yrs, color="gainsboro") +
geom_line(aes(x=predFK$xyr, y=predFK$wprobs), linetype = "dashed", color="darkgreen") +
geom_line(aes(x=predFC$xyr, y=predFC$wprobs), linetype = "dashed", color="skyblue2") +
geom_smooth(data=dd, method="loess", span=0.8,
mapping = aes(x = dates, y = wing_morph_binom, colour=`Sex`, fill=`Sex`)) +
geom_point(data=dd, mapping = aes(x = dates, y = wing_morph_binom, colour=`Sex`)) +
customPlot +
scale_color_manual(values=c("Females" = sex_col_pts[1], "Males" = sex_col_pts[2])) +
scale_fill_manual(values = c("Females" = sex_col_shade[1], "Males" = sex_col_shade[2])) +
ylim(0.3,1.2) +
theme(legend.position = "none")
p9 = p9 +
annotate(geom="text", x=xlab_yrs[7], y=1.05, label=alpha, parse=TRUE, size=6) +
annotate(geom="text", x=xlab_yrs[7], y=1.12, label=degree, parse=TRUE, size=6)
p9
class(xyr)
class(predFC$xyr)
predFC$xyr
xyr
as.Date.numeric(predFC$xyr)
pred
pred = as.Date.numeric(pred$xyr)
pred
predFK = pred[pred$bhost==1 & pred$bsex==1,]
predFC = pred[pred$bhost==-1 & pred$bsex==1,]
predMK = pred[pred$bhost==1 & pred$bsex==-1,]
predMC = pred[pred$bhost==-1 & pred$bsex==-1,]
# multi-variate model with year, sex, and host plant predicting wing morph
fit3 = glm(wing_morph_binom ~ sex_binom * pophost_binom +
sex_binom * dates, family = "binomial", data = raw_data)
xyr <- seq(sort(unique(dd$dates))[1],sort(unique(dd$dates))[10], 0.01)
set.seed(194842)
bsex = sample(c(-1,1), replace=TRUE, size=length(xyr))
bhost = sample(c(-1,1), replace=TRUE, size=length(xyr))
wprobs <- predict(fit3, list(sex_binom = bsex,
pophost_binom = bhost,
dates = xyr), type="response")
pred = as.data.frame(pred)
pred = as.Date.numeric(pred$xyr)
predFK = pred[pred$bhost==1 & pred$bsex==1,]
pred$bhost
pred
pred = cbind(xyr, bsex, bhost, wprobs)
pred = as.data.frame(pred)
pred$xyr = as.Date.numeric(pred$xyr)
predFK = pred[pred$bhost==1 & pred$bsex==1,]
predFC = pred[pred$bhost==-1 & pred$bsex==1,]
predMK = pred[pred$bhost==1 & pred$bsex==-1,]
predMC = pred[pred$bhost==-1 & pred$bsex==-1,]
# extract pvalue from best fit regression model
fit_pvalue = round(summary(M1)$coeff[,"Pr(>|z|)"][7],3)
pvalue = paste0("italic(p)[glm]==", fit_pvalue)
### Panel F
p9 = ggplot() +
ggtitle("F") + xlab("Year") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_yrs, color="gainsboro") +
geom_line(aes(x=predFK$xyr, y=predFK$wprobs), linetype = "dashed", color="darkgreen") +
geom_line(aes(x=predFC$xyr, y=predFC$wprobs), linetype = "dashed", color="skyblue2") +
geom_smooth(data=dd, method="loess", span=0.8,
mapping = aes(x = dates, y = wing_morph_binom, colour=`Sex`, fill=`Sex`)) +
geom_point(data=dd, mapping = aes(x = dates, y = wing_morph_binom, colour=`Sex`)) +
customPlot +
scale_color_manual(values=c("Females" = sex_col_pts[1], "Males" = sex_col_pts[2])) +
scale_fill_manual(values = c("Females" = sex_col_shade[1], "Males" = sex_col_shade[2])) +
ylim(0.3,1.2) +
theme(legend.position = "none")
p9 = p9 +
annotate(geom="text", x=xlab_yrs[7], y=1.05, label=alpha, parse=TRUE, size=6) +
annotate(geom="text", x=xlab_yrs[7], y=1.12, label=degree, parse=TRUE, size=6)
p9
hp_col_lines = c("skyblue2", "darkgreen")
### Panel F
p9 = ggplot() +
ggtitle("F") + xlab("Year") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_yrs, color="gainsboro") +
geom_line(aes(x=predFK$xyr, y=predFK$wprobs), linetype = "dashed", color=sex_col_lines[2]) +
geom_line(aes(x=predFC$xyr, y=predFC$wprobs), linetype = "dashed", color=sex_col_lines[1]) +
geom_smooth(data=dd, method="loess", span=0.8,
mapping = aes(x = dates, y = wing_morph_binom, colour=`Sex`, fill=`Sex`)) +
geom_point(data=dd, mapping = aes(x = dates, y = wing_morph_binom, colour=`Sex`)) +
customPlot +
scale_color_manual(values=c("Females" = sex_col_pts[1], "Males" = sex_col_pts[2])) +
scale_fill_manual(values = c("Females" = sex_col_shade[1], "Males" = sex_col_shade[2])) +
ylim(0.3,1.2) +
theme(legend.position = "none")
sex_col_lines = c("brown3", "black")
### Panel F
p9 = ggplot() +
ggtitle("F") + xlab("Year") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_yrs, color="gainsboro") +
geom_line(aes(x=predFK$xyr, y=predFK$wprobs), linetype = "dashed", color=sex_col_lines[2]) +
geom_line(aes(x=predFC$xyr, y=predFC$wprobs), linetype = "dashed", color=sex_col_lines[1]) +
geom_smooth(data=dd, method="loess", span=0.8,
mapping = aes(x = dates, y = wing_morph_binom, colour=`Sex`, fill=`Sex`)) +
geom_point(data=dd, mapping = aes(x = dates, y = wing_morph_binom, colour=`Sex`)) +
customPlot +
scale_color_manual(values=c("Females" = sex_col_pts[1], "Males" = sex_col_pts[2])) +
scale_fill_manual(values = c("Females" = sex_col_shade[1], "Males" = sex_col_shade[2])) +
ylim(0.3,1.2) +
theme(legend.position = "none")
p9 = p9 +
annotate(geom="text", x=xlab_yrs[7], y=1.05, label=alpha, parse=TRUE, size=6) +
annotate(geom="text", x=xlab_yrs[7], y=1.12, label=degree, parse=TRUE, size=6)
p9
# multi-variate model with year, sex, and host plant predicting wing morph
fit3 = glm(wing_morph_binom ~ sex_binom * pophost_binom +
sex_binom * dates, family = "binomial", data = raw_data)
xyr <- seq(sort(unique(dd$dates))[1],sort(unique(dd$dates))[10], 0.01)
set.seed(194842)
bsex = sample(c(-1,1), replace=TRUE, size=length(xyr))
bhost = sample(c(-1,1), replace=TRUE, size=length(xyr))
wprobs <- predict(fit3, list(sex_binom = bsex,
pophost_binom = bhost,
dates = xyr), type="response")
pred = cbind(xyr, bsex, bhost, wprobs)
pred = as.data.frame(pred)
pred$xyr = as.Date.numeric(pred$xyr)
predF = pred[pred$bsex==1,]
predM = pred[pred$bsex==-1,]
# extract pvalue from best fit regression model
fit_pvalue = round(summary(M1)$coeff[,"Pr(>|z|)"][7],3)
pvalue = paste0("italic(p)[glm]==", fit_pvalue)
### Panel F
p9 = ggplot() +
ggtitle("F") + xlab("Year") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_yrs, color="gainsboro") +
geom_line(aes(x=predF$xyr, y=predFK$wprobs), linetype = "dashed", color=sex_col_lines[2]) +
geom_line(aes(x=predM$xyr, y=predFC$wprobs), linetype = "dashed", color=sex_col_lines[1]) +
geom_smooth(data=dd, method="loess", span=0.8,
mapping = aes(x = dates, y = wing_morph_binom, colour=`Sex`, fill=`Sex`)) +
geom_point(data=dd, mapping = aes(x = dates, y = wing_morph_binom, colour=`Sex`)) +
customPlot +
scale_color_manual(values=c("Females" = sex_col_pts[1], "Males" = sex_col_pts[2])) +
scale_fill_manual(values = c("Females" = sex_col_shade[1], "Males" = sex_col_shade[2])) +
ylim(0.3,1.2) +
theme(legend.position = "none")
p9 = p9 +
annotate(geom="text", x=xlab_yrs[7], y=1.05, label=alpha, parse=TRUE, size=6) +
annotate(geom="text", x=xlab_yrs[7], y=1.12, label=degree, parse=TRUE, size=6)
p9
predF
# multi-variate model with year, sex, and host plant predicting wing morph
fit3 = glm(wing_morph_binom ~ sex_binom * dates, family = "binomial", data = raw_data)
xyr <- seq(sort(unique(dd$dates))[1],sort(unique(dd$dates))[10], 0.01)
set.seed(194842)
bsex = sample(c(-1,1), replace=TRUE, size=length(xyr))
bhost = sample(c(-1,1), replace=TRUE, size=length(xyr))
wprobs <- predict(fit3, list(sex_binom = bsex,
pophost_binom = bhost,
dates = xyr), type="response")
pred = cbind(xyr, bsex, bhost, wprobs)
pred = as.data.frame(pred)
predF = pred[pred$bsex==1,]
# extract pvalue from best fit regression model
fit_pvalue = round(summary(M1)$coeff[,"Pr(>|z|)"][7],3)
pvalue = paste0("italic(p)[glm]==", fit_pvalue)
### Panel F
p9 = ggplot() +
ggtitle("F") + xlab("Year") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_yrs, color="gainsboro") +
geom_line(aes(x=predF$xyr, y=predFK$wprobs), linetype = "dashed", color=sex_col_lines[2]) +
geom_line(aes(x=predM$xyr, y=predFC$wprobs), linetype = "dashed", color=sex_col_lines[1]) +
geom_smooth(data=dd, method="loess", span=0.8,
mapping = aes(x = dates, y = wing_morph_binom, colour=`Sex`, fill=`Sex`)) +
geom_point(data=dd, mapping = aes(x = dates, y = wing_morph_binom, colour=`Sex`)) +
customPlot +
scale_color_manual(values=c("Females" = sex_col_pts[1], "Males" = sex_col_pts[2])) +
scale_fill_manual(values = c("Females" = sex_col_shade[1], "Males" = sex_col_shade[2])) +
ylim(0.3,1.2) +
theme(legend.position = "none")
p9 = p9 +
annotate(geom="text", x=xlab_yrs[7], y=1.05, label=alpha, parse=TRUE, size=6) +
annotate(geom="text", x=xlab_yrs[7], y=1.12, label=degree, parse=TRUE, size=6)
p9
### Panel F
p9 = ggplot() +
ggtitle("F") + xlab("Year") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_yrs, color="gainsboro") +
geom_line(aes(x=predF$xyr, y=predF$wprobs), linetype = "dashed", color=sex_col_lines[2]) +
geom_line(aes(x=predM$xyr, y=predM$wprobs), linetype = "dashed", color=sex_col_lines[1]) +
geom_smooth(data=dd, method="loess", span=0.8,
mapping = aes(x = dates, y = wing_morph_binom, colour=`Sex`, fill=`Sex`)) +
geom_point(data=dd, mapping = aes(x = dates, y = wing_morph_binom, colour=`Sex`)) +
customPlot +
scale_color_manual(values=c("Females" = sex_col_pts[1], "Males" = sex_col_pts[2])) +
scale_fill_manual(values = c("Females" = sex_col_shade[1], "Males" = sex_col_shade[2])) +
ylim(0.3,1.2) +
theme(legend.position = "none")
p9 = p9 +
annotate(geom="text", x=xlab_yrs[7], y=1.05, label=alpha, parse=TRUE, size=6) +
annotate(geom="text", x=xlab_yrs[7], y=1.12, label=degree, parse=TRUE, size=6)
p9
predF$xyr
# multi-variate model with year, sex, and host plant predicting wing morph
fit3 = glm(wing_morph_binom ~ sex_binom * dates, family = "binomial", data = raw_data)
xyr <- seq(sort(unique(dd$dates))[1],sort(unique(dd$dates))[10], 0.01)
set.seed(194842)
bsex = sample(c(-1,1), replace=TRUE, size=length(xyr))
bhost = sample(c(-1,1), replace=TRUE, size=length(xyr))
wprobs <- predict(fit3, list(sex_binom = bsex,
pophost_binom = bhost,
dates = xyr), type="response")
pred = cbind(xyr, bsex, bhost, wprobs)
pred = as.data.frame(pred)
pred$xyr = as.Date.numeric(pred$xyr)
predF = pred[pred$bsex==1,]
predM = pred[pred$bsex==-1,]
# extract pvalue from best fit regression model
fit_pvalue = round(summary(M1)$coeff[,"Pr(>|z|)"][7],3)
pvalue = paste0("italic(p)[glm]==", fit_pvalue)
pred$xyr
predM
predF
### Panel F
p9 = ggplot() +
ggtitle("F") + xlab("Year") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_yrs, color="gainsboro") +
geom_line(aes(x=predF$xyr, y=predF$wprobs), linetype = "dashed", color=sex_col_lines[2]) +
geom_line(aes(x=predM$xyr, y=predM$wprobs), linetype = "dashed", color=sex_col_lines[1]) +
geom_smooth(data=dd, method="loess", span=0.8,
mapping = aes(x = dates, y = wing_morph_binom, colour=`Sex`, fill=`Sex`)) +
geom_point(data=dd, mapping = aes(x = dates, y = wing_morph_binom, colour=`Sex`)) +
customPlot +
scale_color_manual(values=c("Females" = sex_col_pts[1], "Males" = sex_col_pts[2])) +
scale_fill_manual(values = c("Females" = sex_col_shade[1], "Males" = sex_col_shade[2])) +
ylim(0.3,1.2) +
theme(legend.position = "none")
p9 = p9 +
annotate(geom="text", x=xlab_yrs[7], y=1.05, label=alpha, parse=TRUE, size=6) +
annotate(geom="text", x=xlab_yrs[7], y=1.12, label=degree, parse=TRUE, size=6)
p9
### Panel F
p9 = ggplot() +
ggtitle("F") + xlab("Year") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_yrs, color="gainsboro") +
geom_line(aes(x=predF$xyr, y=predF$wprobs), linetype = "dashed", color=sex_col_lines[1]) +
geom_line(aes(x=predM$xyr, y=predM$wprobs), linetype = "dashed", color=sex_col_lines[2]) +
geom_smooth(data=dd, method="loess", span=0.8,
mapping = aes(x = dates, y = wing_morph_binom, colour=`Sex`, fill=`Sex`)) +
geom_point(data=dd, mapping = aes(x = dates, y = wing_morph_binom, colour=`Sex`)) +
customPlot +
scale_color_manual(values=c("Females" = sex_col_pts[1], "Males" = sex_col_pts[2])) +
scale_fill_manual(values = c("Females" = sex_col_shade[1], "Males" = sex_col_shade[2])) +
ylim(0.3,1.2) +
theme(legend.position = "none")
p9 = p9 +
annotate(geom="text", x=xlab_yrs[7], y=1.05, label=alpha, parse=TRUE, size=6) +
annotate(geom="text", x=xlab_yrs[7], y=1.12, label=degree, parse=TRUE, size=6)
p9
### Panel F
p9 = ggplot() +
ggtitle("F") + xlab("Year") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_yrs, color="gainsboro") +
geom_line(aes(x=predF$xyr, y=predF$wprobs), color=sex_col_lines[1], linetype = "dashed") +
geom_line(aes(x=predM$xyr, y=predM$wprobs), linetype = "dashed", color=sex_col_lines[2]) +
geom_smooth(data=dd, method="loess", span=0.8,
mapping = aes(x = dates, y = wing_morph_binom, colour=`Sex`, fill=`Sex`)) +
geom_point(data=dd, mapping = aes(x = dates, y = wing_morph_binom, colour=`Sex`)) +
customPlot +
scale_color_manual(values=c("Females" = sex_col_pts[1], "Males" = sex_col_pts[2])) +
scale_fill_manual(values = c("Females" = sex_col_shade[1], "Males" = sex_col_shade[2])) +
ylim(0.3,1.2) +
theme(legend.position = "none")
p9 = p9 +
annotate(geom="text", x=xlab_yrs[7], y=1.05, label=alpha, parse=TRUE, size=6) +
annotate(geom="text", x=xlab_yrs[7], y=1.12, label=degree, parse=TRUE, size=6)
p9
### Panel F
p9 = ggplot() +
ggtitle("F") + xlab("Year") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_yrs, color="gainsboro") +
geom_line(aes(x=predF$xyr, y=predF$wprobs), linetype = "dashed", color=sex_col_lines[1]) +
geom_line(aes(x=predM$xyr, y=predM$wprobs), linetype = "dashed", color=sex_col_lines[2]) +
geom_smooth(data=dd, method="loess", span=0.8,
mapping = aes(x = dates, y = wing_morph_binom, colour=`Sex`, fill=`Sex`)) +
geom_point(data=dd, mapping = aes(x = dates, y = wing_morph_binom, colour=`Sex`)) +
customPlot +
scale_color_manual(values=c("Females" = sex_col_pts[1], "Males" = sex_col_pts[2])) +
scale_fill_manual(values = c("Females" = sex_col_shade[1], "Males" = sex_col_shade[2])) +
ylim(0.3,1.2) +
theme(legend.position = "none")
p9 = p9 +
annotate(geom="text", x=xlab_yrs[7], y=1.05, label=alpha, parse=TRUE, size=6) +
annotate(geom="text", x=xlab_yrs[7], y=1.12, label=degree, parse=TRUE, size=6) +
annotate(geom="text", x=xlab_yrs[4], y=0.5, label=pvalue, parse=TRUE)
p9
### Panel F
p9 = ggplot() +
ggtitle("F") + xlab("Year") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_yrs, color="gainsboro") +
geom_line(aes(x=predF$xyr, y=predF$wprobs), linetype = "dashed", color=sex_col_lines[1]) +
geom_line(aes(x=predM$xyr, y=predM$wprobs), linetype = "dashed", color=sex_col_lines[2]) +
geom_smooth(data=dd, method="loess", span=0.8,
mapping = aes(x = dates, y = wing_morph_binom, colour=`Sex`, fill=`Sex`)) +
geom_point(data=dd, mapping = aes(x = dates, y = wing_morph_binom, colour=`Sex`)) +
customPlot +
scale_color_manual(values=c("Females" = sex_col_pts[1], "Males" = sex_col_pts[2])) +
scale_fill_manual(values = c("Females" = sex_col_shade[1], "Males" = sex_col_shade[2])) +
ylim(0.3,1.2) +
theme(legend.position = "none")
p9 = p9 +
annotate(geom="text", x=xlab_yrs[7], y=1.05, label=alpha, parse=TRUE, size=6) +
annotate(geom="text", x=xlab_yrs[7], y=1.12, label=degree, parse=TRUE, size=6) +
annotate(geom="text", x=xlab_yrs[4], y=0.40, label=pvalue, parse=TRUE, size=6)
p9
### Panel F
p9 = ggplot() +
ggtitle("F") + xlab("Year") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_yrs, color="gainsboro") +
geom_line(aes(x=predF$xyr, y=predF$wprobs),  color=sex_col_lines[1]) +
geom_line(aes(x=predM$xyr, y=predM$wprobs), linetype = "dashed", color=sex_col_lines[2]) +
geom_smooth(data=dd, method="loess", span=0.8,
mapping = aes(x = dates, y = wing_morph_binom, colour=`Sex`, fill=`Sex`)) +
geom_point(data=dd, mapping = aes(x = dates, y = wing_morph_binom, colour=`Sex`)) +
customPlot +
scale_color_manual(values=c("Females" = sex_col_pts[1], "Males" = sex_col_pts[2])) +
scale_fill_manual(values = c("Females" = sex_col_shade[1], "Males" = sex_col_shade[2])) +
ylim(0.3,1.2) +
theme(legend.position = "none")
p9 = p9 +
annotate(geom="text", x=xlab_yrs[7], y=1.05, label=alpha, parse=TRUE, size=6) +
annotate(geom="text", x=xlab_yrs[7], y=1.12, label=degree, parse=TRUE, size=6) +
annotate(geom="text", x=xlab_yrs[4], y=0.40, label=pvalue, parse=TRUE, size=6)
p9
