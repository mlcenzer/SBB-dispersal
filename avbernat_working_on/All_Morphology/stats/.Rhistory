WING2BODY_ML = get_significant_models(21) # wing2body
# 2 vs. -1
#Odds = c("$\\frac{P(Yi=flew\\,twice)}{P(Yi=flew\\, in\\, T1\\, only)}$", " ", " ", " ")
Odds = c("$\\underline{P(Yi=flew\\,twice)}$", "$P(Yi=flew\\, in\\, T1\\, only)$", " ", " ")
effect = c("Intercept", "$\\delta$ Mass %", "Sex", "Wing-to-Body")
pars = c("$\\alpha$", "$\\beta_1$", "$\\beta_2\\, (F=1 | M=-1)$", "$\\beta_3\\,(\\mu=0)$ ")
key1 = getting_odds(Odds, effect, pars, MASS_PER_ML[[1]], 3)
# 2 vs. 1
Odds = c("$\\underline{P(Yi=flew\\,twice)}$", "$P(Yi=flew\\, in\\, T2\\, only)$", " ", " ")
key2 = getting_odds(Odds, effect, pars, MASS_PER_ML[[3]], 3)
# 2 vs. 0
Odds = c("$\\underline{P(Yi=flew\\,twice)}$", "$P(Yi=did\\, not\\, fly)$", " ", " ")
key3 = getting_odds(Odds, effect, pars, MASS_PER_ML[[2]], 3)
# -1 vs. 0
Odds = c("$\\underline{P(Yi=flew\\, in\\, T1\\, only)}$", "$P(Yi=did\\, not\\, fly)$", " ", " ")
key4 = getting_odds(Odds, effect, pars, MASS_PER_ML[[2]], 1)
# 1 vs. 0
Odds = c("$\\underline{P(Yi=flew\\, in\\, T2\\, only)}$", "$P(Yi=did\\, not\\, fly)$", " ", " ")
key5 = getting_odds(Odds, effect, pars, MASS_PER_ML[[2]], 2)
# -1 vs. 1
Odds = c("$\\underline{P(Yi=flew\\, in\\, T1\\, only)}$", "$P(Yi=flew\\, in\\, T2\\, only)$", " ", " ")
key6 = getting_odds(Odds, effect, pars, MASS_PER_ML[[3]], 2)
key = rbind(key1, key2, key3, key4, key5, key6)
rownames(key)<-NULL
colnames(key) = c("Odds","Effect", "Parameter", "Estimate", "SE", "exp($\\beta$)*", "Wald", "p")
#  "exp($\\sum_{n=1}^{3}{\\beta_n}$)*"
kable(key, caption="Table 1. Estimated Parameters, Standard Errors, and Wald Test Statistics for All Main Effects Model") %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed"))  %>%
column_spec(1, width="6cm", background="white") %>%
kable_classic(html_font = "Cambria") %>%
row_spec(c(4,8,12,16,20), extra_css = "border-bottom: 1px solid") %>%
#column_spec(1, color = "black", background = "white") %>%
footnote(general = " * Instead of a 1% mass increase, which is relatively too small, or a 1 unit increase in the ratio, which is 2 magnitudes higher than approximately one standard deviation from the mean, mass and wing-to-body ratio estimates were multiplied by 20 and divided by 100, respectively, before calculating the log odds. These changes better represent experimental observation and offers a more realistic impact on the odds. ",
general_title = " ", number_title = "* "
)
# t1 vs. did not fly
#exp(-0.01 - 0.76 + 28.09/100) # 20% increase in mass, female, and 1/20 increase in the wing2body ratio length
1/40
exp(23.74/40-.57)
exp(23.74/40+.57)
exp(0.02*0 + 0.76 + 28.09/100)
min(d$wing2body) - max(d$wing2body)
exp(0.02*20 - 0.76 + 28.09/100) # 20% increase in mass, female, and 1/20 increase in the wing2body ratio length
exp(0.02*0 + 0.76 + 28.09/100)
# confidence interval for wing2body ratio
exp((28.09 + 1.96*9.72)/100)
exp((28.09 - 1.96*9.72)/100)
head(pp <- fitted(model))
df$index = 1:nrow(df)
females = df %>%
filter(sex=="F")
males = df %>%
filter(sex=="M")
Frows = females$index
Mrows = males$index
plot4 = function(df, pp, PP, gradient=TRUE, circles=TRUE, stochasticity=TRUE, points=TRUE) {
c = 0.65
c2 = 1.2
if (stochasticity) {
plot(df$mass_per[Frows], pp[Frows,1], ylim=c(0,1), xlim=c(-40,104), col="red",type="l",
ylab="Flight Case Probability", xlab="Percent Change in Mass From T1 to T2 (%)",
lty=1, cex.axis=1.2, cex.lab=1.3)
points(df$mass_per[Frows], pp[Frows,2], col="blue", type="l")
points(df$mass_per[Frows], pp[Frows,4], col="darkorange1", type="l") #darkred
}
if (points){
plot(df$mass_per[Frows], PP[Frows,1], ylim=c(0,1), xlim=c(-40,104), col="red",type="l",
ylab="Flight Case Probability", xlab="Percent Change in Mass From T1 to T2 (%)",
lty=1, cex.axis=1.2, cex.lab=1.3)
points(df$mass_per[Frows], PP[Frows,2], col="blue", type="l")
points(df$mass_per[Frows], PP[Frows,4], col="darkorange1", type="l") #darkred
}
mtext(expression(italic("Females")), side=3, adj=0.05, line=-2, cex=1.5, font=2)
mtext("B", side=3, adj=0.01, line=0.5, cex=1.5, font=2)
text(64,0.7, labels="Flew in T1 only", col="blue", cex=c2)
text(22,0.85, labels="Did Not Fly", col="red", cex=c2)
text(82,0.37, labels="Flew Twice", col="darkorange3", cex=c2) #maroon
#text(53, 0.99, labels = expression(italic("flight_case ~ mass% + sex + wing2body")), cex=1.2)
# legend(49, 1.1,
#        lty=1,
#        col=c("darkred", "blue", "darkgreen", "red"),
#        legend=c("Flew Twice", "Flew T1 Only", "Flew T2 Only", "Did Not Fly"),
#        text.col=c("darkred", "blue", "darkgreen", "red"),
#        cex=1.1)
if (gradient) {
rbPal <- colorRampPalette(c('black','red'))
df$w2b_col <- rbPal(10)[as.numeric(cut(df$wing2body,breaks = 10))]
points(df$mass_per[Frows], pp[Frows, 1], pch=20, col=df$w2b_col[Frows])
rbPal <- colorRampPalette(c('black','royalblue1'))
df$w2b_col <- rbPal(10)[as.numeric(cut(df$wing2body,breaks = 10))]
points(df$mass_per[Frows], pp[Frows, 2], pch=20, col=df$w2b_col[Frows])
rbPal <- colorRampPalette(c('black','orange')) # violetred1
df$w2b_col <- rbPal(10)[as.numeric(cut(df$wing2body,breaks = 10))]
points(df$mass_per[Frows], pp[Frows, 4], pch=20, col=df$w2b_col[Frows])
}
if (circles) {
# Mark points in the graph with high wing2body ratio vs. points with low wing2body ratio.
test <- df[with(df, order(wing2body)),] # ascending order
small = test %>%
filter(sex =="F", wing2body < 0.7184934)
large = test %>%
filter(sex == "F", wing2body > 0.7184934)
srows = small$index
lrows = large$index
points(df$mass_per[lrows], pp[lrows,1], col="red", type="p", cex=c, pch=16)
points(df$mass_per[srows], pp[srows,1], col="red", type="p", cex=c)
# those with smaller wing2body ratio were more likely to NOT fly
points(df$mass_per[lrows], pp[lrows,2], col="blue", type="p", cex=c, pch=16)
points(df$mass_per[srows], pp[srows,2], col="blue", type="p", cex=c)
points(df$mass_per[lrows], pp[lrows,4], col="darkred", type="p", cex=c, pch=16)
points(df$mass_per[srows], pp[srows,4], col="darkred", type="p", cex=c)
}
}
pp6 = pp
df6 = df
plot5 = function(df, pp, PP, gradient=TRUE, circles=TRUE, stochasticity=TRUE, points=TRUE) {
c = 0.65
c2 = 1.2
if (stochasticity) {
plot(df$mass_per[Mrows], pp[Mrows,1], ylim=c(-0.00,0.8+0.05), xlim=c(-25,58), col="red",type="l",
ylab=" ", xlab="Percent Mass Change from T1 to T2 (%)",
lty=1, cex.axis=1.2, cex.lab=1.3)
points(df$mass_per[Mrows], pp[Mrows,2], col="blue", type="l", cex=0.45, lty=1)
points(df$mass_per[Mrows], pp[Mrows,3], col="darkgreen", type="l", cex=0.45, lty=1)
points(df$mass_per[Mrows], pp[Mrows,4], col="darkorange1", type="l", cex=0.45, lty=1) # darkred
}
if (points) {
plot(df$mass_per[Mrows], PP[Mrows,1], ylim=c(-0.00,0.8), xlim=c(-25,58), col="red",type="l",
ylab=" ", xlab="Percent Mass Change from T1 to T2 (%)",
lty=1, cex.axis=1.2, cex.lab=1.3)
points(df$mass_per[Mrows], PP[Mrows,2], col="blue", type="l", cex=0.45, lty=1)
points(df$mass_per[Mrows], PP[Mrows,3], col="darkgreen", type="l", cex=0.45, lty=1)
points(df$mass_per[Mrows], PP[Mrows,4], col="darkorange1", type="l", cex=0.45, lty=1) # darkred
}
mtext(expression(italic("Males")), side=3, adj=0.05, line=-2, cex=1.5, font=2)
mtext("C", side=3, adj=0.01, line=0.5, cex=1.5, font=2)
text(22,0.35, labels="Flew in T1 only", col="blue", cex=c2)
text(52,0.17, labels="Did Not Fly", col="red", cex=c2)
text(-16, 0, labels="Flew in T2 only", col="darkgreen", cex=c2)
text(-17,0.69, labels="Flew Twice", col="darkorange3", cex=c2) # 13,0.77, maroon, 13,0.77
if (circles) {
legend(39, .81+0.05,
pch=c(16,1),
title="Wing-to-body",
legend=c("> mean", "< mean"),
cex=1.1)
}
if (gradient) {
text(50,0.84, labels="Wing-to-body", cex=c2)
#label = c("0.77", "0.70", "0.63")
# legend(39, .81+0.05,
#        pch=c(16),
#        title="Wing-to-body",
#        col=c("grey", "grey50", "black"),
#        legend=label, #c("high", "low")
#        cex=1.1)
}
if (gradient) {
rbPal <- colorRampPalette(c('black','red'))
df$w2b_col <- rbPal(10)[as.numeric(cut(df$wing2body,breaks = 10))]
points(df$mass_per[Mrows], pp[Mrows, 1], pch=20, col=df$w2b_col[Mrows])
rbPal <- colorRampPalette(c('black','royalblue1'))
df$w2b_col <- rbPal(10)[as.numeric(cut(df$wing2body,breaks = 10))]
points(df$mass_per[Mrows], pp[Mrows, 2], pch=20, col=df$w2b_col[Mrows])
rbPal <- colorRampPalette(c('black','palegreen2'))
df$w2b_col <- rbPal(10)[as.numeric(cut(df$wing2body,breaks = 10))]
points(df$mass_per[Mrows], pp[Mrows, 3], pch=20, col=df$w2b_col[Mrows])
rbPal <- colorRampPalette(c('black','orange')) #violetred1
df$w2b_col <- rbPal(10)[as.numeric(cut(df$wing2body,breaks = 10))]
points(df$mass_per[Mrows], pp[Mrows, 4], pch=20, col=df$w2b_col[Mrows])
}
if (circles) {
# Mark points in the graph with high wing2body ratio vs. points with low wing2body ratio.
test <- df[with(df, order(wing2body)),] # ascending order
#test$index
small = test %>%
filter(sex =="M", wing2body < 0.7184934)
large = test %>%
filter(sex == "M", wing2body > 0.7184934)
srows = small$index
lrows = large$index
points(df$mass_per[lrows], pp[lrows,1], col="red", type="p", cex=c, pch=16)
points(df$mass_per[srows], pp[srows,1], col="red", type="p", cex=c)
# those with smaller wing2body ratio were more likely to NOT fly
points(df$mass_per[lrows], pp[lrows,2], col="blue", type="p", cex=c, pch=16)
points(df$mass_per[srows], pp[srows,2], col="blue", type="p", cex=c)
points(df$mass_per[lrows], pp[lrows,3], col="darkgreen", type="p", cex=c, pch=16)
points(df$mass_per[srows], pp[srows,3], col="darkgreen", type="p", cex=c)
points(df$mass_per[lrows], pp[lrows,4], col="darkred", type="p", cex=c, pch=16)
points(df$mass_per[srows], pp[srows,4], col="darkred", type="p", cex=c)
}
}
# Function to plot color bar
color.bar <- function(lut, min, max=77, nticks=3, ticks=seq(min, max, len=nticks), title='') {
scale = (length(lut)-1)/(max-min)
final_ticks=seq(min/100, max/100, len=nticks)
#final_ticks = c("0.63", "0.66", "0.70", "0.74", "0.77")
final_ticks = c("0.63", "0.70", "0.77")
#dev.new(width=1.75, height=5)
plot(c(0,10), c(min,max), type='n', bty='n', xaxt='n', xlab='', yaxt='n', ylab='', main=title)
axis(2, ticks, las=1, labels=final_ticks)
for (i in 1:(length(lut)-1)) {
y = (i-1)/scale + min
rect(0,y,10,y+1/scale, col=lut[i], border=NA)
}
}
color.bar(colorRampPalette(c("black", "grey"))(1000), 63)
par(mfrow=c(1,2), tcl=-0.5) # length of tick marks set at default
par(mai=c(1,0.85,0.4,0)) # bottom, right, top, left
plot4(df6,pp6, pp3, gradient=TRUE, circles=FALSE, stochasticity=TRUE, points=FALSE)
par(mai=c(1,0.6,0.4,0.05))
plot5(df6,pp6, pp3, gradient=TRUE, circles=FALSE, stochasticity=TRUE, points=FALSE)
x = 0.48
v <- c(x-0.13,x, 0.85, 0.90)
par( fig=v, new=TRUE, mar=c(0,0,0,0) )
hist(df$wing2body[Frows], col="white", main="", cex.axis=0.9, ylab="freq", xlab="w2b")
text(0.64,45, labels="w2b", cex=0.9)
x = 0.88
v <- c(x-0.13, x, 0.85, 0.90)
par( fig=v, new=TRUE, mar=c(0,0,0,0) )
hist(df$wing2body[Mrows], col="white", main="", cex.axis=0.9, xlim=c(0.64,0.78), ylab="freq", xlab="w2b")
text(0.66,40, labels="w2b", cex=0.9)
x = 0.98
v <- c(x-0.025, x, 0.75, 0.86)
par( fig=v, new=TRUE, mar=c(0,0,0,0) )
color.bar(colorRampPalette(c("black", "grey"))(1000), 63)
par(mfrow=c(1,2), tcl=-0.5) # length of tick marks set at default
par(mai=c(1,0.85,0.4,0)) # bottom, right, top, left
plot4(df6,pp6, pp3, gradient=TRUE, circles=FALSE, stochasticity=TRUE, points=FALSE)
par(mai=c(1,0.6,0.4,0.05))
plot5(df6,pp6, pp3, gradient=TRUE, circles=FALSE, stochasticity=TRUE, points=FALSE)
plot_histograms = function() {
x = 0.48
v <- c(x-0.13,x, 0.85, 0.90)
par( fig=v, new=TRUE, mar=c(0,0,0,0) )
hist(df$wing2body[Frows], col="white", main="", cex.axis=0.9)
text(0.64,45, labels="w2b", cex=0.9)
x = 0.88
v <- c(x-0.13, x, 0.85, 0.90)
par( fig=v, new=TRUE, mar=c(0,0,0,0) )
hist(df$wing2body[Mrows], col="white", main="", cex.axis=0.9, xlim=c(0.64,0.78))
text(0.66,40, labels="w2b", cex=0.9)
}
x = 0.98
v <- c(x-0.025, x, 0.75, 0.86)
par( fig=v, new=TRUE, mar=c(0,0,0,0) )
color.bar(colorRampPalette(c("black", "grey"))(1000), 63)
par(mfrow=c(1,2), tcl=-0.5) # length of tick marks set at default
par(mai=c(1,0.85,0.4,0)) # bottom, right, top, left
plot4(df6,pp6, pp3, gradient=TRUE, circles=FALSE, stochasticity=TRUE, points=FALSE)
par(mai=c(1,0.6,0.4,0.05))
plot5(df6,pp6, pp3, gradient=TRUE, circles=FALSE, stochasticity=TRUE, points=FALSE)
plot_histograms = function() {
x = 0.48
v <- c(x-0.13,x, 0.85, 0.90)
par( fig=v, new=TRUE, mar=c(0,0,0,0) )
hist(df$wing2body[Frows], col="white", main="", cex.axis=0.9)
text(0.64,45, labels="w2b", cex=0.9)
x = 0.88
v <- c(x-0.13, x, 0.85, 0.90)
par( fig=v, new=TRUE, mar=c(0,0,0,0) )
hist(df$wing2body[Mrows], col="white", main="", cex.axis=0.9, xlim=c(0.64,0.78))
text(0.66,40, labels="w2b", cex=0.9)
}
plot_histograms
x = 0.98
v <- c(x-0.025, x, 0.75, 0.86)
par( fig=v, new=TRUE, mar=c(0,0,0,0) )
color.bar(colorRampPalette(c("black", "grey"))(1000), 63)
par(mfrow=c(1,2), tcl=-0.5) # length of tick marks set at default
par(mai=c(1,0.85,0.4,0)) # bottom, right, top, left
plot4(df6,pp6, pp3, gradient=TRUE, circles=FALSE, stochasticity=TRUE, points=FALSE)
par(mai=c(1,0.6,0.4,0.05))
plot5(df6,pp6, pp3, gradient=TRUE, circles=FALSE, stochasticity=TRUE, points=FALSE)
plot_histograms = function() {
x = 0.48
v <- c(x-0.13,x, 0.85, 0.90)
par( fig=v, new=TRUE, mar=c(0,0,0,0) )
hist(df$wing2body[Frows], col="white", main="", cex.axis=0.9)
text(0.64,45, labels="w2b", cex=0.9)
x = 0.88
v <- c(x-0.13, x, 0.85, 0.90)
par( fig=v, new=TRUE, mar=c(0,0,0,0) )
hist(df$wing2body[Mrows], col="white", main="", cex.axis=0.9, xlim=c(0.64,0.78))
text(0.66,40, labels="w2b", cex=0.9)
}
plot_histograms()
x = 0.98
v <- c(x-0.025, x, 0.75, 0.86)
par( fig=v, new=TRUE, mar=c(0,0,0,0) )
color.bar(colorRampPalette(c("black", "grey"))(1000), 63)
plot_histograms = function() {
x = 0.48
v <- c(x-0.13,x, 0.85, 0.90)
par( fig=v, new=TRUE, mar=c(0,0,0,0) )
hist(df$wing2body[Frows], col="white", main="", cex.axis=0.9)
text(0.64,45, labels="w2b", cex=0.9)
x = 0.88
v <- c(x-0.13, x, 0.85, 0.90)
par( fig=v, new=TRUE, mar=c(0,0,0,0) )
hist(df$wing2body[Mrows], col="white", main="", cex.axis=0.9, xlim=c(0.64,0.78))
text(0.66,40, labels="w2b", cex=0.9)
}
plot_color_scale = function() {
x = 0.98
v <- c(x-0.025, x, 0.75, 0.86)
par( fig=v, new=TRUE, mar=c(0,0,0,0) )
color.bar(colorRampPalette(c("black", "grey"))(1000), 63)
}
par(mfrow=c(1,2), tcl=-0.5) # length of tick marks set at default
par(mai=c(1,0.85,0.4,0)) # bottom, right, top, left
plot4(df6,pp6, pp3, gradient=TRUE, circles=FALSE, stochasticity=TRUE, points=FALSE)
par(mai=c(1,0.6,0.4,0.05))
plot5(df6,pp6, pp3, gradient=TRUE, circles=FALSE, stochasticity=TRUE, points=FALSE)
plot_histograms()
plot_color_scale()
# Function to plot color bar
color.bar <- function(lut, min, max=77, nticks=3, ticks=seq(min, max, len=nticks), title='') {
scale = (length(lut)-1)/(max-min)
final_ticks=seq(min/100, max/100, len=nticks)
#final_ticks = c("0.63", "0.66", "0.70", "0.74", "0.77")
final_ticks = c("0.63", "0.70", "0.77")
#dev.new(width=1.75, height=5)
plot(c(0,10), c(min,max), type='n', bty='n', xaxt='n', xlab='', yaxt='n', ylab='', main=title)
axis(2, ticks, las=1, labels=final_ticks)
for (i in 1:(length(lut)-1)) {
y = (i-1)/scale + min
rect(0,y,10,y+1/scale, col=lut[i], border=NA)
}
}
# getting those small subset plots and scales in the top right hand corner.
plot_histograms = function() {
x = 0.48
v <- c(x-0.13,x, 0.85, 0.90)
par( fig=v, new=TRUE, mar=c(0,0,0,0) )
hist(df$wing2body[Frows], col="white", main="", cex.axis=0.9)
text(0.64,45, labels="w2b", cex=0.9)
x = 0.88
v <- c(x-0.13, x, 0.85, 0.90)
par( fig=v, new=TRUE, mar=c(0,0,0,0) )
hist(df$wing2body[Mrows], col="white", main="", cex.axis=0.9, xlim=c(0.64,0.78))
text(0.66,40, labels="w2b", cex=0.9)
}
plot_color_scale = function() {
x = 0.98
v <- c(x-0.025, x, 0.75, 0.86)
par( fig=v, new=TRUE, mar=c(0,0,0,0) )
color.bar(colorRampPalette(c("black", "grey"))(1000), 63)
}
par(mfrow=c(1,2), tcl=-0.5) # length of tick marks set at default
par(mai=c(1,0.85,0.4,0)) # bottom, right, top, left
plot4(df6,pp6, pp3, gradient=TRUE, circles=FALSE, stochasticity=TRUE, points=FALSE)
par(mai=c(1,0.6,0.4,0.05))
plot5(df6,pp6, pp3, gradient=TRUE, circles=FALSE, stochasticity=TRUE, points=FALSE)
plot_histograms()
plot_color_scale()
plot3 = function(df, pp) {
c2 = 1.2
plot(df$mass_per[Frows], pp[Frows,1], ylim=c(0,1), xlim=c(-40,104), col="red",
type="l",
ylab="Flight Case Probability",
xlab="Percent Mass Change From T1 to T2 (%)", lty=1, cex.axis=1.2, cex.lab=1.3)
points(df$mass_per[Mrows], pp[Mrows,1], col="red", type="l", cex=0.45, lty=2)
points(df$mass_per[Frows], pp[Frows,2], col="blue", type="l", #type="b", cex=0.45, pch=16
)
points(df$mass_per[Mrows], pp[Mrows,2], col="blue", type="l", cex=0.45, lty=2)
points(df$mass_per[Frows], pp[Frows,3], col="darkgreen", cex=0.45, type="l", pch=16)
points(df$mass_per[Mrows], pp[Mrows,3], col="darkgreen", type="l", cex=0.45, lty=2)
points(df$mass_per[Frows], pp[Frows,4], col="darkorange3", type="l")
points(df$mass_per[Mrows], pp[Mrows,4], col="darkorange2", type="l", cex=0.45, lty=2, lwd=1.3)
mtext("A", side=3, adj=0.01, line=0.5, cex=1.5, font=2)
text(68,0.7, labels="Flew in T1 only", col="blue", cex=c2)
text(-27,0.9, labels="Did Not Fly", col="red", cex=c2)
text(13,0.37, labels="Flew Twice", col="darkorange3", cex=c2)
text(70,0.05, labels="Flew in T2 only", col="darkgreen", cex=c2)
legend(83, 1.0,
legend = c("female","male"),
lty=1:2,
col="black",
cex=1.1)
}
par(mfrow=c(1,1), tcl=-0.5)
#plot(0, xaxt = 'n', yaxt = 'n', bty = 'n', pch = '', ylab = '', xlab = '')
#par(mai=c(1,0,0.4,0.05))
plot3(df3,pp3)
par(mfrow=c(1,2), tcl=-0.5) # length of tick marks set at default
par(mai=c(1,0.85,0.4,0)) # bottom, right, top, left
plot4(df6,pp6, pp3, gradient=TRUE, circles=FALSE, stochasticity=TRUE, points=FALSE)
par(mai=c(1,0.6,0.4,0.05))
plot5(df6,pp6, pp3, gradient=TRUE, circles=FALSE, stochasticity=TRUE, points=FALSE)
plot_histograms()
plot_color_scale()
par(mfrow=c(1,2), tcl=-0.5) # length of tick marks set at default
par(mai=c(1,0.85,0.4,2)) # bottom, right, top, left
plot4(df6,pp6, pp3, gradient=TRUE, circles=FALSE, stochasticity=TRUE, points=FALSE)
par(mai=c(1,0.6,0.4,0.05))
plot5(df6,pp6, pp3, gradient=TRUE, circles=FALSE, stochasticity=TRUE, points=FALSE)
plot_histograms()
plot_color_scale()
par(mfrow=c(1,2), tcl=-0.5) # length of tick marks set at default
par(mai=c(1,0.85,0.4,0)) # bottom, right, top, left
plot4(df6,pp6, pp3, gradient=TRUE, circles=FALSE, stochasticity=TRUE, points=FALSE)
par(mai=c(1,0.6,0.4,0.05))
plot5(df6,pp6, pp3, gradient=TRUE, circles=FALSE, stochasticity=TRUE, points=FALSE)
plot_histograms()
plot_color_scale()
rm(list=ls())
dir = "~/Desktop/git_repositories/SBB-dispersal/avbernat_working_on/All_Morphology/stats/"
setwd(dir)
library(lme4)
knitr::opts_chunk$set(echo = TRUE)
source_path = "~/Desktop/git_repositories/SBB-dispersal/avbernat_working_on/Rsrc/"
script_names = c("age calculator.R",
"AICprobabilities.R",
"compare_models.R") # must load if want to load any generic model scripts
for (script in script_names) {
path = paste0(source_path, script)
source(path)
}
#Load and prep metadata
#metadata
filepath = paste0(dir, "/data/labdata_8_29.csv")
data_raw<-read.csv(filepath, header=TRUE, sep=",", quote="", stringsAsFactors=FALSE)
metadata<-data_raw[data_raw$eclosion.date!="" & data_raw$eclosion.date!="eclosion.date", c(1,2,3,5,6,9,10)]
filepath = paste0(dir, "/data/morphology_females.csv")
morph_dataF<-read.csv(filepath, header=TRUE, sep=",", quote="", stringsAsFactors=FALSE)
filepath = paste0(dir, "/data/morphology_males.csv")
morph_dataM<-read.csv(filepath, header=TRUE, sep=",", quote="", stringsAsFactors=FALSE)
morph_data<-rbind(morph_dataF[,c(1,3,4,5,6,7,8)], morph_dataM[1:136,c(1,4,5,6,7,8,9)])
morph_data$sex[morph_data$sex=="FALSE"]<-"F"
data_with_reps<-cbind(morph_data, metadata[sapply(1:nrow(morph_data), function(x){which(metadata$ID==morph_data$ID_num[x])}),c(3,4,5,7)])
data<-data.frame(ID=unique(data_with_reps$ID_num), sex=NA, beak=NA, thorax=NA, wing=NA, body=NA, w_morph=NA, pop=NA, nathost=NA, nathost.site=NA)
#drop duplicates
for(ID in 1:nrow(data)){
data[ID,]<-data_with_reps[data_with_reps$ID_num==data$ID[ID],][1,1:10]
}
data$pophost<-"K.elegans"
data$pophost[data$pop=="PK" | data$pophost=="KL" | data$pophost=="NKL"]<-"C.corindum"
data2019<-data[data$w_morph=="L",]
data2019$wing2body<-data2019$wing/data2019$body
data2019$sex_binom<-1
data2019$sex_binom[data2019$sex=="M"]<--1
data2019$pophost_binom<--1
data2019$pophost_binom[data2019$pophost=="K.elegans"]<-1
data2019$nathost_binom<--1
data2019$nathost_binom[data2019$nathost=="K.elegans"]<-1
data<-data.frame(R=(data2019$wing2body-mean(data2019$wing2body, na.rm=TRUE)), A=data2019$sex_binom, B=data2019$pophost_binom, C=data2019$nathost_binom)
model_script = paste0(source_path,"generic models-gaussian glm 3-FF.R")
model_comparisonsAIC(model_script)
####NO nathost effect on wing2body ratio!
####What if look within each sex?
dataF<-data2019[data2019$sex=="F",]
modelF<-glm(wing2body~pophost_binom*nathost_binom, data=dataF)
summary(modelF)
dataF<-data2019[data2019$sex=="F",]
dataM<-data2019[data2019$sex=="M",]
modelM<-glm(wing2body~pophost_binom*nathost_binom, data=dataM)
summary(modelM)
par(mfrow=c(1,2), tcl=-0.5) # length of tick marks set at default
par(mai=c(1,0.85,0.4,0)) # bottom, right, top, left
plot4(df6,pp6, pp3, gradient=TRUE, circles=FALSE, stochasticity=TRUE, points=FALSE)
rm(list=ls())
dir = "~/Desktop/git_repositories/SBB-dispersal/avbernat_working_on/All_Morphology/stats/"
setwd(dir)
library(lme4)
knitr::opts_chunk$set(echo = TRUE)
source_path = "~/Desktop/git_repositories/SBB-dispersal/avbernat_working_on/Rsrc/"
script_names = c("age calculator.R",
"AICprobabilities.R",
"compare_models.R") # must load if want to load any generic model scripts
for (script in script_names) {
path = paste0(source_path, script)
source(path)
}
#Load and prep metadata
#metadata
filepath = paste0(dir, "/data/labdata_8_29.csv")
data_raw<-read.csv(filepath, header=TRUE, sep=",", quote="", stringsAsFactors=FALSE)
metadata<-data_raw[data_raw$eclosion.date!="" & data_raw$eclosion.date!="eclosion.date", c(1,2,3,5,6,9,10)]
filepath = paste0(dir, "/data/morphology_females.csv")
morph_dataF<-read.csv(filepath, header=TRUE, sep=",", quote="", stringsAsFactors=FALSE)
filepath = paste0(dir, "/data/morphology_males.csv")
morph_dataM<-read.csv(filepath, header=TRUE, sep=",", quote="", stringsAsFactors=FALSE)
morph_data<-rbind(morph_dataF[,c(1,3,4,5,6,7,8)], morph_dataM[1:136,c(1,4,5,6,7,8,9)])
morph_data$sex[morph_data$sex=="FALSE"]<-"F"
data_with_reps<-cbind(morph_data, metadata[sapply(1:nrow(morph_data), function(x){which(metadata$ID==morph_data$ID_num[x])}),c(3,4,5,7)])
data<-data.frame(ID=unique(data_with_reps$ID_num), sex=NA, beak=NA, thorax=NA, wing=NA, body=NA, w_morph=NA, pop=NA, nathost=NA, nathost.site=NA)
#drop duplicates
for(ID in 1:nrow(data)){
data[ID,]<-data_with_reps[data_with_reps$ID_num==data$ID[ID],][1,1:10]
}
data$pophost<-"K.elegans"
data$pophost[data$pop=="PK" | data$pophost=="KL" | data$pophost=="NKL"]<-"C.corindum"
data2019<-data[data$w_morph=="L",]
data2019$wing2body<-data2019$wing/data2019$body
data2019$sex_binom<-1
data2019$sex_binom[data2019$sex=="M"]<--1
data2019$pophost_binom<--1
data2019$pophost_binom[data2019$pophost=="K.elegans"]<-1
data2019$nathost_binom<--1
data2019$nathost_binom[data2019$nathost=="K.elegans"]<-1
data<-data.frame(R=(data2019$wing2body-mean(data2019$wing2body, na.rm=TRUE)), A=data2019$sex_binom, B=data2019$pophost_binom, C=data2019$nathost_binom)
model_script = paste0(source_path,"generic models-gaussian glm 3-FF.R")
model_comparisonsAIC(model_script)
data<-data.frame(R=(data2019$wing2body-mean(data2019$wing2body, na.rm=TRUE)),
A=data2019$sex_binom,
B=data2019$pophost_binom,
C=data2019$nathost_binom)
model_script = paste0(source_path,"generic models-gaussian glm 3-FF.R")
model_comparisonsAIC(model_script)
summary(m8)
summary(m8)
