geom_vline(xintercept = xlab_dates, color="gainsboro") +
# geom_smooth(data=dd, method="lm", se=FALSE, linetype = "dashed", lwd=0.5,
#             mapping = aes(x = month_of_year, y = wing_morph_binom), colour="black") +
geom_smooth(aes(x=month_of_year, y=success/(success+failure), succ=success, fail=failure),
method="glm",
method.args=list(family="binomial"),
formula = cbind(succ, fail) ~ x
)
raw_data
raw_data$success
raw_data$failure
ggplot(raw_data) +
ggtitle("A") + xlab("Month") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_dates, color="gainsboro") +
# geom_smooth(data=dd, method="lm", se=FALSE, linetype = "dashed", lwd=0.5,
#             mapping = aes(x = month_of_year, y = wing_morph_binom), colour="black") +
geom_smooth(aes(x=month_of_year, y=success/(success+failure), succ=success, fail=failure),
method="glm",
method.args=list(family="binomial"),
formula = cbind(succ, fail) ~ x
)
ggplot(raw_data) +
ggtitle("A") + xlab("Month") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_dates, color="gainsboro") +
# geom_smooth(data=dd, method="lm", se=FALSE, linetype = "dashed", lwd=0.5,
#             mapping = aes(x = month_of_year, y = wing_morph_binom), colour="black") +
geom_smooth(raw_data,
aes(x=month_of_year, y=success/(success+failure), succ=success, fail=failure),
method="glm",
method.args=list(family="binomial"),
formula = cbind(succ, fail) ~ x
)
ggplot(raw_data) +
ggtitle("A") + xlab("Month") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_dates, color="gainsboro") +
# geom_smooth(data=dd, method="lm", se=FALSE, linetype = "dashed", lwd=0.5,
#             mapping = aes(x = month_of_year, y = wing_morph_binom), colour="black") +
geom_smooth(raw_data,
mapping=aes(x=month_of_year, y=success/(success+failure), succ=success, fail=failure),
method="glm",
method.args=list(family="binomial"),
formula = cbind(succ, fail) ~ x
)
summary(M3)
summary(M3)
summary(M2)
coef(M2)[1]
coef(M2)[2]
coef(M2)
equation = function(x){coef(M2)[2] + coef(M2)[4]} # best fit model
p5 = ggplot(raw_data) +
ggtitle("A") + xlab("Month") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_dates, color="gainsboro") +
stat_function(fun=equation,geom="line", linetype="dashed") +
# geom_smooth(data=dd, method="lm", se=FALSE, linetype = "dashed", lwd=0.5,
#             mapping = aes(x = month_of_year, y = wing_morph_binom), colour="black") +
# geom_smooth(
#   mapping=aes(x=month_of_year, y=success/(success+failure), succ=success, fail=failure),
#   method="glm",
#   method.args=list(family="binomial"),
#   formula = cbind(succ, fail) ~ x
# ) +
geom_smooth(data=dd, method="loess",
mapping = aes(x = month_of_year, y = wing_morph_binom, colour=`Host Plant`, fill=`Host Plant`)) +
geom_point(data=dd, mapping = aes(x = month_of_year, y = wing_morph_binom, colour=`Host Plant`)) +
customPlot +
scale_color_manual(values=c("C. corindum" = "turquoise3", "K. elegans" = "springgreen4")) +
scale_fill_manual(values = c("C. corindum" = "turquoise3", "K. elegans" = "green")) +
scale_x_continuous(breaks=xlab_months, labels= month_labs) + ylim(0.3,1.2)
p6 = ggplot() +
ggtitle("B") + xlab("Month") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_dates, color="gainsboro") +
geom_smooth(data=dd, method="lm", se=FALSE, linetype = "dashed", lwd=0.5,
mapping = aes(x = month_of_year, y = wing_morph_binom), colour="black") +
geom_smooth(data=dd, method="loess",
mapping = aes(x = month_of_year, y = wing_morph_binom, colour=Sex, fill=Sex)) +
geom_point(data=dd, mapping = aes(x = month_of_year, y = wing_morph_binom, colour=Sex)) +
customPlot +
scale_color_manual(values=c("Females" = "brown3", "Males" = "black")) +
scale_fill_manual(values = c("Females" = "brown1", "Males" = "sienna4")) +
scale_x_continuous(breaks=xlab_months, labels= month_labs) + theme(axis.title.y = element_blank()) + ylim(0.3,1.2)
#### loess and linear regressions
alpha = paste("alpha[loess]==", ggplot_build(p3)$data[[2]]$alpha[1])
degree="lambda[loess]==0"
mlinear = glm(wing_morph_binom ~ month_of_year, data=dd, family=gaussian)
round(summary(mlinear)$coeff[[8]],3) # significant for all (but only with K.elegans)
pvalue = paste0("italic(p)[glm]==",round(summary(mlinear)$coeff[[8]],2))
p5 = p5 + annotate(geom="text", x=7.4, y=1.0, label=alpha, color="black", parse=TRUE) +
annotate(geom="text", x=7.4, y=1.04, label=degree, color="black", parse=TRUE) +
annotate(geom="text", x=5, y=0.718, label=pvalue, color="black", parse=TRUE)
p6 = p6 + annotate(geom="text", x=7.4, y=1.1, label=alpha, color="black", parse=TRUE) +
annotate(geom="text", x=7.4, y=1.15, label=degree, color="black",parse=TRUE) +
annotate(geom="text", x=5, y=1, label=pvalue, color="black", parse=TRUE)
grid.arrange(p5,p6, ncol=2)
coef(M2)[2]
equation = function(x){coef(M2)[1] + coef(M2)[4]} # best fit model
p5 = ggplot(raw_data) +
ggtitle("A") + xlab("Month") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_dates, color="gainsboro") +
stat_function(fun=equation,geom="line", linetype="dashed") +
# geom_smooth(data=dd, method="lm", se=FALSE, linetype = "dashed", lwd=0.5,
#             mapping = aes(x = month_of_year, y = wing_morph_binom), colour="black") +
# geom_smooth(
#   mapping=aes(x=month_of_year, y=success/(success+failure), succ=success, fail=failure),
#   method="glm",
#   method.args=list(family="binomial"),
#   formula = cbind(succ, fail) ~ x
# ) +
geom_smooth(data=dd, method="loess",
mapping = aes(x = month_of_year, y = wing_morph_binom, colour=`Host Plant`, fill=`Host Plant`)) +
geom_point(data=dd, mapping = aes(x = month_of_year, y = wing_morph_binom, colour=`Host Plant`)) +
customPlot +
scale_color_manual(values=c("C. corindum" = "turquoise3", "K. elegans" = "springgreen4")) +
scale_fill_manual(values = c("C. corindum" = "turquoise3", "K. elegans" = "green")) +
scale_x_continuous(breaks=xlab_months, labels= month_labs) + ylim(0.3,1.2)
p6 = ggplot() +
ggtitle("B") + xlab("Month") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_dates, color="gainsboro") +
geom_smooth(data=dd, method="lm", se=FALSE, linetype = "dashed", lwd=0.5,
mapping = aes(x = month_of_year, y = wing_morph_binom), colour="black") +
geom_smooth(data=dd, method="loess",
mapping = aes(x = month_of_year, y = wing_morph_binom, colour=Sex, fill=Sex)) +
geom_point(data=dd, mapping = aes(x = month_of_year, y = wing_morph_binom, colour=Sex)) +
customPlot +
scale_color_manual(values=c("Females" = "brown3", "Males" = "black")) +
scale_fill_manual(values = c("Females" = "brown1", "Males" = "sienna4")) +
scale_x_continuous(breaks=xlab_months, labels= month_labs) + theme(axis.title.y = element_blank()) + ylim(0.3,1.2)
#### loess and linear regressions
alpha = paste("alpha[loess]==", ggplot_build(p3)$data[[2]]$alpha[1])
degree="lambda[loess]==0"
mlinear = glm(wing_morph_binom ~ month_of_year, data=dd, family=gaussian)
round(summary(mlinear)$coeff[[8]],3) # significant for all (but only with K.elegans)
pvalue = paste0("italic(p)[glm]==",round(summary(mlinear)$coeff[[8]],2))
p5 = p5 + annotate(geom="text", x=7.4, y=1.0, label=alpha, color="black", parse=TRUE) +
annotate(geom="text", x=7.4, y=1.04, label=degree, color="black", parse=TRUE) +
annotate(geom="text", x=5, y=0.718, label=pvalue, color="black", parse=TRUE)
p6 = p6 + annotate(geom="text", x=7.4, y=1.1, label=alpha, color="black", parse=TRUE) +
annotate(geom="text", x=7.4, y=1.15, label=degree, color="black",parse=TRUE) +
annotate(geom="text", x=5, y=1, label=pvalue, color="black", parse=TRUE)
grid.arrange(p5,p6, ncol=2)
p5 = ggplot(raw_data) +
ggtitle("A") + xlab("Month") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_dates, color="gainsboro") +
stat_function(fun=equation,geom="line", linetype="dashed") +
# geom_smooth(data=dd, method="lm", se=FALSE, linetype = "dashed", lwd=0.5,
#             mapping = aes(x = month_of_year, y = wing_morph_binom), colour="black") +
# geom_smooth(
#   mapping=aes(x=month_of_year, y=success/(success+failure), succ=success, fail=failure),
#   method="glm",
#   method.args=list(family="binomial"),
#   formula = cbind(succ, fail) ~ x
# ) +
geom_smooth(data=dd, method="loess",
mapping = aes(x = month_of_year, y = wing_morph_binom, colour=`Host Plant`, fill=`Host Plant`)) +
geom_point(data=dd, mapping = aes(x = month_of_year, y = wing_morph_binom, colour=`Host Plant`)) +
customPlot +
scale_color_manual(values=c("C. corindum" = "turquoise3", "K. elegans" = "springgreen4")) +
scale_fill_manual(values = c("C. corindum" = "turquoise3", "K. elegans" = "green")) +
scale_x_continuous(breaks=xlab_months, labels= month_labs) + ylim(0.3,1.2)
p6 = ggplot() +
ggtitle("B") + xlab("Month") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_dates, color="gainsboro") +
geom_smooth(data=dd, method="lm", se=FALSE, linetype = "dashed", lwd=0.5,
mapping = aes(x = month_of_year, y = wing_morph_binom), colour="black") +
geom_smooth(data=dd, method="loess",
mapping = aes(x = month_of_year, y = wing_morph_binom, colour=Sex, fill=Sex)) +
geom_point(data=dd, mapping = aes(x = month_of_year, y = wing_morph_binom, colour=Sex)) +
customPlot +
scale_color_manual(values=c("Females" = "brown3", "Males" = "black")) +
scale_fill_manual(values = c("Females" = "brown1", "Males" = "sienna4")) +
scale_x_continuous(breaks=xlab_months, labels= month_labs) + theme(axis.title.y = element_blank()) + ylim(0.3,1.2)
#### loess and linear regressions
alpha = paste("alpha[loess]==", ggplot_build(p3)$data[[2]]$alpha[1])
degree="lambda[loess]==0"
mlinear = glm(wing_morph_binom ~ month_of_year, data=dd, family=gaussian)
round(summary(mlinear)$coeff[[8]],3) # significant for all (but only with K.elegans)
pvalue = paste0("italic(p)[glm]==",round(summary(mlinear)$coeff[[8]],2))
p5 = p5 + annotate(geom="text", x=7.4, y=1.0, label=alpha, color="black", parse=TRUE) +
annotate(geom="text", x=7.4, y=1.04, label=degree, color="black", parse=TRUE) +
annotate(geom="text", x=5, y=0.718, label=pvalue, color="black", parse=TRUE)
p6 = p6 + annotate(geom="text", x=7.4, y=1.1, label=alpha, color="black", parse=TRUE) +
annotate(geom="text", x=7.4, y=1.15, label=degree, color="black",parse=TRUE) +
annotate(geom="text", x=5, y=1, label=pvalue, color="black", parse=TRUE)
grid.arrange(p5,p6, ncol=2)
coef(M2)[1] + coef(M2)[4]
equation = function(x){coef(M2)[1] + coef(M2)[4]*x} # best fit model
p5 = ggplot(raw_data, x=month_of_year) +
ggtitle("A") + xlab("Month") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_dates, color="gainsboro") +
stat_function(fun=equation,geom="line", linetype="dashed") +
# geom_smooth(data=dd, method="lm", se=FALSE, linetype = "dashed", lwd=0.5,
#             mapping = aes(x = month_of_year, y = wing_morph_binom), colour="black") +
# geom_smooth(
#   mapping=aes(x=month_of_year, y=success/(success+failure), succ=success, fail=failure),
#   method="glm",
#   method.args=list(family="binomial"),
#   formula = cbind(succ, fail) ~ x
# ) +
geom_smooth(data=dd, method="loess",
mapping = aes(x = month_of_year, y = wing_morph_binom, colour=`Host Plant`, fill=`Host Plant`)) +
geom_point(data=dd, mapping = aes(x = month_of_year, y = wing_morph_binom, colour=`Host Plant`)) +
customPlot +
scale_color_manual(values=c("C. corindum" = "turquoise3", "K. elegans" = "springgreen4")) +
scale_fill_manual(values = c("C. corindum" = "turquoise3", "K. elegans" = "green")) +
scale_x_continuous(breaks=xlab_months, labels= month_labs) + ylim(0.3,1.2)
p6 = ggplot() +
ggtitle("B") + xlab("Month") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_dates, color="gainsboro") +
geom_smooth(data=dd, method="lm", se=FALSE, linetype = "dashed", lwd=0.5,
mapping = aes(x = month_of_year, y = wing_morph_binom), colour="black") +
geom_smooth(data=dd, method="loess",
mapping = aes(x = month_of_year, y = wing_morph_binom, colour=Sex, fill=Sex)) +
geom_point(data=dd, mapping = aes(x = month_of_year, y = wing_morph_binom, colour=Sex)) +
customPlot +
scale_color_manual(values=c("Females" = "brown3", "Males" = "black")) +
scale_fill_manual(values = c("Females" = "brown1", "Males" = "sienna4")) +
scale_x_continuous(breaks=xlab_months, labels= month_labs) + theme(axis.title.y = element_blank()) + ylim(0.3,1.2)
#### loess and linear regressions
alpha = paste("alpha[loess]==", ggplot_build(p3)$data[[2]]$alpha[1])
degree="lambda[loess]==0"
mlinear = glm(wing_morph_binom ~ month_of_year, data=dd, family=gaussian)
round(summary(mlinear)$coeff[[8]],3) # significant for all (but only with K.elegans)
pvalue = paste0("italic(p)[glm]==",round(summary(mlinear)$coeff[[8]],2))
p5 = p5 + annotate(geom="text", x=7.4, y=1.0, label=alpha, color="black", parse=TRUE) +
annotate(geom="text", x=7.4, y=1.04, label=degree, color="black", parse=TRUE) +
annotate(geom="text", x=5, y=0.718, label=pvalue, color="black", parse=TRUE)
p6 = p6 + annotate(geom="text", x=7.4, y=1.1, label=alpha, color="black", parse=TRUE) +
annotate(geom="text", x=7.4, y=1.15, label=degree, color="black",parse=TRUE) +
annotate(geom="text", x=5, y=1, label=pvalue, color="black", parse=TRUE)
grid.arrange(p5,p6, ncol=2)
summary(M2)$coeff[,"Pr(>|t|)"][5]
summary(M2)$coeff[,"Pr(>|z|)"][5]
coef(M2)[4]
coef(M2)[5]
equation = function(x){coef(M2)[1] + coef(M2)[5]*x} # best fit model
M2_pvalue = round(summary(M2)$coeff[,"Pr(>|z|)"][5],6)
pvalue = paste0("italic(p)[glm]==", M2_pvalue)
pvalue
p5 = ggplot(raw_data, x=month_of_year) +
ggtitle("A") + xlab("Month") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_dates, color="gainsboro") +
stat_function(fun=equation,geom="line", linetype="dashed") +
# geom_smooth(data=dd, method="lm", se=FALSE, linetype = "dashed", lwd=0.5,
#             mapping = aes(x = month_of_year, y = wing_morph_binom), colour="black") +
# geom_smooth(
#   mapping=aes(x=month_of_year, y=success/(success+failure), succ=success, fail=failure),
#   method="glm",
#   method.args=list(family="binomial"),
#   formula = cbind(succ, fail) ~ x
# ) +
geom_smooth(data=dd, method="loess",
mapping = aes(x = month_of_year, y = wing_morph_binom, colour=`Host Plant`, fill=`Host Plant`)) +
geom_point(data=dd, mapping = aes(x = month_of_year, y = wing_morph_binom, colour=`Host Plant`)) +
customPlot +
scale_color_manual(values=c("C. corindum" = "turquoise3", "K. elegans" = "springgreen4")) +
scale_fill_manual(values = c("C. corindum" = "turquoise3", "K. elegans" = "green")) +
scale_x_continuous(breaks=xlab_months, labels= month_labs) + ylim(0.3,1.2)
p6 = ggplot() +
ggtitle("B") + xlab("Month") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_dates, color="gainsboro") +
geom_smooth(data=dd, method="lm", se=FALSE, linetype = "dashed", lwd=0.5,
mapping = aes(x = month_of_year, y = wing_morph_binom), colour="black") +
geom_smooth(data=dd, method="loess",
mapping = aes(x = month_of_year, y = wing_morph_binom, colour=Sex, fill=Sex)) +
geom_point(data=dd, mapping = aes(x = month_of_year, y = wing_morph_binom, colour=Sex)) +
customPlot +
scale_color_manual(values=c("Females" = "brown3", "Males" = "black")) +
scale_fill_manual(values = c("Females" = "brown1", "Males" = "sienna4")) +
scale_x_continuous(breaks=xlab_months, labels= month_labs) + theme(axis.title.y = element_blank()) + ylim(0.3,1.2)
#### loess and linear regressions
alpha = paste("alpha[loess]==", ggplot_build(p3)$data[[2]]$alpha[1])
degree="lambda[loess]==0"
mlinear = glm(wing_morph_binom ~ month_of_year, data=dd, family=gaussian)
round(summary(mlinear)$coeff[[8]],3) # significant for all (but only with K.elegans)
pvalue = paste0("italic(p)[glm]==",round(summary(mlinear)$coeff[[8]],2))
p5 = p5 + annotate(geom="text", x=7.4, y=1.0, label=alpha, color="black", parse=TRUE) +
annotate(geom="text", x=7.4, y=1.04, label=degree, color="black", parse=TRUE) +
annotate(geom="text", x=5, y=0.718, label=pvalue, color="black", parse=TRUE)
p6 = p6 + annotate(geom="text", x=7.4, y=1.1, label=alpha, color="black", parse=TRUE) +
annotate(geom="text", x=7.4, y=1.15, label=degree, color="black",parse=TRUE) +
annotate(geom="text", x=5, y=1, label=pvalue, color="black", parse=TRUE)
grid.arrange(p5,p6, ncol=2)
coef(M2)[1] + coef(M2)[5]
coef(M2)[5]
coef(M2)[1]
summary(M2)
fit = glm(wing_morph_binom ~ month_of_year, family = "binomial", data = raw_data)
summary(fit)
xweight <- seq(1,12, 12)
xweight
xweight <- seq(1,12, 0.01)
xweight
xmonth <- seq(0,12, 0.01)
fit = glm(wing_morph_binom ~ month_of_year, family = "binomial", data = raw_data)
ywing <- predict(fit, list(wt = xmonth),type="response")
ywing <- predict(fit, list(month_of_year = xmonth),type="response")
ywing
wing_probs <- predict(fit, list(month_of_year = xmonth),type="response")
p5 = ggplot(raw_data, aes(x=xmonth, y=wing_probs)) +
ggtitle("A") + xlab("Month") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_dates, color="gainsboro") +
#stat_function(fun=equation,geom="line", linetype="dashed") +
geom_line(linetype = "dashed") +
# geom_smooth(data=dd, method="lm", se=FALSE, linetype = "dashed", lwd=0.5,
#             mapping = aes(x = month_of_year, y = wing_morph_binom), colour="black") +
# geom_smooth(
#   mapping=aes(x=month_of_year, y=success/(success+failure), succ=success, fail=failure),
#   method="glm",
#   method.args=list(family="binomial"),
#   formula = cbind(succ, fail) ~ x
# ) +
geom_smooth(data=dd, method="loess",
mapping = aes(x = month_of_year, y = wing_morph_binom, colour=`Host Plant`, fill=`Host Plant`)) +
geom_point(data=dd, mapping = aes(x = month_of_year, y = wing_morph_binom, colour=`Host Plant`)) +
customPlot +
scale_color_manual(values=c("C. corindum" = "turquoise3", "K. elegans" = "springgreen4")) +
scale_fill_manual(values = c("C. corindum" = "turquoise3", "K. elegans" = "green")) +
scale_x_continuous(breaks=xlab_months, labels= month_labs) + ylim(0.3,1.2)
p6 = ggplot() +
ggtitle("B") + xlab("Month") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_dates, color="gainsboro") +
geom_smooth(data=dd, method="lm", se=FALSE, linetype = "dashed", lwd=0.5,
mapping = aes(x = month_of_year, y = wing_morph_binom), colour="black") +
geom_smooth(data=dd, method="loess",
mapping = aes(x = month_of_year, y = wing_morph_binom, colour=Sex, fill=Sex)) +
geom_point(data=dd, mapping = aes(x = month_of_year, y = wing_morph_binom, colour=Sex)) +
customPlot +
scale_color_manual(values=c("Females" = "brown3", "Males" = "black")) +
scale_fill_manual(values = c("Females" = "brown1", "Males" = "sienna4")) +
scale_x_continuous(breaks=xlab_months, labels= month_labs) + theme(axis.title.y = element_blank()) + ylim(0.3,1.2)
#### loess and linear regressions
alpha = paste("alpha[loess]==", ggplot_build(p3)$data[[2]]$alpha[1])
degree="lambda[loess]==0"
mlinear = glm(wing_morph_binom ~ month_of_year, data=dd, family=gaussian)
round(summary(mlinear)$coeff[[8]],3) # significant for all (but only with K.elegans)
pvalue = paste0("italic(p)[glm]==",round(summary(mlinear)$coeff[[8]],2))
p5 = p5 + annotate(geom="text", x=7.4, y=1.0, label=alpha, color="black", parse=TRUE) +
annotate(geom="text", x=7.4, y=1.04, label=degree, color="black", parse=TRUE) +
annotate(geom="text", x=5, y=0.718, label=pvalue, color="black", parse=TRUE)
p6 = p6 + annotate(geom="text", x=7.4, y=1.1, label=alpha, color="black", parse=TRUE) +
annotate(geom="text", x=7.4, y=1.15, label=degree, color="black",parse=TRUE) +
annotate(geom="text", x=5, y=1, label=pvalue, color="black", parse=TRUE)
grid.arrange(p5,p6, ncol=2)
p5
p5 = ggplot() +
ggtitle("A") + xlab("Month") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_dates, color="gainsboro") +
#stat_function(fun=equation,geom="line", linetype="dashed") +
geom_line(aes(x=xmonth, y=wing_probs), linetype = "dashed") +
# geom_smooth(data=dd, method="lm", se=FALSE, linetype = "dashed", lwd=0.5,
#             mapping = aes(x = month_of_year, y = wing_morph_binom), colour="black") +
# geom_smooth(
#   mapping=aes(x=month_of_year, y=success/(success+failure), succ=success, fail=failure),
#   method="glm",
#   method.args=list(family="binomial"),
#   formula = cbind(succ, fail) ~ x
# ) +
geom_smooth(data=dd, method="loess",
mapping = aes(x = month_of_year, y = wing_morph_binom, colour=`Host Plant`, fill=`Host Plant`)) +
geom_point(data=dd, mapping = aes(x = month_of_year, y = wing_morph_binom, colour=`Host Plant`)) +
customPlot +
scale_color_manual(values=c("C. corindum" = "turquoise3", "K. elegans" = "springgreen4")) +
scale_fill_manual(values = c("C. corindum" = "turquoise3", "K. elegans" = "green")) +
scale_x_continuous(breaks=xlab_months, labels= month_labs) + ylim(0.3,1.2)
p5
xmonth <- seq(2,12, 0.01)
wing_probs <- predict(fit, list(month_of_year = xmonth),type="response")
p5 = ggplot() +
ggtitle("A") + xlab("Month") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_dates, color="gainsboro") +
#stat_function(fun=equation,geom="line", linetype="dashed") +
geom_line(aes(x=xmonth, y=wing_probs), linetype = "dashed") +
# geom_smooth(data=dd, method="lm", se=FALSE, linetype = "dashed", lwd=0.5,
#             mapping = aes(x = month_of_year, y = wing_morph_binom), colour="black") +
# geom_smooth(
#   mapping=aes(x=month_of_year, y=success/(success+failure), succ=success, fail=failure),
#   method="glm",
#   method.args=list(family="binomial"),
#   formula = cbind(succ, fail) ~ x
# ) +
geom_smooth(data=dd, method="loess",
mapping = aes(x = month_of_year, y = wing_morph_binom, colour=`Host Plant`, fill=`Host Plant`)) +
geom_point(data=dd, mapping = aes(x = month_of_year, y = wing_morph_binom, colour=`Host Plant`)) +
customPlot +
scale_color_manual(values=c("C. corindum" = "turquoise3", "K. elegans" = "springgreen4")) +
scale_fill_manual(values = c("C. corindum" = "turquoise3", "K. elegans" = "green")) +
scale_x_continuous(breaks=xlab_months, labels= month_labs) + ylim(0.3,1.2)
p5
M2_pvalue = round(summary(fit)$coeff[,"Pr(>|z|)"][1],6)
M2_pvalue
M2_pvalue = round(summary(fit)$coeff[,"Pr(>|z|)"][2],6)
M2_pvalue
fit_pvalue = round(summary(fit)$coeff[,"Pr(>|z|)"][2],10)
pvalue = paste0("italic(p)[glm]==", fit_pvalue)
pvalue
wing_probs <- predict(M2, list(month_of_year = xmonth),type="response")
fit = glm(wing_morph_binom ~ month_of_year, family = "binomial", data = raw_data)
xmonth <- seq(2,12, 0.01)
wing_probs <- predict(fit, list(month_of_year = xmonth),type="response")
fit_pvalue = round(summary(fit)$coeff[,"Pr(>|z|)"][2],10)
pvalue = paste0("italic(p)[glm]==", fit_pvalue)
p5 = ggplot() +
ggtitle("A") + xlab("Month") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_dates, color="gainsboro") +
#stat_function(fun=equation,geom="line", linetype="dashed") +
geom_line(aes(x=xmonth, y=wing_probs), linetype = "dashed") +
# geom_smooth(data=dd, method="lm", se=FALSE, linetype = "dashed", lwd=0.5,
#             mapping = aes(x = month_of_year, y = wing_morph_binom), colour="black") +
# geom_smooth(
#   mapping=aes(x=month_of_year, y=success/(success+failure), succ=success, fail=failure),
#   method="glm",
#   method.args=list(family="binomial"),
#   formula = cbind(succ, fail) ~ x
# ) +
geom_smooth(data=dd, method="loess",
mapping = aes(x = month_of_year, y = wing_morph_binom, colour=`Host Plant`, fill=`Host Plant`)) +
geom_point(data=dd, mapping = aes(x = month_of_year, y = wing_morph_binom, colour=`Host Plant`)) +
customPlot +
scale_color_manual(values=c("C. corindum" = "turquoise3", "K. elegans" = "springgreen4")) +
scale_fill_manual(values = c("C. corindum" = "turquoise3", "K. elegans" = "green")) +
scale_x_continuous(breaks=xlab_months, labels= month_labs) + ylim(0.3,1.2)
p6 = ggplot() +
ggtitle("B") + xlab("Month") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_dates, color="gainsboro") +
geom_smooth(data=dd, method="lm", se=FALSE, linetype = "dashed", lwd=0.5,
mapping = aes(x = month_of_year, y = wing_morph_binom), colour="black") +
geom_smooth(data=dd, method="loess",
mapping = aes(x = month_of_year, y = wing_morph_binom, colour=Sex, fill=Sex)) +
geom_point(data=dd, mapping = aes(x = month_of_year, y = wing_morph_binom, colour=Sex)) +
customPlot +
scale_color_manual(values=c("Females" = "brown3", "Males" = "black")) +
scale_fill_manual(values = c("Females" = "brown1", "Males" = "sienna4")) +
scale_x_continuous(breaks=xlab_months, labels= month_labs) + theme(axis.title.y = element_blank()) + ylim(0.3,1.2)
#### loess and linear regressions
alpha = paste("alpha[loess]==", ggplot_build(p3)$data[[2]]$alpha[1])
degree="lambda[loess]==0"
p5 = p5 + annotate(geom="text", x=7.4, y=1.0, label=alpha, color="black", parse=TRUE) +
annotate(geom="text", x=7.4, y=1.04, label=degree, color="black", parse=TRUE) +
annotate(geom="text", x=5, y=0.718, label=pvalue, color="black", parse=TRUE)
p6 = p6 + annotate(geom="text", x=7.4, y=1.1, label=alpha, color="black", parse=TRUE) +
annotate(geom="text", x=7.4, y=1.15, label=degree, color="black",parse=TRUE) +
annotate(geom="text", x=5, y=1, label=pvalue, color="black", parse=TRUE)
grid.arrange(p5,p6, ncol=2)
p6 = ggplot() +
ggtitle("B") + xlab("Month") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_dates, color="gainsboro") +
geom_line(aes(x=xmonth, y=wing_probs), linetype = "dashed") +
# geom_smooth(data=dd, method="lm", se=FALSE, linetype = "dashed", lwd=0.5,
#             mapping = aes(x = month_of_year, y = wing_morph_binom), colour="black") +
geom_smooth(data=dd, method="loess",
mapping = aes(x = month_of_year, y = wing_morph_binom, colour=Sex, fill=Sex)) +
geom_point(data=dd, mapping = aes(x = month_of_year, y = wing_morph_binom, colour=Sex)) +
customPlot +
scale_color_manual(values=c("Females" = "brown3", "Males" = "black")) +
scale_fill_manual(values = c("Females" = "brown1", "Males" = "sienna4")) +
scale_x_continuous(breaks=xlab_months, labels= month_labs) + theme(axis.title.y = element_blank()) + ylim(0.3,1.2)
#### loess and linear regressions
alpha = paste("alpha[loess]==", ggplot_build(p3)$data[[2]]$alpha[1])
degree="lambda[loess]==0"
p5 = p5 + annotate(geom="text", x=7.4, y=1.0, label=alpha, color="black", parse=TRUE) +
annotate(geom="text", x=7.4, y=1.04, label=degree, color="black", parse=TRUE) +
annotate(geom="text", x=5, y=0.718, label=pvalue, color="black", parse=TRUE)
p6 = p6 + annotate(geom="text", x=7.4, y=1.1, label=alpha, color="black", parse=TRUE) +
annotate(geom="text", x=7.4, y=1.15, label=degree, color="black",parse=TRUE) +
annotate(geom="text", x=5, y=1, label=pvalue, color="black", parse=TRUE)
grid.arrange(p5,p6, ncol=2)
wm_table<-aggregate(wing_morph_binom~dates, data=raw_data, FUN=mean)
wm_table$date_b = "2013-2015"
wm_table<-aggregate(wing_morph_binom~dates, data=raw_data, FUN=mean)
wm_table$date_b = "2013-2015"
wm_table$date_b[wm_table$dates >= threshold] = "2016-2020"
wm_table$date_b = as.factor(wm_table$date_b)
xlab_years = sort(unique(raw_data$dates))
p7 = ggplot() +
ggtitle("C") + xlab("Year") + ylab("Long-Wing Morph Frequency") +
geom_vline(xintercept = xlab_years, color="gainsboro") +
geom_smooth(data=wm_table, method="lm", se=FALSE, linetype = "dashed",
mapping = aes(x = dates, y = wing_morph_binom), colour="black", lwd=0.5) +
geom_smooth(data=wm_table, method="loess",
mapping = aes(x = dates, y = wing_morph_binom), colour="black") +
geom_point(data=wm_table, mapping = aes(x = dates, y = wing_morph_binom)) +
guides(fill = guide_legend(reverse = TRUE)) + theme_classic() +
theme(axis.text=element_text(size=13),
axis.title=element_text(size=16),
plot.title=element_text(size=20)) +
guides(color = FALSE) +
scale_linetype(guide = FALSE) +
theme(legend.key = element_rect(fill = "white", color = NA),
legend.key.size = unit(0.5, "cm"),
legend.key.width = unit(0.5,"cm")) +
scale_fill_manual(values = "blue", labels=c("C. corindum", "K. elegans")) +
labs(fill = "Host Plant") +
theme(legend.title = element_text(size = 14),
legend.text = element_text(size = 13, face="italic")) +
scale_color_manual(values="blue") +
theme(legend.position = c(0.2, 0.88)) +
theme(legend.title = element_blank()) + ylim(0.3,1.2)
#### loess and linear regressions
alpha = paste("alpha[loess]==", ggplot_build(p0)$data[[2]]$alpha[1])
degree="lambda[loess]==0"
mlinear = glm(wing_morph_binom ~ dates, data=dd, family=gaussian)
pvalue = paste0("italic(p)[glm]==",round(summary(mlinear)$coeff[[8]],2))
p7 = p7 + annotate(geom="text", x=unique(raw_data$dates)[6], y=1.05, label=alpha, color="black", parse=TRUE, size=6) +
annotate(geom="text", x=unique(raw_data$dates)[6], y=1.12, label=degree, color="black",parse=TRUE, size=6) +
annotate(geom="text", x=unique(raw_data$dates)[5], y=0.50, label=pvalue, color="black", parse=TRUE, size=6)
figure2 = ggdraw() +
draw_plot(p5, 0, .5, .5, .5) +
draw_plot(p6, 0.5, .5, .5, .5) +
draw_plot(p7, 0, 0, 1, .5)
figure2
ggsave("wing_morph_freq", plot=figure2, width = 4.7*2.1, height = 4.4*2.1, dpi = 300, units = "in")
ggsave("wing_morph_freq.pdf", plot=figure2, width = 4.7*2.1, height = 4.4*2.1, dpi = 300, units = "in")
