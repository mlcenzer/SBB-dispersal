scale_fill_manual(values=colors) +
theme_classic() +theme(
axis.text.y = element_text(size=11),
axis.text.x=element_text(size=11, angle = 45, hjust = 1.1),
axis.title=element_text(size=17,face="bold"))  +
theme(axis.title.x = element_text(vjust = -3)) +
theme(axis.title.y = element_text(vjust = 4)) +
theme(plot.margin=unit(c(1,1,1.1,1.2),"cm"))
p = ggplot(data=subset(data, !is.na(datetime)), aes(x=datetime, fill=pophost)) +
geom_bar(position='stack', color="black", width=0.7) +
theme_bw()
p2 = p + labs(title=" ", fill="Host Plant",
x="Field Collection Month", y = "Number of Bugs Collected")+
scale_fill_manual(values=c("#56B4E9", "chartreuse4")) +
theme_classic() + theme(
axis.text.y = element_text(size=11),
axis.text.x=element_text(size=11, angle = 45, hjust = 1.1), # 9
axis.title=element_text(size=17,face="bold"))  +
theme(axis.title.x = element_text(vjust = -3)) +
theme(axis.title.y = element_text(vjust = 4)) +
theme(plot.margin=unit(c(1,1,1.1,1.2),"cm"))
p = ggplot(data=subset(data, !is.na(datetime)), aes(x=datetime, fill=sex)) +
geom_bar(position='stack', color="black", width=0.7) +
theme_bw()
p3 = p + labs(title=" ", fill="Sex",
x="Field Collection Month", y = "Number of Bugs Collected")+
scale_fill_manual(values=c("salmon1", "darkslategray3")) +
theme_classic() +theme(
axis.text.y = element_text(size=11),
axis.text.x=element_text(size=11, angle = 45, hjust = 1.1), # 9
axis.title=element_text(size=17,face="bold"))  +
theme(axis.title.x = element_text(vjust = -3)) +
theme(axis.title.y = element_text(vjust = 4)) +
theme(plot.margin=unit(c(1,1,1.1,1.2),"cm"))
p1
p2
p3
# order the histogram by latitude and change some colors
#hist(data$year, main="Numbers Collected", xlab="Year")
colors = c("#999999", "#E69F00", "#56B4E9",
"royalblue", "grey", "#e3e85d",
"#409973", "#9bc969", "ivory2") # the keys
p = ggplot(data=subset(data, !is.na(datetime)), aes(x=datetime, fill=population)) +
geom_bar(position='stack', color="black", width=0.7) +
theme_bw()
p1 = p + labs(title=" ", fill="Population",
x="Field Collection Month", y = "Number of Bugs Collected")+
scale_fill_manual(values=colors) +
theme_classic() +theme(
axis.text.y = element_text(size=11),
axis.text.x=element_text(size=11, angle = 45, hjust = 1.1),
axis.title=element_text(size=17,face="bold"))  +
theme(axis.title.x = element_text(vjust = -3)) +
theme(axis.title.y = element_text(vjust = 4)) +
theme(plot.margin=unit(c(1,1,1.1,1.2),"cm"))
p = ggplot(data=subset(data, !is.na(datetime)), aes(x=datetime, fill=pophost)) +
geom_bar(position='stack', color="black", width=0.7) +
theme_bw()
p2 = p + labs(title=" ", fill="Host Plant",
x="Field Collection Month", y = "Number of Bugs Collected")+
scale_fill_manual(values=c("#56B4E9", "chartreuse4")) +
theme_classic() + theme(
axis.text.y = element_text(size=11),
axis.text.x=element_text(size=11, angle = 45, hjust = 1.1), # 9
axis.title=element_text(size=17,face="bold"))  +
theme(axis.title.x = element_text(vjust = -3)) +
theme(axis.title.y = element_text(vjust = 4)) +
theme(plot.margin=unit(c(1,1,1.1,1.2),"cm"))
p = ggplot(data=subset(data, !is.na(datetime)), aes(x=datetime, fill=sex)) +
geom_bar(position='stack', color="black", width=0.7) +
theme_bw()
p3 = p + labs(title=" ", fill="Sex",
x="Field Collection Month", y = "Number of Bugs Collected")+
scale_fill_manual(values=c("salmon1", "darkslategray3")) +
theme_classic() +theme(
axis.text.y = element_text(size=11),
axis.text.x=element_text(size=11, angle = 45, hjust = 1.1), # 9
axis.title=element_text(size=17,face="bold"))  +
theme(axis.title.x = element_text(vjust = -3)) +
theme(axis.title.y = element_text(vjust = 4)) +
theme(plot.margin=unit(c(1,1,1.1,1.2),"cm"))
p1
p2
p3
# order the histogram by latitude and change some colors
#hist(data$year, main="Numbers Collected", xlab="Year")
colors = c("#999999", "#E69F00", "#56B4E9",
"royalblue", "grey", "#56B4E9",
"#409973", "#9bc969", "ivory2") # the keys
p = ggplot(data=subset(data, !is.na(datetime)), aes(x=datetime, fill=population)) +
geom_bar(position='stack', color="black", width=0.7) +
theme_bw()
p1 = p + labs(title=" ", fill="Population",
x="Field Collection Month", y = "Number of Bugs Collected")+
scale_fill_manual(values=colors) +
theme_classic() +theme(
axis.text.y = element_text(size=11),
axis.text.x=element_text(size=11, angle = 45, hjust = 1.1),
axis.title=element_text(size=17,face="bold"))  +
theme(axis.title.x = element_text(vjust = -3)) +
theme(axis.title.y = element_text(vjust = 4)) +
theme(plot.margin=unit(c(1,1,1.1,1.2),"cm"))
p = ggplot(data=subset(data, !is.na(datetime)), aes(x=datetime, fill=pophost)) +
geom_bar(position='stack', color="black", width=0.7) +
theme_bw()
p2 = p + labs(title=" ", fill="Host Plant",
x="Field Collection Month", y = "Number of Bugs Collected")+
scale_fill_manual(values=c("#56B4E9", "chartreuse4")) +
theme_classic() + theme(
axis.text.y = element_text(size=11),
axis.text.x=element_text(size=11, angle = 45, hjust = 1.1), # 9
axis.title=element_text(size=17,face="bold"))  +
theme(axis.title.x = element_text(vjust = -3)) +
theme(axis.title.y = element_text(vjust = 4)) +
theme(plot.margin=unit(c(1,1,1.1,1.2),"cm"))
p = ggplot(data=subset(data, !is.na(datetime)), aes(x=datetime, fill=sex)) +
geom_bar(position='stack', color="black", width=0.7) +
theme_bw()
p3 = p + labs(title=" ", fill="Sex",
x="Field Collection Month", y = "Number of Bugs Collected")+
scale_fill_manual(values=c("salmon1", "darkslategray3")) +
theme_classic() +theme(
axis.text.y = element_text(size=11),
axis.text.x=element_text(size=11, angle = 45, hjust = 1.1), # 9
axis.title=element_text(size=17,face="bold"))  +
theme(axis.title.x = element_text(vjust = -3)) +
theme(axis.title.y = element_text(vjust = 4)) +
theme(plot.margin=unit(c(1,1,1.1,1.2),"cm"))
p1
p2
p3
# order the histogram by latitude and change some colors
#hist(data$year, main="Numbers Collected", xlab="Year")
colors = c("#999999", "#E69F00", "#56B4E9",
"royalblue", "grey", ""#E69F00",
"#409973", "#9bc969", "ivory2") # the keys
# order the histogram by latitude and change some colors
#hist(data$year, main="Numbers Collected", xlab="Year")
colors = c("#999999", "#E69F00", "#56B4E9",
"royalblue", "grey", #E69F00",
"#409973", "#9bc969", "ivory2") # the keys
p = ggplot(data=subset(data, !is.na(datetime)), aes(x=datetime, fill=population)) +
geom_bar(position='stack', color="black", width=0.7) +
theme_bw()
p1 = p + labs(title=" ", fill="Population",
x="Field Collection Month", y = "Number of Bugs Collected")+
scale_fill_manual(values=colors) +
theme_classic() +theme(
axis.text.y = element_text(size=11),
axis.text.x=element_text(size=11, angle = 45, hjust = 1.1),
axis.title=element_text(size=17,face="bold"))  +
theme(axis.title.x = element_text(vjust = -3)) +
theme(axis.title.y = element_text(vjust = 4)) +
theme(plot.margin=unit(c(1,1,1.1,1.2),"cm"))
p = ggplot(data=subset(data, !is.na(datetime)), aes(x=datetime, fill=pophost)) +
geom_bar(position='stack', color="black", width=0.7) +
theme_bw()
p2 = p + labs(title=" ", fill="Host Plant",
x="Field Collection Month", y = "Number of Bugs Collected")+
scale_fill_manual(values=c("#56B4E9", "chartreuse4")) +
theme_classic() + theme(
axis.text.y = element_text(size=11),
axis.text.x=element_text(size=11, angle = 45, hjust = 1.1), # 9
axis.title=element_text(size=17,face="bold"))  +
theme(axis.title.x = element_text(vjust = -3)) +
theme(axis.title.y = element_text(vjust = 4)) +
theme(plot.margin=unit(c(1,1,1.1,1.2),"cm"))
p = ggplot(data=subset(data, !is.na(datetime)), aes(x=datetime, fill=sex)) +
geom_bar(position='stack', color="black", width=0.7) +
theme_bw()
p3 = p + labs(title=" ", fill="Sex",
x="Field Collection Month", y = "Number of Bugs Collected")+
scale_fill_manual(values=c("salmon1", "darkslategray3")) +
theme_classic() +theme(
axis.text.y = element_text(size=11),
axis.text.x=element_text(size=11, angle = 45, hjust = 1.1), # 9
axis.title=element_text(size=17,face="bold"))  +
theme(axis.title.x = element_text(vjust = -3)) +
theme(axis.title.y = element_text(vjust = 4)) +
theme(plot.margin=unit(c(1,1,1.1,1.2),"cm"))
p1
# order the histogram by latitude and change some colors
#hist(data$year, main="Numbers Collected", xlab="Year")
colors = c("#999999", "#E69F00", "#56B4E9",
"royalblue", "grey", "#E69F00",
"#409973", "#9bc969", "ivory2") # the keys
p = ggplot(data=subset(data, !is.na(datetime)), aes(x=datetime, fill=population)) +
geom_bar(position='stack', color="black", width=0.7) +
theme_bw()
p1 = p + labs(title=" ", fill="Population",
x="Field Collection Month", y = "Number of Bugs Collected")+
scale_fill_manual(values=colors) +
theme_classic() +theme(
axis.text.y = element_text(size=11),
axis.text.x=element_text(size=11, angle = 45, hjust = 1.1),
axis.title=element_text(size=17,face="bold"))  +
theme(axis.title.x = element_text(vjust = -3)) +
theme(axis.title.y = element_text(vjust = 4)) +
theme(plot.margin=unit(c(1,1,1.1,1.2),"cm"))
p = ggplot(data=subset(data, !is.na(datetime)), aes(x=datetime, fill=pophost)) +
geom_bar(position='stack', color="black", width=0.7) +
theme_bw()
p2 = p + labs(title=" ", fill="Host Plant",
x="Field Collection Month", y = "Number of Bugs Collected")+
scale_fill_manual(values=c("#56B4E9", "chartreuse4")) +
theme_classic() + theme(
axis.text.y = element_text(size=11),
axis.text.x=element_text(size=11, angle = 45, hjust = 1.1), # 9
axis.title=element_text(size=17,face="bold"))  +
theme(axis.title.x = element_text(vjust = -3)) +
theme(axis.title.y = element_text(vjust = 4)) +
theme(plot.margin=unit(c(1,1,1.1,1.2),"cm"))
p = ggplot(data=subset(data, !is.na(datetime)), aes(x=datetime, fill=sex)) +
geom_bar(position='stack', color="black", width=0.7) +
theme_bw()
p3 = p + labs(title=" ", fill="Sex",
x="Field Collection Month", y = "Number of Bugs Collected")+
scale_fill_manual(values=c("salmon1", "darkslategray3")) +
theme_classic() +theme(
axis.text.y = element_text(size=11),
axis.text.x=element_text(size=11, angle = 45, hjust = 1.1), # 9
axis.title=element_text(size=17,face="bold"))  +
theme(axis.title.x = element_text(vjust = -3)) +
theme(axis.title.y = element_text(vjust = 4)) +
theme(plot.margin=unit(c(1,1,1.1,1.2),"cm"))
p1
p2
p3
# order the histogram by latitude and change some colors
#hist(data$year, main="Numbers Collected", xlab="Year")
colors = c("#999999", "#E69F00", "#56B4E9",
"royalblue", "grey", "#e3e85d",
"#409973", "#9bc969", "ivory2") # the keys
p = ggplot(data=subset(data, !is.na(datetime)), aes(x=datetime, fill=population)) +
geom_bar(position='stack', color="black", width=0.7) +
theme_bw()
p1 = p + labs(title=" ", fill="Population",
x="Field Collection Month", y = "Number of Bugs Collected")+
scale_fill_manual(values=colors) +
theme_classic() +theme(
axis.text.y = element_text(size=11),
axis.text.x=element_text(size=11, angle = 45, hjust = 1.1),
axis.title=element_text(size=17,face="bold"))  +
theme(axis.title.x = element_text(vjust = -3)) +
theme(axis.title.y = element_text(vjust = 4)) +
theme(plot.margin=unit(c(1,1,1.1,1.2),"cm"))
p = ggplot(data=subset(data, !is.na(datetime)), aes(x=datetime, fill=pophost)) +
geom_bar(position='stack', color="black", width=0.7) +
theme_bw()
p2 = p + labs(title=" ", fill="Host Plant",
x="Field Collection Month", y = "Number of Bugs Collected")+
scale_fill_manual(values=c("#56B4E9", "chartreuse4")) +
theme_classic() + theme(
axis.text.y = element_text(size=11),
axis.text.x=element_text(size=11, angle = 45, hjust = 1.1), # 9
axis.title=element_text(size=17,face="bold"))  +
theme(axis.title.x = element_text(vjust = -3)) +
theme(axis.title.y = element_text(vjust = 4)) +
theme(plot.margin=unit(c(1,1,1.1,1.2),"cm"))
p = ggplot(data=subset(data, !is.na(datetime)), aes(x=datetime, fill=sex)) +
geom_bar(position='stack', color="black", width=0.7) +
theme_bw()
p3 = p + labs(title=" ", fill="Sex",
x="Field Collection Month", y = "Number of Bugs Collected")+
scale_fill_manual(values=c("salmon1", "darkslategray3")) +
theme_classic() +theme(
axis.text.y = element_text(size=11),
axis.text.x=element_text(size=11, angle = 45, hjust = 1.1), # 9
axis.title=element_text(size=17,face="bold"))  +
theme(axis.title.x = element_text(vjust = -3)) +
theme(axis.title.y = element_text(vjust = 4)) +
theme(plot.margin=unit(c(1,1,1.1,1.2),"cm"))
p1
p2
p3
# order the histogram by latitude and change some colors
#hist(data$year, main="Numbers Collected", xlab="Year")
colors = c("#e04a28", "#E69F00", "#56B4E9",
"royalblue", "grey", "#e3e85d",
"#409973", "#9bc969", "ivory2") # the keys
p = ggplot(data=subset(data, !is.na(datetime)), aes(x=datetime, fill=population)) +
geom_bar(position='stack', color="black", width=0.7) +
theme_bw()
p1 = p + labs(title=" ", fill="Population",
x="Field Collection Month", y = "Number of Bugs Collected")+
scale_fill_manual(values=colors) +
theme_classic() +theme(
axis.text.y = element_text(size=11),
axis.text.x=element_text(size=11, angle = 45, hjust = 1.1),
axis.title=element_text(size=17,face="bold"))  +
theme(axis.title.x = element_text(vjust = -3)) +
theme(axis.title.y = element_text(vjust = 4)) +
theme(plot.margin=unit(c(1,1,1.1,1.2),"cm"))
p = ggplot(data=subset(data, !is.na(datetime)), aes(x=datetime, fill=pophost)) +
geom_bar(position='stack', color="black", width=0.7) +
theme_bw()
p2 = p + labs(title=" ", fill="Host Plant",
x="Field Collection Month", y = "Number of Bugs Collected")+
scale_fill_manual(values=c("#56B4E9", "chartreuse4")) +
theme_classic() + theme(
axis.text.y = element_text(size=11),
axis.text.x=element_text(size=11, angle = 45, hjust = 1.1), # 9
axis.title=element_text(size=17,face="bold"))  +
theme(axis.title.x = element_text(vjust = -3)) +
theme(axis.title.y = element_text(vjust = 4)) +
theme(plot.margin=unit(c(1,1,1.1,1.2),"cm"))
p = ggplot(data=subset(data, !is.na(datetime)), aes(x=datetime, fill=sex)) +
geom_bar(position='stack', color="black", width=0.7) +
theme_bw()
p3 = p + labs(title=" ", fill="Sex",
x="Field Collection Month", y = "Number of Bugs Collected")+
scale_fill_manual(values=c("salmon1", "darkslategray3")) +
theme_classic() +theme(
axis.text.y = element_text(size=11),
axis.text.x=element_text(size=11, angle = 45, hjust = 1.1), # 9
axis.title=element_text(size=17,face="bold"))  +
theme(axis.title.x = element_text(vjust = -3)) +
theme(axis.title.y = element_text(vjust = 4)) +
theme(plot.margin=unit(c(1,1,1.1,1.2),"cm"))
p1
p2
p3
# order the histogram by latitude and change some colors
#hist(data$year, main="Numbers Collected", xlab="Year")
colors = c("#787a87", "#E69F00", "#56B4E9",
"royalblue", "grey", "#e3e85d",
"#409973", "#9bc969", "ivory2") # the keys
p = ggplot(data=subset(data, !is.na(datetime)), aes(x=datetime, fill=population)) +
geom_bar(position='stack', color="black", width=0.7) +
theme_bw()
p1 = p + labs(title=" ", fill="Population",
x="Field Collection Month", y = "Number of Bugs Collected")+
scale_fill_manual(values=colors) +
theme_classic() +theme(
axis.text.y = element_text(size=11),
axis.text.x=element_text(size=11, angle = 45, hjust = 1.1),
axis.title=element_text(size=17,face="bold"))  +
theme(axis.title.x = element_text(vjust = -3)) +
theme(axis.title.y = element_text(vjust = 4)) +
theme(plot.margin=unit(c(1,1,1.1,1.2),"cm"))
p = ggplot(data=subset(data, !is.na(datetime)), aes(x=datetime, fill=pophost)) +
geom_bar(position='stack', color="black", width=0.7) +
theme_bw()
p2 = p + labs(title=" ", fill="Host Plant",
x="Field Collection Month", y = "Number of Bugs Collected")+
scale_fill_manual(values=c("#56B4E9", "chartreuse4")) +
theme_classic() + theme(
axis.text.y = element_text(size=11),
axis.text.x=element_text(size=11, angle = 45, hjust = 1.1), # 9
axis.title=element_text(size=17,face="bold"))  +
theme(axis.title.x = element_text(vjust = -3)) +
theme(axis.title.y = element_text(vjust = 4)) +
theme(plot.margin=unit(c(1,1,1.1,1.2),"cm"))
p = ggplot(data=subset(data, !is.na(datetime)), aes(x=datetime, fill=sex)) +
geom_bar(position='stack', color="black", width=0.7) +
theme_bw()
p3 = p + labs(title=" ", fill="Sex",
x="Field Collection Month", y = "Number of Bugs Collected")+
scale_fill_manual(values=c("salmon1", "darkslategray3")) +
theme_classic() +theme(
axis.text.y = element_text(size=11),
axis.text.x=element_text(size=11, angle = 45, hjust = 1.1), # 9
axis.title=element_text(size=17,face="bold"))  +
theme(axis.title.x = element_text(vjust = -3)) +
theme(axis.title.y = element_text(vjust = 4)) +
theme(plot.margin=unit(c(1,1,1.1,1.2),"cm"))
p1
p2
p3
# order the histogram by latitude and change some colors
#hist(data$year, main="Numbers Collected", xlab="Year")
colors = c("#787a87", "#E69F00", "#56B4E9",
"royalblue", "grey", "gold",
"#409973", "#9bc969", "ivory2") # the keys
p = ggplot(data=subset(data, !is.na(datetime)), aes(x=datetime, fill=population)) +
geom_bar(position='stack', color="black", width=0.7) +
theme_bw()
p1 = p + labs(title=" ", fill="Population",
x="Field Collection Month", y = "Number of Bugs Collected")+
scale_fill_manual(values=colors) +
theme_classic() +theme(
axis.text.y = element_text(size=11),
axis.text.x=element_text(size=11, angle = 45, hjust = 1.1),
axis.title=element_text(size=17,face="bold"))  +
theme(axis.title.x = element_text(vjust = -3)) +
theme(axis.title.y = element_text(vjust = 4)) +
theme(plot.margin=unit(c(1,1,1.1,1.2),"cm"))
p = ggplot(data=subset(data, !is.na(datetime)), aes(x=datetime, fill=pophost)) +
geom_bar(position='stack', color="black", width=0.7) +
theme_bw()
p2 = p + labs(title=" ", fill="Host Plant",
x="Field Collection Month", y = "Number of Bugs Collected")+
scale_fill_manual(values=c("#56B4E9", "chartreuse4")) +
theme_classic() + theme(
axis.text.y = element_text(size=11),
axis.text.x=element_text(size=11, angle = 45, hjust = 1.1), # 9
axis.title=element_text(size=17,face="bold"))  +
theme(axis.title.x = element_text(vjust = -3)) +
theme(axis.title.y = element_text(vjust = 4)) +
theme(plot.margin=unit(c(1,1,1.1,1.2),"cm"))
p = ggplot(data=subset(data, !is.na(datetime)), aes(x=datetime, fill=sex)) +
geom_bar(position='stack', color="black", width=0.7) +
theme_bw()
p3 = p + labs(title=" ", fill="Sex",
x="Field Collection Month", y = "Number of Bugs Collected")+
scale_fill_manual(values=c("salmon1", "darkslategray3")) +
theme_classic() +theme(
axis.text.y = element_text(size=11),
axis.text.x=element_text(size=11, angle = 45, hjust = 1.1), # 9
axis.title=element_text(size=17,face="bold"))  +
theme(axis.title.x = element_text(vjust = -3)) +
theme(axis.title.y = element_text(vjust = 4)) +
theme(plot.margin=unit(c(1,1,1.1,1.2),"cm"))
p1
p2
p3
rm(list=ls())
dir = "~/Desktop/git_repositories/SBB-dispersal/avbernat_working_on/All_Morphology/stats/"
setwd(dir)
library(FactoMineR)
library(factoextra)
library(corrplot)
library(readr)
library(dplyr)
knitr::opts_chunk$set(echo = TRUE)
source_path = "~/Desktop/git_repositories/SBB-dispersal/avbernat_working_on/Rsrc/"
script_names = c("clean_morph_data2.R" # two functions: read_morph_data and remove_torn_wings
)
for (script in script_names) {
path = paste0(source_path, script)
source(path)
}
data_list <- read_morph_data("data/allmorphology04.26.21-coors2.csv")
raw_data = data_list[[1]]
all_bugs = nrow(raw_data)
data_long = data_list[[2]]
# Remove individuals with torn wings first
raw_data = remove_torn_wings(raw_data) # **don't need to remove torn wings for wing morph analysis
data_long = remove_torn_wings(data_long) # **don't need to remove torn wings for wing morph analysis
clean_bugs = nrow(raw_data)
cat("number of bugs with torn wings:", all_bugs - clean_bugs, "\n\n")
rm(list=ls())
dir = "~/Desktop/git_repositories/SBB-dispersal/avbernat_working_on/All_Morphology/stats/"
setwd(dir)
library(FactoMineR)
library(factoextra)
library(corrplot)
library(readr)
library(dplyr)
knitr::opts_chunk$set(echo = TRUE)
Round <- function(number){
# for plotting
x <- round(number, 1)
if(x%%1 == 0){
return(paste(as.character(x), ".0", sep = ""))
}
else{
return(x)
}
}
PCA_graphs <- function(dataset, PCA_title){
# cos2 and the alpha.var: alpha.var colours variables by cos2
# (importance of most important PC to variable),
# see https://personal.utdallas.edu/~herve/abdi-awPCA2010.pdf
GFpca <- PCA(dataset, scale.unit = TRUE, graph = TRUE, ncp = 10)
eig.val <- get_eigenvalue(GFpca)
var.val <- GFpca$var
print(eig.val) #will only show in in console
print(var.val)
scree <- fviz_eig(GFpca, addlabels = TRUE, ylim = c(0, 100))
print(scree)
labX <- paste("PC1 (", Round(eig.val[1, 2]), "%)", sep = "")
labY <- paste("PC1 (", Round(eig.val[2, 2]), "%)", sep = "")
leplot <- fviz_pca_biplot(GFpca, geom.id = c("point"),
geom.var = c("arrow", "text"),
alpha.var = "cos2",
label = "var", repel = T,
col.ind = "gray", col.var = "black")
print(leplot)
ggpubr::ggpar(leplot, title = PCA_title, xlab = labX, ylab = labY,
ggtheme = theme_classic(), font.main = c(20, "bold"),
font.x = 14, font.y = 14, font.tickslab = 12
)
D = cor(dataset)
test <- cor.mtest(dataset)$p
par(mfrow=c(1,2))
corrplot.mixed(D,lower.col = "black", number.cex = .7, p.mat=test, sig.level=0.05)
corrplot.mixed(D,lower.col = "black", number.cex = .7)
return(GFpca)
}
source_path = "~/Desktop/git_repositories/SBB-dispersal/avbernat_working_on/Rsrc/"
script_names = c("clean_morph_data2.R" # two functions: read_morph_data and remove_torn_wings
)
for (script in script_names) {
path = paste0(source_path, script)
source(path)
}
data_list <- read_morph_data("data/allmorphology04.26.21-coors2.csv")
raw_data = data_list[[1]]
all_bugs = nrow(raw_data)
data_long = data_list[[2]]
# Remove individuals with torn wings first
raw_data = remove_torn_wings(raw_data) # **don't need to remove torn wings for wing morph analysis
data_long = remove_torn_wings(data_long) # **don't need to remove torn wings for wing morph analysis
clean_bugs = nrow(raw_data)
cat("number of bugs with torn wings:", all_bugs - clean_bugs, "\n\n")
d <- data_tested %>%
select(thorax_s, body_s, wing_s, beak_s) %>%
filter(!is.na(body_s))
d <- raw_data %>%
select(thorax_s, body_s, wing_s, beak_s) %>%
filter(!is.na(body_s))
