anova(m5, m7, test="Chisq") # Adding C improves fit
anova(m7, m12, test="Chisq") # Adding A*C marginally improves fit
anova(m7, m13, test="Chisq") # Addding B*C improves fit
morph_model <- lmer(num_flew ~ body_c * wing_c + thorax_c + (1 | population), data=d)
tidy_regression(morph_model, is_color=output_col)
R = d$num_flew
A = d$thorax_c
B = d$wing2body_c
X = d$population
data<-data.frame(R, A, B, X)
model_script = paste0(source_path,"generic models-gaussian glmer 1-RF + 2-FF.R")
errors = catch_warnings(model_comparisonsAIC(model_script))
length(errors$warnings)
morph_model <- lmer(num_flew ~ wing2body_c * thorax_c + (1 | population), data=d)
tidy_regression(morph_model, is_color=output_col)
R = d$num_flew
A = d$thorax_c
B = d$wing2body_c
C = d$avg_mass
X = d$population
data<-data.frame(R, A, B, C, X)
model_script = paste0(source_path,"generic models-gaussian glmer 1-RF + 3-FF.R")
errors = catch_warnings(model_comparisonsAIC(model_script))
length(errors$warnings)
R = d$num_flew
A = d$thorax_c
B = d$wing2body_c
C = d$sex_c
X = d$population
data<-data.frame(R, A, B, C, X)
model_script = paste0(source_path,"generic models-gaussian glmer 1-RF + 3-FF.R")
errors = catch_warnings(model_comparisonsAIC(model_script))
length(errors$warnings)
# test mixed effect model
model <- glmer(flew_b~sex_c*host_c + (1|ID) + (1|trial_type), data=data_tested, family=binomial)
summary(model)
getME(model, "lower")
####### No effect of chamber
tidy_regression(glm(flew_b~chamber, data=data_tested, family=binomial), is_color=output_col)
####### Effect of test date (but no effect of test date when you split between T1 and T2)
tidy_regression(glm(flew_b~days_from_start_c, data=data_tested, family=binomial), is_color=output_col)
####### No effect of test time
tidy_regression(glm(flew_b~min_from_IncStart_c, data=data_tested, family=binomial), is_color=output_col)
####### (Strong) Effect of mass
tidy_regression(glm(flew_b~mass_c, data=data_tested, family=binomial), is_color=output_col)
####### Effect of number of eggs laid
tidy_regression(glm(flew_b~total_eggs, data=data_tested, family=binomial), is_color=output_col)
####### Effect of whether eggs were laid or not
tidy_regression(glm(flew_b~eggs_b, data=data_tested, family=binomial), is_color=output_col)
####### Effect of beak length
tidy_regression(glm(flew_b~beak_c, data=data_tested, family=binomial), is_color=output_col)
####### Effect of thorax length
tidy_regression(glm(flew_b~thorax_c, data=data_tested, family=binomial), is_color=output_col)
####### Effect of body length
tidy_regression(glm(flew_b~body_c, data=data_tested, family=binomial), is_color=output_col)
####### No effect of wing length
tidy_regression(glm(flew_b~wing_c, data=data_tested, family=binomial), is_color=output_col)
####### No effect of wing morph (check how annotated the wing morph) - don't include it
#tidy_regression_bw(glm(flew_b~w_morph_c, data=data_all, family=binomial))
# Remove any missing masses
data_tested <- data_tested %>%
filter(!is.na(mass))
data_tested <- center_data(data_tested)
R = data_tested$flew_b
A = data_tested$host_c
B = data_tested$sex_c
C = data_tested$sym_dist
D = data_tested$mass_c
X = data_tested$ID
Y = data_tested$trial_type
data<-data.frame(R, A, B, C, D, X, Y)
model_script = paste0(source_path,"generic models-binomial glmer 2 RF + 3-FF.R")
errors = catch_warnings(model_comparisonsAIC(model_script))
length(errors$warnings)
anova(m42, m46, test="Chisq") # Adding A*B improves fit
all_model<-glmer(flew_b~sex_c*host_c + (1|ID) + (1|trial_type), family=binomial, data=data_tested)
tidy_regression(all_model, is_color=output_col)
# model_script = paste0(source_path,"generic models-binomial glmer 2 RF + 4-FF.R")
# errors = catch_warnings(model_comparisonsAIC(model_script))
# length(errors$warnings)
# too many models failed to even keep running
data_tested <- data_tested %>%
filter(!is.na(body))
data_tested <- center_data(data_tested)
R = data_tested$flew_b
A = data_tested$thorax_c
B = data_tested$body_c
C = data_tested$wing_c
X = data_tested$ID
Y = data_tested$trial_type
data<-data.frame(R, A, B, C, X, Y)
model_script = paste0(source_path,"generic models-binomial glmer 2 RF + 3-FF.R")
errors = catch_warnings(model_comparisonsAIC(model_script))
length(errors$warnings)
anova(m51, m53, test="Chisq") # Adding A*B improves fit
morph_model<-glmer(flew_b~ thorax_c * body_c + body_c * wing_c + (1|ID), family=binomial, data=data_tested) # model failed to converge when both trial_type and ID
tidy_regression(morph_model, is_color=output_col)
R = data_tested$flew_b
A = data_tested$thorax_c
B = data_tested$wing2body_c
X = data_tested$ID
Y = data_tested$trial_type
data<-data.frame(R, A, B, C, X, Y)
model_script = paste0(source_path,"generic models-binomial glmer 2-RF + 2-FF.R")
errors = catch_warnings(model_comparisonsAIC(model_script))
length(errors$warnings)
anova(m13, m14, test="Chisq") # Adding A*B marginally improves fit
morph_model<-glmer(flew_b~ thorax_c * wing2body_c + (1|trial_type) + (1|ID), family=binomial, data=data_tested)
tidy_regression(morph_model, is_color=output_col) # coefficients are huge...
data <- read_flight_data("data/all_flight_data-Winter2020.csv")
data_all <- data[[1]]
data_tested <- data[[2]]
data_T1 <-data_tested[data_tested$trial_type=="T1",]
data_T1 <- center_data(data_T1)
####### No effect of chamber
tidy_regression(glm(flew_b~chamber, data=data_T1, family=binomial), is_color=output_col)
####### No effect of test date
tidy_regression(glm(flew_b~days_from_start_c, data=data_T1, family=binomial), is_color=output_col)
####### No effect of test time
tidy_regression(glm(flew_b~min_from_IncStart, data=data_T1, family=binomial), is_color=output_col)
####### (Strong) Effect of mass
tidy_regression(glm(flew_b~mass_c, data=data_T1, family=binomial), is_color=output_col)
####### Effect of beak length
tidy_regression(glm(flew_b~beak_c, data=data_T1, family=binomial), is_color=output_col)
####### Effect of thorax length
tidy_regression(glm(flew_b~thorax_c, data=data_T1, family=binomial), is_color=output_col)
####### No effect of body length
tidy_regression(glm(flew_b~body_c, data=data_T1, family=binomial), is_color=output_col)
####### No effect of wing length
tidy_regression(glm(flew_b~wing_c, data=data_T1, family=binomial), is_color=output_col)
# Remove any missing masses
data_T1 <- data_T1 %>%
filter(!is.na(mass))
data_T1 <- center_data(data_T1)
R = data_T1$flew_b
A = data_T1$host_c
B = data_T1$sex_c
C = data_T1$sym_dist
D = data_T1$mass_c
data<-data.frame(R, A, B, C, D)
model_script = paste0(source_path,"generic models-binomial glm 3-FF.R")
errors = catch_warnings(model_comparisonsAIC(model_script))
length(errors$warnings)
anova(m8, m11, test="Chisq") ## Adding C does not improve fit
anova(m11, m15, test="Chisq") ## Adding B*C interaction does not improve fit
anova(m11, m14, test="Chisq") ## Adding A*C interaction does not improve fit
model_T1<-glm(flew_b~sex_c*host_c, family=binomial, data=data_T1)
tidy_regression(model_T1, is_color=output_col)
model_T1_cov<-glm(flew_b~host_c*sex_c + mass_c, family=binomial, data=data_T1)
tidy_regression(model_T1_cov, is_color=output_col)
model_script = paste0(source_path,"generic models-binomial glm 4-FF.R")
errors = catch_warnings(model_comparisonsAIC(model_script))
length(errors$warnings)
anova(m51, m63, test="Chisq") # Adding B does not improve fit
model_T1_m <- glm(flew_b~host_c*mass_c + sex_c, family=binomial, data=data_T1)
tidy_regression(model_T1_m, is_color=output_col)
model_T1_m <- glm(flew_b~host_c*mass_c + sym_dist*mass_c, family=binomial, data=data_T1)
tidy_regression(model_T1_m, is_color=output_col)
data_T1 <-data_tested[data_tested$trial_type=="T1",]
data_T1 <- data_T1 %>%
filter(!is.na(body))
data_T1 <- center_data(data_T1)
R = data_T1$flew_b
A = data_T1$thorax_c
B = data_T1$body_c
C = data_T1$wing_c
data<-data.frame(R, A, B, C)
model_script = paste0(source_path,"generic models-binomial glm 3-FF.R")
errors = catch_warnings(model_comparisonsAIC(model_script))
length(errors$warnings)
anova(m13, m18, test="Chisq") # Adding A*B does not improve fit
morph_model <- glm(flew_b ~ body_c * wing_c + thorax_c, family = binomial, data = data_T1)
tidy_regression(morph_model, is_color=output_col)
anova(m7, m13, test="Chisq") # Adding B*C marginally improves fit
morph_modelglmer <- glmer(formula = flew_b ~  body_c * wing_c + thorax_c + (1| population), family = binomial, data = data_T1)
tidy_regression(morph_modelglmer, is_color=output_col) # did change the coefficients slightly, but not a better fit
data <- read_flight_data("data/all_flight_data-Winter2020.csv")
data_all <- data[[1]]
data_tested <- data[[2]]
data_T2 <-data_tested[data_tested$trial_type=="T2",]
data_T2 <- center_data(data_T2)
####### No effect of chamber
tidy_regression(glm(flew_b~chamber, data=data_T2, family=binomial), is_color=output_col)
####### No effect of test date
tidy_regression(glm(flew_b~days_from_start_c, data=data_T2, family=binomial), is_color=output_col)
####### No effect of test time
tidy_regression(glm(flew_b~min_from_IncStart, data=data_T2, family=binomial), is_color=output_col)
####### (Strong) Effect of mass
tidy_regression(glm(flew_b~mass_c, data=data_T2, family=binomial), is_color=output_col)
####### Effect of beak length
tidy_regression(glm(flew_b~beak_c, data=data_T2, family=binomial), is_color=output_col)
####### Effect of thorax length
tidy_regression(glm(flew_b~thorax_c, data=data_T2, family=binomial), is_color=output_col)
####### Effect of body length
tidy_regression(glm(flew_b~body_c, data=data_T2, family=binomial), is_color=output_col)
####### No effect of wing length
tidy_regression(glm(flew_b~wing_c, data=data_T2, family=binomial), is_color=output_col)
R = data_T2$flew_b
A = data_T2$host_c
B = data_T2$sex_c
C = data_T2$sym_dist
D = data_T2$mass_c # as a covariate
data<-data.frame(R, A, B, C, D)
model_script = paste0(source_path,"generic models-binomial glm 3-FF.R")
errors = catch_warnings(model_comparisonsAIC(model_script))
length(errors$warnings)
anova(m2, m4, test="Chisq") # Adding A does not improve fit
anova(m2, m6, test="Chisq") # Adding C does not improve fit
anova(m4, m7, test="Chisq") # Adding C does not improve fit
anova(m6, m7, test="Chisq") # Adding A does not improve fit
anova(m4, m8, test="Chisq") # Adding an A*B interaction term does not improve fit
anova(m6, m10, test="Chisq") # Adding a B*C interaction term does not improve fit
model_T2 <-glm(flew_b~sex_c, family=binomial, data=data_T2)
tidy_regression(model_T2, is_color=output_col)
model_script = paste0(source_path,"generic models-binomial glm 4-FF.R")
errors = catch_warnings(model_comparisonsAIC(model_script))
length(errors$warnings)
anova(m4, m7, test="Chisq") # Adding A does not improve fit
anova(m7, m12, test="Chisq") # Adding B does not improve fit
anova(m4, m9, test="Chisq") # Adding B does not improve fit
model_T2_mass <-glm(flew_b~mass_c, family=binomial, data=data_T2)
tidy_regression(model_T2_mass, is_color=output_col)
# Remove any missing masses and morphology measurements
data_T2 <- data_T2 %>%
filter(!is.na(mass))  %>%
filter(!is.na(body))
data_T2 <- center_data(data_T2)
R = data_T2$flew_b
A = data_T2$thorax_c
B = data_T2$body_c
C = data_T2$wing_c
data<-data.frame(R, A, B, C)
model_script = paste0(source_path,"generic models-binomial glm 3-FF.R")
errors = catch_warnings(model_comparisonsAIC(model_script))
length(errors$warnings)
morph_model_T2 <- glm(flew_b ~ thorax_c * wing_c + body_c * wing_c, family = binomial, data = data_T2)
tidy_regression(morph_model_T2, is_color=output_col)
morph_model_T2glmer <- glmer(flew_b ~ thorax_c * wing_c + body_c * wing_c + (1|chamber), family = binomial, data = data_T2) # (1|days_from_start_c) and (1|population)variance = 0, chamber did not have variance at 0
tidy_regression(morph_model_T2glmer, is_color=output_col) # changed coefficients slightly, but did not improve the fit of the model.
data <- read_flight_data("data/all_flight_data-Winter2020.csv")
data_all <- data[[1]]
data_tested <- data[[2]]
data_fem <- data_tested[data_tested$sex=="F",]
data_fem <- center_data(data_fem)
####### Marginal effect of chamber B-4 (ah this again!)
tidy_regression(glm(flew_b~chamber, data=data_fem, family=binomial), is_color=output_col)
####### No effect of test date
tidy_regression(glm(flew_b~days_from_start, data=data_fem, family=binomial), is_color=output_col)
####### No effect of test time
tidy_regression(glm(flew_b~min_from_IncStart, data=data_fem, family=binomial), is_color=output_col)
####### (Strong) Effect of mass
tidy_regression(glm(flew_b~mass_c, data=data_fem, family=binomial), is_color=output_col)
####### Effect of number of eggs laid
tidy_regression(glm(flew_b~total_eggs_c, data=data_fem, family=binomial), is_color=output_col)
####### Effect of whether eggs were laid or not
tidy_regression(glm(flew_b~eggs_b, data=data_fem, family=binomial), is_color=output_col)
####### Effect of beak length
tidy_regression(glm(flew_b~beak_c, data=data_fem, family=binomial), is_color=output_col)
####### No effect of thorax length
tidy_regression(glm(flew_b~thorax_c, data=data_fem, family=binomial), is_color=output_col)
####### Effect of body length
tidy_regression(glm(flew_b~body_c, data=data_fem, family=binomial), is_color=output_col)
####### Effect of wing length
tidy_regression(glm(flew_b~wing_c, data=data_fem, family=binomial), is_color=output_col)
R = data_fem$flew_b
A = data_fem$host_c
B = data_fem$wing_c # before had sym_dist but now leave out because did not have significant effects or interactions within the total model dataset.
C = data_fem$mass_c
data<-data.frame(R, A, B, C)
model_script = paste0(source_path,"generic models-binomial glm 2-FF.R")
errors = catch_warnings(model_comparisonsAIC(model_script))
length(errors$warnings)
anova(m0, m1, test="Chisq") # Adding A does not improve fit
anova(m0, m2, test="Chisq") # Adding B does improve fit
anova(m1, m3, test="Chisq") # Adding B does improve improve fit
anova(m2, m3, test="Chisq") # Adding A does not improve fit
model_fem <-glm(flew_b~wing_c, family=binomial, data=data_fem)
tidy_regression(model_fem, is_color=output_col)
data_fem <- data_tested[data_tested$sex=="F",]
data_fem <- data_fem %>%
filter(!is.na(mass))
data_fem <- center_data(data_fem)
R = data_fem$flew_b
A = data_fem$host_c
B = data_fem$wing_c # used to be sym_dis
C = data_fem$mass_c
data<-data.frame(R, A, B, C)
model_script = paste0(source_path,"generic models-binomial glm 3-FF.R")
errors = catch_warnings(model_comparisonsAIC(model_script))
length(errors$warnings)
anova(m3, m6, test="Chisq") # Adding B does improve fit
anova(m3, m5, test="Chisq") # Adding A does not improve fit
anova(m6, m7, test="Chisq") # Adding A does not improve fit
anova(m6, m10, test="Chisq") # Adding B*C does not improve fit
model_fem_mass <-glm(flew_b~wing_c + mass_c, family=binomial, data=data_fem)
tidy_regression(model_fem_mass, is_color=output_col)
R = data_fem$flew_b
A = data_fem$host_c
B = data_fem$mass_c
C = data_fem$wing_c # replaced sym_dist
X = data_fem$ID  # variance is zero if use trial_type | 3 models fail to converge if use ID
data<-data.frame(R, A, B, C, X)
model_script = paste0(source_path,"generic models-binomial glmer 1 RF + 3-FF.R")
errors = catch_warnings(model_comparisonsAIC(model_script))
length(errors$warnings)
# top model if use ID:
model_fem_ME <-glmer(flew_b~host_c * mass_c + host_c * wing_c + (1 | ID), family=binomial, data=data_fem)
tidy_regression(model_fem_ME, is_color=output_col)
# top model if use trial_type:
model_fem_ME <-glmer(flew_b~mass_c + wing_c + (1|trial_type), family=binomial, data=data_fem)
# if you replace trial_type with ID then you'll see the coefficients are way too huge and at different scales. Why?
tidy_regression(model_fem_ME, is_color=output_col)
# top model if use ID:
model_fem_ME <-glmer(flew_b~host_c * mass_c + host_c * wing_c + (1 | ID), family=binomial, data=data_fem)
tidy_regression(model_fem_ME, is_color=output_col)
# top model if use trial_type:
model_fem_ME <-glmer(flew_b~mass_c + wing_c + (1|trial_type), family=binomial, data=data_fem)
# if you replace trial_type with ID then you'll see the coefficients are way too huge and at different scales. Why?
tidy_regression(model_fem_ME, is_color=output_col)
R = data_fem$flew_b
A = data_fem$host_c
B = data_fem$wing_c
C = data_fem$mass_c
D = data_fem$eggs_b
data<-data.frame(R, A, B, C, D)
model_script = paste0(source_path,"generic models-binomial glm 4-FF.R")
errors = catch_warnings(model_comparisonsAIC(model_script))
length(errors$warnings)
fem_model<-glm(flew_b~wing_c + mass_c + eggs_b, family=binomial, data=data_fem)
tidy_regression(fem_model, is_color=output_col)
ffem_model<-glmer(flew_b~wing_c + mass_c + eggs_b + (1|ID), family=binomial, data=data_fem)
tidy_regression(ffem_model, is_color=output_col) # model fits better
R = data_fem$flew_b
A = data_fem$host_c
B = data_fem$wing_c
C = data_fem$mass_c
D = data_fem$eggs_b
X = data_fem$ID
data<-data.frame(R, A, B, C, D, X)
model_script = paste0(source_path,"generic models-gaussian glmer 1-RF + 4-FF.R")
errors = catch_warnings(model_comparisonsAIC(model_script))
length(errors$warnings)
anova(m21, m33, test="Chisq") # Adding B improves fits
ffem_model<-glmer(flew_b~mass_c *eggs_b + wing_c + (1|ID), family=binomial, data=data_fem)
tidy_regression(ffem_model, is_color=output_col) # model fits better
R = data_fem$flew_b
A = data_fem$thorax_c
B = data_fem$body_c
C = data_fem$wing_c
data<-data.frame(R, A, B, C)
model_script = paste0(source_path,"generic models-binomial glm 3-FF.R")
errors = catch_warnings(model_comparisonsAIC(model_script))
length(errors$warnings)
anova(m13, m16, test="Chisq") # Adding A*C improves fit
morph_fem_model <- glm(flew_b ~ thorax_c * wing_c + body_c * wing_c, data=data_fem)
tidy_regression(morph_fem_model, is_color=output_col)
morph_fem_modelglmer <- glmer(flew_b ~ thorax_c * wing_c + body_c * wing_c + (1|trial_type) + (1|chamber), data=data_fem, family=binomial) # variance of population and days_from_start_c = 0
morph_fem_modelglmer2 <- glmer(flew_b ~ thorax_c * wing_c + body_c * wing_c + (1|ID), data=data_fem, family=binomial)
tidy_regression(morph_fem_modelglmer, is_color=output_col) # better fitted model; coefficients changed a lot, and more significant
tidy_regression(morph_fem_modelglmer2, is_color=output_col) #even better fitted model; effects no longer significant and coefficients changed.
# why so drastically different between the two?
R = data_fem$flew_b
A = data_fem$thorax_c
B = data_fem$wing2body_c
data<-data.frame(R, A, B)
model_script = paste0(source_path,"generic models-binomial glm 2-FF.R")
errors = catch_warnings(model_comparisonsAIC(model_script))
length(errors$warnings)
anova(m0, m2, test="Chisq") # Adding B marginally improves fit
anova(m2, m3, test="Chisq") # Adding A does not improve fit
morph_fmodel <- glm(flew_b ~ wing2body_c, data=data_fem, family=binomial) # variance of population and days_from_start_c = 0
tidy_regression(morph_fmodel, is_color=output_col)
R = data_fem$flew_b
A = data_fem$thorax_c
B = data_fem$body_c
C = data_fem$wing_c
X = data_fem$trial_type # rescale variables warning when replace trial type with ID as the sole RF
#Y = data_fem$ID # you would think it's the same as ID, but not
# you get a different set of top models if you use trial_type or ID
data<-data.frame(R, A, B, C, X)
model_script = paste0(source_path,"generic models-binomial glmer 1 RF + 3-FF.R")
errors = catch_warnings(model_comparisonsAIC(model_script))
length(errors$warnings)
anova(m38, m40, test="Chisq") # adding B does not improve fit
anova(m38, m41, test="Chisq") # Adding C does not improve fit
anova(m38, m42, test="Chisq") # Adding A does not improve fit
anova(m13, m16, test="Chisq") # Adding A*C improves fit
# when use ID and trial type as RFs get the null model as the top model
best.fem.morph <- glmer(flew_b ~  1 + (1|trial_type) + (1|ID), data=data_fem, family=binomial)
tidy_regression(best.fem.morph, is_color=output_col)
# when use only trial type as RF:
best.fem.morph <- glmer(flew_b ~  thorax_c * wing_c + body_c * wing_c + (1|trial_type), data=data_fem, family=binomial)
tidy_regression(best.fem.morph, is_color=output_col)
R = data_fem$flew_b
A = data_fem$thorax_c
B = data_fem$wing2body_c
X = data_fem$trial_type # rescale variables warning when replace trial type with ID as the sole RF
Y = data_fem$ID # you would think it's the same as ID, but not
# you get a different set of top models if you use trial_type or ID
data<-data.frame(R, A, B, X, Y)
model_script = paste0(source_path,"generic models-binomial glmer 2-RF + 2-FF.R")
errors = catch_warnings(model_comparisonsAIC(model_script))
length(errors$warnings)
anova(m0, m2, test="Chisq") # Adding A marginally imprvoes fit
anova(m2, m3, test="Chisq") # Adding B does not improve fit
anova(m10, m11, test="Chisq") # Adding A does not improve fit
anova(m10, m12, test="Chisq") # Adding B does not improve fit
# best fit model if only use trial type as RF:
best.fem.morph <- glmer(flew_b ~  wing2body_c + (1|trial_type), data=data_fem, family=binomial)
tidy_regression(best.fem.morph, is_color=output_col)
# best fit model is the null if use both trial type and ID as RFs:
best.fem.morph <- glmer(flew_b ~  1 + (1|trial_type) + (1|ID), data=data_fem, family=binomial)
tidy_regression(best.fem.morph, is_color=output_col)
data <- read_flight_data("data/all_flight_data-Winter2020.csv")
data_all <- data[[1]]
data_tested <- data[[2]]
data_male <- data_tested[data_tested$sex=="M",]
data_male <- center_data(data_male)
####### No effect of chamber
tidy_regression(glm(flew_b~chamber, data=data_male, family=binomial), is_color=output_col)
####### Effect of test date (as seen in the data_all)
tidy_regression(glm(flew_b~days_from_start_c, data=data_male, family=binomial), is_color=output_col)
####### No effect of test time (but close p = 0.09443)
tidy_regression(glm(flew_b~min_from_IncStart, data=data_male, family=binomial), is_color=output_col)
# seems like males are very time sensitive
####### (Strong) Effect of mass
tidy_regression(glm(flew_b~mass_c, data=data_male, family=binomial), is_color=output_col)
####### No effect of beak length
tidy_regression(glm(flew_b~beak_c, data=data_male, family=binomial), is_color=output_col)
####### No effect of thorax length
tidy_regression(glm(flew_b~thorax_c, data=data_male, family=binomial), is_color=output_col)
####### Marginal effect of body length
tidy_regression(glm(flew_b~body_c, data=data_male, family=binomial), is_color=output_col)
####### Effect of wing length
tidy_regression(glm(flew_b~wing_c, data=data_male, family=binomial), is_color=output_col)
# Remove any missing masses
data_male <- data_male %>%
filter(!is.na(mass))
data_male <- center_data(data_male)
R = data_male$flew_b
A = data_male$host_c
B = data_male$days_from_start_c
C = data_male$mass_c
data<-data.frame(R, A, B, C)
model_script = paste0(source_path,"generic models-binomial glm 2-FF.R")
errors = catch_warnings(model_comparisonsAIC(model_script))
length(errors$warnings)
anova(m3, m4, test="Chisq") # Adding A*B does not improve fit
model_male<-glm(flew_b~host_c + days_from_start_c, family=binomial, data=data_male)
tidy_regression(model_male, is_color=output_col)
## Consider covariates
model_male_final <-glmer(flew_b~host_c + days_from_start_c + (1|population) + (1|trial_type), family=binomial, data=data_male)
tidy_regression(model_male_final, is_color=output_col)
## Changed the effect slightly, did not improve the model, and made host not significant...
model_script = paste0(source_path,"generic models-binomial glm 3-FF.R")
errors = catch_warnings(model_comparisonsAIC(model_script))
length(errors$warnings)
anova(m7, m11, test="Chisq") # Adding A*B does not improve fit
model_male_mass <-glm(flew_b~host_c + mass_c + days_from_start_c, family=binomial, data=data_male)
tidy_regression(model_male_mass, is_color=output_col)
## Consider covariates
model_male_mass_final <-glmer(flew_b~host_c + mass_c + days_from_start_c + (1|population) + (1|trial_type), family=binomial, data=data_male) # no error, but singular fit error
tidy_regression(model_male_mass_final, is_color=output_col)
## Changed the effects slightly and in turn made host not significant but not a better fitting model.
data_male <- data_tested[data_tested$sex=="M",]
data_male <- data_male %>%
filter(!is.na(mass)) %>%
filter(!is.na(body))
data_male <- center_data(data_male)
R = data_male$flew_b
A = data_male$thorax_c
B = data_male$body_c
C = data_male$wing_c
data<-data.frame(R, A, B, C)
model_script = paste0(source_path,"generic models-binomial glm 3-FF.R")
errors = catch_warnings(model_comparisonsAIC(model_script))
length(errors$warnings)
anova(m10, m13, test="Chisq") # Adding A*C marginally improves fit
male_morph<-glm(flew_b~body_c* wing_c + thorax_c, family=binomial, data=data_male)
tidy_regression(male_morph, is_color=output_col)
male_morph.glmer <- glmer(flew_b ~ body_c* wing_c + thorax_c + (1|ID) + (1|trial_type), family=binomial, data=data_male)
tidy_regression(male_morph.glmer, is_color=output_col) # model improves fit and it converges!
R = data_male$flew_b
A = data_male$thorax_c
B = data_male$body_c
C = data_male$wing_c
D = data_male$days_from_start_c
X = data_male$ID # only one model failed to converge when ID as RF
Y = data_male$trial_type # 9 modles failed to converge when both RFs
data<-data.frame(R, A, B, C, D, X, Y)
model_script = paste0(source_path,"generic models-binomial glmer 2-RF + 4-FF-noD-interactions.R")
errors = catch_warnings(model_comparisonsAIC(model_script))
length(errors$warnings)
anova(m24, m27, test="Chisq") # Adding A marginally improves fit
anova(m22, m26, test="Chisq") # ADding B does not improve fit
male_morph.glmer <- glmer(flew_b ~ thorax_c * wing_c + days_from_start_c + (1 | ID) , family=binomial, data=data_male)
tidy_regression(male_morph.glmer, is_color=output_col)
# left off here
R = data_male$flew_b
A = data_male$wing2body_c
B = data_male$thorax_c
C = data_male$days_from_start_c
X = data_male$ID
Y = data_male$trial_type
data<-data.frame(R, A, B, C, X, Y)
model_script = paste0(source_path,"generic models-binomial glmer 2 RF + 3-FF-noCinteractions.R")
errors = catch_warnings(model_comparisonsAIC(model_script))
length(errors$warnings)
anova(m5, m7, test="Chisq") # Adding B does not improve fit
anova(m5, m24, test="Chisq") # Adding Y does not improve fit
male_morph.glmer <- glmer(flew_b ~ wing2body_c + days_from_start_c + (1 | ID), family=binomial, data=data_male)
tidy_regression(male_morph.glmer, is_color=output_col)
